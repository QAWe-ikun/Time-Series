2026-01-19 22:58:48,083 - data_processing - INFO - AKShare 库加载成功
2026-01-19 23:01:49,426 - data_processing - INFO - AKShare 库加载成功
2026-01-19 23:01:49,426 - data_processing - INFO - 正在获取PPI数据...
2026-01-19 23:01:49,680 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-19 23:01:49,680 - data_processing - INFO - PPI: 240行数据
2026-01-19 23:01:50,681 - data_processing - INFO - 正在获取CPI数据...
2026-01-19 23:01:50,954 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-19 23:01:50,954 - data_processing - INFO - CPI: 216行数据
2026-01-19 23:01:51,954 - data_processing - INFO - 正在获取M2数据...
2026-01-19 23:01:52,292 - data_processing - INFO - 已保存: M2_原始数据.csv (216行 × 10列)
2026-01-19 23:01:52,292 - data_processing - INFO - M2: 216行数据
2026-01-19 23:01:53,293 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-19 23:01:53,610 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-19 23:01:53,610 - data_processing - INFO - 新增贷款: 216行数据
2026-01-19 23:01:54,611 - data_processing - INFO - 正在获取GDP数据...
2026-01-19 23:01:54,865 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-19 23:01:54,865 - data_processing - INFO - GDP: 80行数据
2026-01-19 23:01:55,866 - data_processing - INFO - 正在获取SHIBOR数据...
2026-01-19 23:01:59,645 - data_processing - INFO - 已保存: SHIBOR_原始数据.csv (4818行 × 3列)
2026-01-19 23:01:59,645 - data_processing - INFO - SHIBOR: 4818行数据
2026-01-19 23:02:00,646 - data_processing - WARNING - 工资数据已从国家统计局API获取
2026-01-19 23:02:00,646 - data_processing - INFO - 正在获取企业景气指数数据...
2026-01-19 23:02:00,887 - data_processing - INFO - 已保存: 企业景气指数_原始数据.csv (83行 × 7列)
2026-01-19 23:02:00,887 - data_processing - INFO - 企业景气指数: 83行数据
2026-01-19 23:02:01,888 - data_processing - INFO - 正在获取PMI数据...
2026-01-19 23:02:02,124 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-19 23:02:02,124 - data_processing - INFO - PMI: 216行数据
2026-01-19 23:02:03,125 - data_processing - INFO - 正在获取非制造业PMI数据...
2026-01-19 23:02:05,955 - data_processing - INFO - 已保存: 非制造业PMI_原始数据.csv (226行 × 5列)
2026-01-19 23:02:05,955 - data_processing - INFO - 非制造业PMI: 226行数据
2026-01-19 23:02:06,956 - data_processing - INFO - 步骤 1 完成
2026-01-19 23:02:06,957 - data_processing - INFO - 成功: 0个文件
2026-01-19 23:02:06,957 - data_processing - WARNING - 步骤 2 部分完成或跳过
2026-01-19 23:02:06,962 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-19 23:02:06,962 - data_processing - INFO - 原始数据: 80行
2026-01-19 23:02:06,967 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-19 23:02:06,979 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-19 23:02:06,980 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-19 23:02:06,981 - data_processing - INFO - 成功读取: 企业景气指数_标准日期.csv (83行)
2026-01-19 23:02:06,981 - data_processing - INFO - 原始数据: 83行
2026-01-19 23:02:06,981 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-19 23:02:06,985 - data_processing - INFO - 已保存: 企业景气指数_月度.csv (247行 × 7列)
2026-01-19 23:02:06,985 - data_processing - INFO - 转换完成: 83行 → 247行 (2005-03-01 ~ 2025-09-01) 方法: 线性插值
2026-01-19 23:02:06,986 - data_processing - INFO - 成功读取: 工资数据_标准日期.csv (70行)
2026-01-19 23:02:06,986 - data_processing - INFO - 原始数据: 70行
2026-01-19 23:02:06,986 - data_processing - INFO - 已是月度数据（平均间隔0天），无需转换
2026-01-19 23:02:06,987 - data_processing - INFO - 成功转换: 2/3 个文件
2026-01-19 23:02:06,988 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-19 23:02:06,988 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-19 23:02:06,989 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-19 23:02:06,991 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-19 23:02:06,992 - data_processing - INFO - 成功读取: M2_标准日期.csv (216行)
2026-01-19 23:02:06,994 - data_processing - INFO - 已合并: M2_标准日期.csv (2列)
2026-01-19 23:02:06,994 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-19 23:02:06,996 - data_processing - INFO - 已合并: PMI_标准日期.csv (2列)
2026-01-19 23:02:06,996 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-19 23:02:06,998 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-19 23:02:07,042 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-19 23:02:07,044 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-19 23:02:07,151 - data_processing - INFO - 成功读取: 企业景气指数_月度.csv (247行)
2026-01-19 23:02:07,158 - data_processing - INFO - 已合并: 企业景气指数_月度.csv (2列)
2026-01-19 23:02:07,166 - data_processing - INFO - 已保存: 统一月度数据集.csv (250行 × 15列)
2026-01-19 23:02:07,167 - data_processing - INFO - 统一数据集: 250行 × 15列 (2005-03-01 ~ 2025-12-01)
2026-01-19 23:02:07,168 - data_processing - INFO - 步骤 3 完成
2026-01-19 23:02:07,171 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-19 23:02:07,174 - data_processing - INFO - 删除中文列: month
2026-01-19 23:02:07,177 - data_processing - ERROR - 转换失败 CPI_标准日期.csv: 'DataFrame' object has no attribute 'dtype'
2026-01-19 23:02:07,177 - data_processing - ERROR - 转换CPI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2611, in _prepare_pandas
    data = _cast_to_stata_types(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 595, in _cast_to_stata_types
    isinstance(data[col].dtype, ExtensionDtype)
               ^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'
2026-01-19 23:02:07,244 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-19 23:02:07,244 - data_processing - INFO - 删除中文列: month
2026-01-19 23:02:07,246 - data_processing - ERROR - 转换失败 PPI_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-19 23:02:07,246 - data_processing - ERROR - 转换PPI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-19 23:02:07,364 - data_processing - INFO - 正在转换: M2_标准日期.csv
2026-01-19 23:02:07,365 - data_processing - INFO - 删除中文列: month
2026-01-19 23:02:07,371 - data_processing - ERROR - 转换失败 M2_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-19 23:02:07,372 - data_processing - ERROR - 转换M2_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-19 23:02:07,374 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-19 23:02:07,375 - data_processing - INFO - 删除中文列: month
2026-01-19 23:02:07,377 - data_processing - ERROR - 转换失败 PMI_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-19 23:02:07,377 - data_processing - ERROR - 转换PMI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-19 23:02:07,378 - data_processing - INFO - 正在转换: GDP_标准日期.csv
2026-01-19 23:02:07,379 - data_processing - INFO - 删除中文列: quarter
2026-01-19 23:02:07,381 - data_processing - ERROR - 转换失败 GDP_标准日期.csv: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-19 23:02:07,381 - data_processing - ERROR - 转换GDP_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-19 23:02:07,383 - data_processing - INFO - 正在转换: 企业景气指数_标准日期.csv
2026-01-19 23:02:07,383 - data_processing - INFO - 删除中文列: quarter
2026-01-19 23:02:07,385 - data_processing - ERROR - 转换失败 企业景气指数_标准日期.csv: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-19 23:02:07,386 - data_processing - ERROR - 转换企业景气指数_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-19 23:02:07,387 - data_processing - INFO - 正在转换: 工资数据_标准日期.csv
2026-01-19 23:02:07,388 - data_processing - ERROR - 转换失败 工资数据_标准日期.csv: 'DataFrame' object has no attribute 'dtype'
2026-01-19 23:02:07,388 - data_processing - ERROR - 转换工资数据_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2611, in _prepare_pandas
    data = _cast_to_stata_types(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 595, in _cast_to_stata_types
    isinstance(data[col].dtype, ExtensionDtype)
               ^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'
2026-01-19 23:02:07,390 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-19 23:02:07,390 - data_processing - INFO - 删除中文列: month
2026-01-19 23:02:07,392 - data_processing - ERROR - 转换失败 新增贷款_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-19 23:02:07,392 - data_processing - ERROR - 转换新增贷款_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-19 23:02:07,398 - data_processing - INFO - 正在转换: SHIBOR_标准日期.csv
2026-01-19 23:02:07,400 - data_processing - ERROR - 转换失败 SHIBOR_标准日期.csv: 'DataFrame' object has no attribute 'dtype'
2026-01-19 23:02:07,400 - data_processing - ERROR - 转换SHIBOR_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2611, in _prepare_pandas
    data = _cast_to_stata_types(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 595, in _cast_to_stata_types
    isinstance(data[col].dtype, ExtensionDtype)
               ^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'
2026-01-19 23:02:07,402 - data_processing - INFO - 正在转换: 非制造业PMI_标准日期.csv
2026-01-19 23:02:07,403 - data_processing - ERROR - 转换失败 非制造业PMI_标准日期.csv: 'DataFrame' object has no attribute 'dtype'
2026-01-19 23:02:07,403 - data_processing - ERROR - 转换非制造业PMI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2611, in _prepare_pandas
    data = _cast_to_stata_types(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 595, in _cast_to_stata_types
    isinstance(data[col].dtype, ExtensionDtype)
               ^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'
2026-01-19 23:02:07,404 - data_processing - INFO - 成功: 0/10 个文件
2026-01-19 23:02:07,404 - data_processing - WARNING - 步骤 4 部分完成或跳过
2026-01-19 23:03:25,064 - data_processing - INFO - AKShare 库加载成功
2026-01-19 23:03:25,064 - data_processing - INFO - 正在获取PPI数据...
2026-01-19 23:03:25,354 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-19 23:03:25,355 - data_processing - INFO - PPI: 240行数据
2026-01-19 23:03:26,356 - data_processing - INFO - 正在获取CPI数据...
2026-01-19 23:03:26,588 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-19 23:03:26,588 - data_processing - INFO - CPI: 216行数据
2026-01-19 23:03:27,589 - data_processing - INFO - 正在获取M2数据...
2026-01-19 23:03:27,847 - data_processing - INFO - 已保存: M2_原始数据.csv (216行 × 10列)
2026-01-19 23:03:27,847 - data_processing - INFO - M2: 216行数据
2026-01-19 23:03:28,848 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-19 23:03:29,079 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-19 23:03:29,080 - data_processing - INFO - 新增贷款: 216行数据
2026-01-19 23:03:30,080 - data_processing - INFO - 正在获取GDP数据...
2026-01-19 23:03:30,303 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-19 23:03:30,303 - data_processing - INFO - GDP: 80行数据
2026-01-19 23:03:31,304 - data_processing - INFO - 正在获取SHIBOR数据...
2026-01-19 23:03:34,774 - data_processing - INFO - 已保存: SHIBOR_原始数据.csv (4818行 × 3列)
2026-01-19 23:03:34,774 - data_processing - INFO - SHIBOR: 4818行数据
2026-01-19 23:03:35,775 - data_processing - WARNING - 工资数据已从国家统计局API获取
2026-01-19 23:03:35,776 - data_processing - INFO - 正在获取企业景气指数数据...
2026-01-19 23:03:36,148 - data_processing - INFO - 已保存: 企业景气指数_原始数据.csv (83行 × 7列)
2026-01-19 23:03:36,148 - data_processing - INFO - 企业景气指数: 83行数据
2026-01-19 23:03:37,149 - data_processing - INFO - 正在获取PMI数据...
2026-01-19 23:03:37,392 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-19 23:03:37,392 - data_processing - INFO - PMI: 216行数据
2026-01-19 23:03:38,393 - data_processing - INFO - 正在获取非制造业PMI数据...
2026-01-19 23:03:41,090 - data_processing - INFO - 已保存: 非制造业PMI_原始数据.csv (226行 × 5列)
2026-01-19 23:03:41,090 - data_processing - INFO - 非制造业PMI: 226行数据
2026-01-19 23:03:42,092 - data_processing - INFO - 步骤 1 完成
2026-01-19 23:03:42,092 - data_processing - INFO - 成功: 0个文件
2026-01-19 23:03:42,092 - data_processing - WARNING - 步骤 2 部分完成或跳过
2026-01-19 23:03:42,093 - data_processing - WARNING - 文件不存在: GDP_标准日期.csv
2026-01-19 23:03:42,093 - data_processing - WARNING - 文件不存在: 企业景气指数_标准日期.csv
2026-01-19 23:03:42,093 - data_processing - WARNING - 文件不存在: 工资数据_标准日期.csv
2026-01-19 23:03:42,093 - data_processing - INFO - 成功转换: 0/3 个文件
2026-01-19 23:03:42,093 - data_processing - WARNING - 步骤 3 部分完成或跳过
2026-01-19 23:03:42,093 - data_processing - WARNING - 文件不存在: CPI_标准日期.csv
2026-01-19 23:03:42,093 - data_processing - WARNING - 文件不存在: PPI_标准日期.csv
2026-01-19 23:03:42,094 - data_processing - WARNING - 文件不存在: M2_标准日期.csv
2026-01-19 23:03:42,094 - data_processing - WARNING - 文件不存在: PMI_标准日期.csv
2026-01-19 23:03:42,094 - data_processing - WARNING - 文件不存在: GDP_标准日期.csv
2026-01-19 23:03:42,094 - data_processing - WARNING - 文件不存在: 企业景气指数_标准日期.csv
2026-01-19 23:03:42,094 - data_processing - WARNING - 文件不存在: 工资数据_标准日期.csv
2026-01-19 23:03:42,094 - data_processing - WARNING - 文件不存在: 新增贷款_标准日期.csv
2026-01-19 23:03:42,094 - data_processing - WARNING - 文件不存在: SHIBOR_标准日期.csv
2026-01-19 23:03:42,094 - data_processing - WARNING - 文件不存在: 非制造业PMI_标准日期.csv
2026-01-19 23:03:42,094 - data_processing - INFO - 成功: 0/10 个文件
2026-01-19 23:03:42,094 - data_processing - WARNING - 步骤 4 部分完成或跳过
2026-01-19 23:41:45,859 - data_processing - INFO - AKShare 库加载成功
2026-01-19 23:41:45,859 - data_processing - INFO - 成功: 0个文件
2026-01-19 23:48:08,215 - data_processing - WARNING - 文件不存在: CPI_标准日期.csv
2026-01-19 23:48:08,215 - data_processing - WARNING - 文件不存在: PPI_标准日期.csv
2026-01-19 23:48:08,215 - data_processing - WARNING - 文件不存在: M2_标准日期.csv
2026-01-19 23:48:08,215 - data_processing - WARNING - 文件不存在: PMI_标准日期.csv
2026-01-19 23:48:08,216 - data_processing - WARNING - 文件不存在: GDP_标准日期.csv
2026-01-19 23:48:08,216 - data_processing - WARNING - 文件不存在: 企业景气指数_标准日期.csv
2026-01-19 23:48:08,216 - data_processing - WARNING - 文件不存在: 工资数据_标准日期.csv
2026-01-19 23:48:08,216 - data_processing - WARNING - 文件不存在: 新增贷款_标准日期.csv
2026-01-19 23:48:08,216 - data_processing - WARNING - 文件不存在: SHIBOR_标准日期.csv
2026-01-19 23:48:08,216 - data_processing - WARNING - 文件不存在: 非制造业PMI_标准日期.csv
2026-01-19 23:48:08,216 - data_processing - INFO - 成功: 0/10 个文件
2026-01-19 23:48:25,549 - data_processing - INFO - 成功: 0个文件
2026-01-19 23:50:27,029 - data_processing - INFO - 成功: 0个文件
2026-01-19 23:50:34,793 - data_processing - INFO - 成功: 0个文件
2026-01-19 23:52:20,074 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-19 23:52:20,078 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-19 23:52:20,079 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-19 23:52:20,080 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-19 23:52:20,082 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-19 23:52:20,082 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-19 23:52:20,083 - data_processing - INFO - 成功读取: M2_原始数据.csv (216行)
2026-01-19 23:52:20,086 - data_processing - INFO - 已保存: M2_标准日期.csv (216行 × 12列)
2026-01-19 23:52:20,086 - data_processing - INFO - M2_原始数据.csv → M2_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-19 23:52:20,087 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-19 23:52:20,089 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-19 23:52:20,090 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-19 23:52:20,091 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-19 23:52:20,092 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-19 23:52:20,093 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-19 23:52:20,094 - data_processing - INFO - 成功读取: 企业景气指数_原始数据.csv (83行)
2026-01-19 23:52:20,095 - data_processing - INFO - 已保存: 企业景气指数_标准日期.csv (83行 × 9列)
2026-01-19 23:52:20,096 - data_processing - INFO - 企业景气指数_原始数据.csv → 企业景气指数_标准日期.csv (83行, 2005-03-31 ~ 2025-09-30)
2026-01-19 23:52:20,096 - data_processing - WARNING - 文件不存在: 工资数据_原始数据.csv
2026-01-19 23:52:20,097 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-19 23:52:20,099 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-19 23:52:20,099 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-19 23:52:20,102 - data_processing - INFO - 成功读取: SHIBOR_原始数据.csv (4818行)
2026-01-19 23:52:20,109 - data_processing - INFO - 已保存: SHIBOR_标准日期.csv (4818行 × 5列)
2026-01-19 23:52:20,110 - data_processing - INFO - SHIBOR_原始数据.csv → SHIBOR_标准日期.csv (4818行, 2006-10-08 ~ 2026-01-19)
2026-01-19 23:52:20,111 - data_processing - INFO - 成功读取: 非制造业PMI_原始数据.csv (226行)
2026-01-19 23:52:20,112 - data_processing - INFO - 已保存: 非制造业PMI_标准日期.csv (226行 × 7列)
2026-01-19 23:52:20,113 - data_processing - INFO - 非制造业PMI_原始数据.csv → 非制造业PMI_标准日期.csv (226行, 2007-02-01 ~ 2025-08-31)
2026-01-19 23:52:20,113 - data_processing - INFO - 成功: 9个文件
2026-01-19 23:52:20,113 - data_processing - WARNING - 失败: 1个文件
2026-01-19 23:53:12,183 - data_processing - INFO - AKShare 库加载成功
2026-01-19 23:53:12,184 - data_processing - INFO - 正在获取PPI数据...
2026-01-19 23:53:12,548 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-19 23:53:12,549 - data_processing - INFO - PPI: 240行数据
2026-01-19 23:53:13,549 - data_processing - INFO - 正在获取CPI数据...
2026-01-19 23:53:13,863 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-19 23:53:13,863 - data_processing - INFO - CPI: 216行数据
2026-01-19 23:53:14,864 - data_processing - INFO - 正在获取M2数据...
2026-01-19 23:53:15,140 - data_processing - INFO - 已保存: M2_原始数据.csv (216行 × 10列)
2026-01-19 23:53:15,141 - data_processing - INFO - M2: 216行数据
2026-01-19 23:53:16,142 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-19 23:53:16,425 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-19 23:53:16,425 - data_processing - INFO - 新增贷款: 216行数据
2026-01-19 23:53:17,426 - data_processing - INFO - 正在获取GDP数据...
2026-01-19 23:53:17,697 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-19 23:53:17,698 - data_processing - INFO - GDP: 80行数据
2026-01-19 23:53:18,699 - data_processing - INFO - 正在获取SHIBOR数据...
2026-01-19 23:53:22,369 - data_processing - INFO - 已保存: SHIBOR_原始数据.csv (4818行 × 3列)
2026-01-19 23:53:22,369 - data_processing - INFO - SHIBOR: 4818行数据
2026-01-19 23:53:23,370 - data_processing - WARNING - 工资数据已从国家统计局API获取
2026-01-19 23:53:23,371 - data_processing - INFO - 正在获取企业景气指数数据...
2026-01-19 23:53:23,629 - data_processing - INFO - 已保存: 企业景气指数_原始数据.csv (83行 × 7列)
2026-01-19 23:53:23,629 - data_processing - INFO - 企业景气指数: 83行数据
2026-01-19 23:53:24,631 - data_processing - INFO - 正在获取PMI数据...
2026-01-19 23:53:24,913 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-19 23:53:24,913 - data_processing - INFO - PMI: 216行数据
2026-01-19 23:53:25,915 - data_processing - INFO - 正在获取非制造业PMI数据...
2026-01-19 23:53:29,118 - data_processing - INFO - 已保存: 非制造业PMI_原始数据.csv (226行 × 5列)
2026-01-19 23:53:29,118 - data_processing - INFO - 非制造业PMI: 226行数据
2026-01-19 23:53:30,119 - data_processing - INFO - 步骤 1 完成
2026-01-19 23:53:30,169 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-19 23:53:30,182 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-19 23:53:30,184 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-19 23:53:30,205 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-19 23:53:30,211 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-19 23:53:30,212 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-19 23:53:30,236 - data_processing - INFO - 成功读取: M2_原始数据.csv (216行)
2026-01-19 23:53:30,244 - data_processing - INFO - 已保存: M2_标准日期.csv (216行 × 12列)
2026-01-19 23:53:30,246 - data_processing - INFO - M2_原始数据.csv → M2_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-19 23:53:30,260 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-19 23:53:30,265 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-19 23:53:30,266 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-19 23:53:30,269 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-19 23:53:30,271 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-19 23:53:30,272 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-19 23:53:30,273 - data_processing - INFO - 成功读取: 企业景气指数_原始数据.csv (83行)
2026-01-19 23:53:30,275 - data_processing - INFO - 已保存: 企业景气指数_标准日期.csv (83行 × 9列)
2026-01-19 23:53:30,275 - data_processing - INFO - 企业景气指数_原始数据.csv → 企业景气指数_标准日期.csv (83行, 2005-03-31 ~ 2025-09-30)
2026-01-19 23:53:30,275 - data_processing - WARNING - 文件不存在: 工资数据_原始数据.csv
2026-01-19 23:53:30,291 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-19 23:53:30,296 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-19 23:53:30,297 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-19 23:53:30,321 - data_processing - INFO - 成功读取: SHIBOR_原始数据.csv (4818行)
2026-01-19 23:53:30,332 - data_processing - INFO - 已保存: SHIBOR_标准日期.csv (4818行 × 5列)
2026-01-19 23:53:30,334 - data_processing - INFO - SHIBOR_原始数据.csv → SHIBOR_标准日期.csv (4818行, 2006-10-08 ~ 2026-01-19)
2026-01-19 23:53:30,353 - data_processing - INFO - 成功读取: 非制造业PMI_原始数据.csv (226行)
2026-01-19 23:53:30,357 - data_processing - INFO - 已保存: 非制造业PMI_标准日期.csv (226行 × 7列)
2026-01-19 23:53:30,358 - data_processing - INFO - 非制造业PMI_原始数据.csv → 非制造业PMI_标准日期.csv (226行, 2007-02-01 ~ 2025-08-31)
2026-01-19 23:53:30,358 - data_processing - INFO - 成功: 9个文件
2026-01-19 23:53:30,358 - data_processing - WARNING - 失败: 1个文件
2026-01-19 23:53:30,358 - data_processing - INFO - 步骤 2 完成
2026-01-19 23:53:30,381 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-19 23:53:30,381 - data_processing - INFO - 原始数据: 80行
2026-01-19 23:53:30,382 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-19 23:53:30,390 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-19 23:53:30,390 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-19 23:53:30,391 - data_processing - INFO - 成功读取: 企业景气指数_标准日期.csv (83行)
2026-01-19 23:53:30,392 - data_processing - INFO - 原始数据: 83行
2026-01-19 23:53:30,392 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-19 23:53:30,396 - data_processing - INFO - 已保存: 企业景气指数_月度.csv (247行 × 7列)
2026-01-19 23:53:30,397 - data_processing - INFO - 转换完成: 83行 → 247行 (2005-03-01 ~ 2025-09-01) 方法: 线性插值
2026-01-19 23:53:30,397 - data_processing - WARNING - 文件不存在: 工资数据_标准日期.csv
2026-01-19 23:53:30,397 - data_processing - INFO - 成功转换: 2/3 个文件
2026-01-19 23:53:30,409 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-19 23:53:30,410 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-19 23:53:30,424 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-19 23:53:30,426 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-19 23:53:30,438 - data_processing - INFO - 成功读取: M2_标准日期.csv (216行)
2026-01-19 23:53:30,441 - data_processing - INFO - 已合并: M2_标准日期.csv (2列)
2026-01-19 23:53:30,453 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-19 23:53:30,455 - data_processing - INFO - 已合并: PMI_标准日期.csv (2列)
2026-01-19 23:53:30,465 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-19 23:53:30,467 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-19 23:53:30,477 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-19 23:53:30,479 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-19 23:53:30,509 - data_processing - INFO - 成功读取: 企业景气指数_月度.csv (247行)
2026-01-19 23:53:30,515 - data_processing - INFO - 已合并: 企业景气指数_月度.csv (2列)
2026-01-19 23:53:30,519 - data_processing - INFO - 已保存: 统一月度数据集.csv (250行 × 15列)
2026-01-19 23:53:30,520 - data_processing - INFO - 统一数据集: 250行 × 15列 (2005-03-01 ~ 2025-12-01)
2026-01-19 23:53:30,520 - data_processing - INFO - 步骤 3 完成
2026-01-19 23:53:30,521 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-19 23:53:30,523 - data_processing - INFO - 删除中文列: month
2026-01-19 23:53:30,525 - data_processing - ERROR - 转换失败 CPI_标准日期.csv: 'DataFrame' object has no attribute 'dtype'
2026-01-19 23:53:30,526 - data_processing - ERROR - 转换CPI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2611, in _prepare_pandas
    data = _cast_to_stata_types(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 595, in _cast_to_stata_types
    isinstance(data[col].dtype, ExtensionDtype)
               ^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'
2026-01-19 23:53:30,529 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-19 23:53:30,530 - data_processing - INFO - 删除中文列: month
2026-01-19 23:53:30,531 - data_processing - ERROR - 转换失败 PPI_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-19 23:53:30,531 - data_processing - ERROR - 转换PPI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-19 23:53:30,533 - data_processing - INFO - 正在转换: M2_标准日期.csv
2026-01-19 23:53:30,534 - data_processing - INFO - 删除中文列: month
2026-01-19 23:53:30,536 - data_processing - ERROR - 转换失败 M2_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-19 23:53:30,536 - data_processing - ERROR - 转换M2_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-19 23:53:30,537 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-19 23:53:30,537 - data_processing - INFO - 删除中文列: month
2026-01-19 23:53:30,539 - data_processing - ERROR - 转换失败 PMI_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-19 23:53:30,539 - data_processing - ERROR - 转换PMI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-19 23:53:30,541 - data_processing - INFO - 正在转换: GDP_标准日期.csv
2026-01-19 23:53:30,541 - data_processing - INFO - 删除中文列: quarter
2026-01-19 23:53:30,543 - data_processing - ERROR - 转换失败 GDP_标准日期.csv: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-19 23:53:30,543 - data_processing - ERROR - 转换GDP_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-19 23:53:30,544 - data_processing - INFO - 正在转换: 企业景气指数_标准日期.csv
2026-01-19 23:53:30,545 - data_processing - INFO - 删除中文列: quarter
2026-01-19 23:53:30,547 - data_processing - ERROR - 转换失败 企业景气指数_标准日期.csv: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-19 23:53:30,547 - data_processing - ERROR - 转换企业景气指数_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-19 23:53:30,547 - data_processing - WARNING - 文件不存在: 工资数据_标准日期.csv
2026-01-19 23:53:30,549 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-19 23:53:30,549 - data_processing - INFO - 删除中文列: month
2026-01-19 23:53:30,551 - data_processing - ERROR - 转换失败 新增贷款_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-19 23:53:30,551 - data_processing - ERROR - 转换新增贷款_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-19 23:53:30,571 - data_processing - INFO - 正在转换: SHIBOR_标准日期.csv
2026-01-19 23:53:30,573 - data_processing - ERROR - 转换失败 SHIBOR_标准日期.csv: 'DataFrame' object has no attribute 'dtype'
2026-01-19 23:53:30,574 - data_processing - ERROR - 转换SHIBOR_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2611, in _prepare_pandas
    data = _cast_to_stata_types(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 595, in _cast_to_stata_types
    isinstance(data[col].dtype, ExtensionDtype)
               ^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'
2026-01-19 23:53:30,584 - data_processing - INFO - 正在转换: 非制造业PMI_标准日期.csv
2026-01-19 23:53:30,586 - data_processing - ERROR - 转换失败 非制造业PMI_标准日期.csv: 'DataFrame' object has no attribute 'dtype'
2026-01-19 23:53:30,586 - data_processing - ERROR - 转换非制造业PMI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2611, in _prepare_pandas
    data = _cast_to_stata_types(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 595, in _cast_to_stata_types
    isinstance(data[col].dtype, ExtensionDtype)
               ^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'
2026-01-19 23:53:30,586 - data_processing - INFO - 成功: 0/10 个文件
2026-01-19 23:53:30,586 - data_processing - WARNING - 步骤 4 部分完成或跳过
2026-01-20 09:49:30,813 - data_processing - INFO - AKShare 库加载成功
2026-01-20 09:49:30,813 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 09:49:31,084 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 09:49:31,085 - data_processing - INFO - PPI: 240行数据
2026-01-20 09:49:32,085 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 09:49:32,342 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 09:49:32,342 - data_processing - INFO - CPI: 216行数据
2026-01-20 09:49:33,343 - data_processing - INFO - 正在获取M2数据...
2026-01-20 09:49:33,578 - data_processing - INFO - 已保存: M2_原始数据.csv (216行 × 10列)
2026-01-20 09:49:33,578 - data_processing - INFO - M2: 216行数据
2026-01-20 09:49:34,578 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 09:49:34,846 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 09:49:34,846 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 09:49:35,848 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 09:49:36,075 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 09:49:36,076 - data_processing - INFO - GDP: 80行数据
2026-01-20 09:49:37,077 - data_processing - INFO - 正在获取SHIBOR数据...
2026-01-20 09:49:41,130 - data_processing - INFO - 已保存: SHIBOR_原始数据.csv (4818行 × 3列)
2026-01-20 09:49:41,130 - data_processing - INFO - SHIBOR: 4818行数据
2026-01-20 09:49:42,131 - data_processing - WARNING - 工资数据已从国家统计局API获取
2026-01-20 09:49:42,131 - data_processing - INFO - 正在获取企业景气指数数据...
2026-01-20 09:49:42,372 - data_processing - INFO - 已保存: 企业景气指数_原始数据.csv (83行 × 7列)
2026-01-20 09:49:42,372 - data_processing - INFO - 企业景气指数: 83行数据
2026-01-20 09:49:43,372 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 09:49:43,593 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 09:49:43,593 - data_processing - INFO - PMI: 216行数据
2026-01-20 09:49:44,593 - data_processing - INFO - 正在获取非制造业PMI数据...
2026-01-20 09:49:47,292 - data_processing - INFO - 已保存: 非制造业PMI_原始数据.csv (226行 × 5列)
2026-01-20 09:49:47,292 - data_processing - INFO - 非制造业PMI: 226行数据
2026-01-20 09:49:48,293 - data_processing - INFO - 步骤 1 完成
2026-01-20 09:49:48,336 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 09:49:48,347 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 09:49:48,350 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 09:49:48,399 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 09:49:48,403 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 09:49:48,404 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 09:49:48,425 - data_processing - INFO - 成功读取: M2_原始数据.csv (216行)
2026-01-20 09:49:48,433 - data_processing - INFO - 已保存: M2_标准日期.csv (216行 × 12列)
2026-01-20 09:49:48,434 - data_processing - INFO - M2_原始数据.csv → M2_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 09:49:48,451 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 09:49:48,457 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 09:49:48,458 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 09:49:48,468 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 09:49:48,470 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 09:49:48,470 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 09:49:48,499 - data_processing - INFO - 成功读取: 企业景气指数_原始数据.csv (83行)
2026-01-20 09:49:48,505 - data_processing - INFO - 已保存: 企业景气指数_标准日期.csv (83行 × 9列)
2026-01-20 09:49:48,507 - data_processing - INFO - 企业景气指数_原始数据.csv → 企业景气指数_标准日期.csv (83行, 2005-03-31 ~ 2025-09-30)
2026-01-20 09:49:48,507 - data_processing - WARNING - 文件不存在: 工资数据_原始数据.csv
2026-01-20 09:49:48,548 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 09:49:48,551 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 09:49:48,552 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 09:49:48,571 - data_processing - INFO - 成功读取: SHIBOR_原始数据.csv (4818行)
2026-01-20 09:49:48,579 - data_processing - INFO - 已保存: SHIBOR_标准日期.csv (4818行 × 5列)
2026-01-20 09:49:48,580 - data_processing - INFO - SHIBOR_原始数据.csv → SHIBOR_标准日期.csv (4818行, 2006-10-08 ~ 2026-01-19)
2026-01-20 09:49:48,596 - data_processing - INFO - 成功读取: 非制造业PMI_原始数据.csv (226行)
2026-01-20 09:49:48,597 - data_processing - INFO - 已保存: 非制造业PMI_标准日期.csv (226行 × 7列)
2026-01-20 09:49:48,598 - data_processing - INFO - 非制造业PMI_原始数据.csv → 非制造业PMI_标准日期.csv (226行, 2007-02-01 ~ 2025-08-31)
2026-01-20 09:49:48,598 - data_processing - INFO - 成功: 9个文件
2026-01-20 09:49:48,598 - data_processing - WARNING - 失败: 1个文件
2026-01-20 09:49:48,598 - data_processing - INFO - 步骤 2 完成
2026-01-20 09:49:48,610 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 09:49:48,610 - data_processing - INFO - 原始数据: 80行
2026-01-20 09:49:48,612 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 09:49:48,619 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 09:49:48,620 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 09:49:48,631 - data_processing - INFO - 成功读取: 企业景气指数_标准日期.csv (83行)
2026-01-20 09:49:48,631 - data_processing - INFO - 原始数据: 83行
2026-01-20 09:49:48,632 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 09:49:48,636 - data_processing - INFO - 已保存: 企业景气指数_月度.csv (247行 × 7列)
2026-01-20 09:49:48,636 - data_processing - INFO - 转换完成: 83行 → 247行 (2005-03-01 ~ 2025-09-01) 方法: 线性插值
2026-01-20 09:49:48,636 - data_processing - WARNING - 文件不存在: 工资数据_标准日期.csv
2026-01-20 09:49:48,636 - data_processing - INFO - 成功转换: 2/3 个文件
2026-01-20 09:49:48,650 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 09:49:48,651 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 09:49:48,663 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 09:49:48,668 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 09:49:48,688 - data_processing - INFO - 成功读取: M2_标准日期.csv (216行)
2026-01-20 09:49:48,692 - data_processing - INFO - 已合并: M2_标准日期.csv (2列)
2026-01-20 09:49:48,714 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 09:49:48,716 - data_processing - INFO - 已合并: PMI_标准日期.csv (2列)
2026-01-20 09:49:48,741 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 09:49:48,743 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 09:49:48,760 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 09:49:48,763 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 09:49:48,837 - data_processing - INFO - 成功读取: 企业景气指数_月度.csv (247行)
2026-01-20 09:49:48,840 - data_processing - INFO - 已合并: 企业景气指数_月度.csv (2列)
2026-01-20 09:49:48,845 - data_processing - INFO - 已保存: 统一月度数据集.csv (250行 × 15列)
2026-01-20 09:49:48,845 - data_processing - INFO - 统一数据集: 250行 × 15列 (2005-03-01 ~ 2025-12-01)
2026-01-20 09:49:48,845 - data_processing - INFO - 步骤 3 完成
2026-01-20 09:49:48,848 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 09:49:48,852 - data_processing - INFO - 删除中文列: month
2026-01-20 09:49:48,856 - data_processing - ERROR - 转换失败 CPI_标准日期.csv: 'DataFrame' object has no attribute 'dtype'
2026-01-20 09:49:48,857 - data_processing - ERROR - 转换CPI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2611, in _prepare_pandas
    data = _cast_to_stata_types(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 595, in _cast_to_stata_types
    isinstance(data[col].dtype, ExtensionDtype)
               ^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'
2026-01-20 09:49:48,914 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 09:49:48,914 - data_processing - INFO - 删除中文列: month
2026-01-20 09:49:48,916 - data_processing - ERROR - 转换失败 PPI_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:49:48,916 - data_processing - ERROR - 转换PPI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:49:48,939 - data_processing - INFO - 正在转换: M2_标准日期.csv
2026-01-20 09:49:48,939 - data_processing - INFO - 删除中文列: month
2026-01-20 09:49:48,942 - data_processing - ERROR - 转换失败 M2_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:49:48,942 - data_processing - ERROR - 转换M2_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:49:48,944 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 09:49:48,944 - data_processing - INFO - 删除中文列: month
2026-01-20 09:49:48,946 - data_processing - ERROR - 转换失败 PMI_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:49:48,946 - data_processing - ERROR - 转换PMI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:49:48,949 - data_processing - INFO - 正在转换: GDP_标准日期.csv
2026-01-20 09:49:48,949 - data_processing - INFO - 删除中文列: quarter
2026-01-20 09:49:48,951 - data_processing - ERROR - 转换失败 GDP_标准日期.csv: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-20 09:49:48,952 - data_processing - ERROR - 转换GDP_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-20 09:49:48,953 - data_processing - INFO - 正在转换: 企业景气指数_标准日期.csv
2026-01-20 09:49:48,954 - data_processing - INFO - 删除中文列: quarter
2026-01-20 09:49:48,956 - data_processing - ERROR - 转换失败 企业景气指数_标准日期.csv: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-20 09:49:48,956 - data_processing - ERROR - 转换企业景气指数_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-20 09:49:48,957 - data_processing - WARNING - 文件不存在: 工资数据_标准日期.csv
2026-01-20 09:49:48,958 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 09:49:48,958 - data_processing - INFO - 删除中文列: month
2026-01-20 09:49:48,960 - data_processing - ERROR - 转换失败 新增贷款_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:49:48,960 - data_processing - ERROR - 转换新增贷款_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:49:48,982 - data_processing - INFO - 正在转换: SHIBOR_标准日期.csv
2026-01-20 09:49:48,985 - data_processing - ERROR - 转换失败 SHIBOR_标准日期.csv: 'DataFrame' object has no attribute 'dtype'
2026-01-20 09:49:48,985 - data_processing - ERROR - 转换SHIBOR_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2611, in _prepare_pandas
    data = _cast_to_stata_types(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 595, in _cast_to_stata_types
    isinstance(data[col].dtype, ExtensionDtype)
               ^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'
2026-01-20 09:49:48,998 - data_processing - INFO - 正在转换: 非制造业PMI_标准日期.csv
2026-01-20 09:49:49,000 - data_processing - ERROR - 转换失败 非制造业PMI_标准日期.csv: 'DataFrame' object has no attribute 'dtype'
2026-01-20 09:49:49,000 - data_processing - ERROR - 转换非制造业PMI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 114, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2611, in _prepare_pandas
    data = _cast_to_stata_types(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 595, in _cast_to_stata_types
    isinstance(data[col].dtype, ExtensionDtype)
               ^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'
2026-01-20 09:49:49,001 - data_processing - INFO - 成功: 0/10 个文件
2026-01-20 09:49:49,001 - data_processing - WARNING - 步骤 4 部分完成或跳过
2026-01-20 09:51:47,535 - data_processing - INFO - AKShare 库加载成功
2026-01-20 09:51:47,536 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 09:51:47,758 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 09:51:47,759 - data_processing - INFO - PPI: 240行数据
2026-01-20 09:51:48,759 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 09:51:49,011 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 09:51:49,011 - data_processing - INFO - CPI: 216行数据
2026-01-20 09:51:50,012 - data_processing - INFO - 正在获取M2数据...
2026-01-20 09:51:50,282 - data_processing - INFO - 已保存: M2_原始数据.csv (216行 × 10列)
2026-01-20 09:51:50,282 - data_processing - INFO - M2: 216行数据
2026-01-20 09:51:51,283 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 09:51:51,546 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 09:51:51,546 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 09:51:52,547 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 09:51:52,777 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 09:51:52,777 - data_processing - INFO - GDP: 80行数据
2026-01-20 09:51:53,778 - data_processing - INFO - 正在获取SHIBOR数据...
2026-01-20 09:51:56,901 - data_processing - INFO - 已保存: SHIBOR_原始数据.csv (4818行 × 3列)
2026-01-20 09:51:56,901 - data_processing - INFO - SHIBOR: 4818行数据
2026-01-20 09:51:57,902 - data_processing - WARNING - 工资数据已从国家统计局API获取
2026-01-20 09:51:57,902 - data_processing - INFO - 正在获取企业景气指数数据...
2026-01-20 09:51:58,140 - data_processing - INFO - 已保存: 企业景气指数_原始数据.csv (83行 × 7列)
2026-01-20 09:51:58,140 - data_processing - INFO - 企业景气指数: 83行数据
2026-01-20 09:51:59,142 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 09:51:59,484 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 09:51:59,485 - data_processing - INFO - PMI: 216行数据
2026-01-20 09:52:00,486 - data_processing - INFO - 正在获取非制造业PMI数据...
2026-01-20 09:52:03,372 - data_processing - INFO - 已保存: 非制造业PMI_原始数据.csv (226行 × 5列)
2026-01-20 09:52:03,372 - data_processing - INFO - 非制造业PMI: 226行数据
2026-01-20 09:52:04,373 - data_processing - INFO - 步骤 1 完成
2026-01-20 09:52:04,411 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 09:52:04,415 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 09:52:04,416 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 09:52:04,435 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 09:52:04,439 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 09:52:04,439 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 09:52:04,462 - data_processing - INFO - 成功读取: M2_原始数据.csv (216行)
2026-01-20 09:52:04,464 - data_processing - INFO - 已保存: M2_标准日期.csv (216行 × 12列)
2026-01-20 09:52:04,465 - data_processing - INFO - M2_原始数据.csv → M2_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 09:52:04,474 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 09:52:04,476 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 09:52:04,476 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 09:52:04,477 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 09:52:04,479 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 09:52:04,479 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 09:52:04,480 - data_processing - INFO - 成功读取: 企业景气指数_原始数据.csv (83行)
2026-01-20 09:52:04,482 - data_processing - INFO - 已保存: 企业景气指数_标准日期.csv (83行 × 9列)
2026-01-20 09:52:04,483 - data_processing - INFO - 企业景气指数_原始数据.csv → 企业景气指数_标准日期.csv (83行, 2005-03-31 ~ 2025-09-30)
2026-01-20 09:52:04,483 - data_processing - WARNING - 文件不存在: 工资数据_原始数据.csv
2026-01-20 09:52:04,492 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 09:52:04,494 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 09:52:04,494 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 09:52:04,527 - data_processing - INFO - 成功读取: SHIBOR_原始数据.csv (4818行)
2026-01-20 09:52:04,535 - data_processing - INFO - 已保存: SHIBOR_标准日期.csv (4818行 × 5列)
2026-01-20 09:52:04,537 - data_processing - INFO - SHIBOR_原始数据.csv → SHIBOR_标准日期.csv (4818行, 2006-10-08 ~ 2026-01-19)
2026-01-20 09:52:04,575 - data_processing - INFO - 成功读取: 非制造业PMI_原始数据.csv (226行)
2026-01-20 09:52:04,580 - data_processing - INFO - 已保存: 非制造业PMI_标准日期.csv (226行 × 7列)
2026-01-20 09:52:04,582 - data_processing - INFO - 非制造业PMI_原始数据.csv → 非制造业PMI_标准日期.csv (226行, 2007-02-01 ~ 2025-08-31)
2026-01-20 09:52:04,582 - data_processing - INFO - 成功: 9个文件
2026-01-20 09:52:04,582 - data_processing - WARNING - 失败: 1个文件
2026-01-20 09:52:04,582 - data_processing - INFO - 步骤 2 完成
2026-01-20 09:52:04,614 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 09:52:04,614 - data_processing - INFO - 原始数据: 80行
2026-01-20 09:52:04,616 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 09:52:04,622 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 09:52:04,622 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 09:52:04,624 - data_processing - INFO - 成功读取: 企业景气指数_标准日期.csv (83行)
2026-01-20 09:52:04,624 - data_processing - INFO - 原始数据: 83行
2026-01-20 09:52:04,625 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 09:52:04,629 - data_processing - INFO - 已保存: 企业景气指数_月度.csv (247行 × 7列)
2026-01-20 09:52:04,629 - data_processing - INFO - 转换完成: 83行 → 247行 (2005-03-01 ~ 2025-09-01) 方法: 线性插值
2026-01-20 09:52:04,629 - data_processing - WARNING - 文件不存在: 工资数据_标准日期.csv
2026-01-20 09:52:04,629 - data_processing - INFO - 成功转换: 2/3 个文件
2026-01-20 09:52:04,668 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 09:52:04,670 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 09:52:04,690 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 09:52:04,694 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 09:52:04,722 - data_processing - INFO - 成功读取: M2_标准日期.csv (216行)
2026-01-20 09:52:04,727 - data_processing - INFO - 已合并: M2_标准日期.csv (2列)
2026-01-20 09:52:04,766 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 09:52:04,770 - data_processing - INFO - 已合并: PMI_标准日期.csv (2列)
2026-01-20 09:52:04,815 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 09:52:04,817 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 09:52:04,857 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 09:52:04,858 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 09:52:04,914 - data_processing - INFO - 成功读取: 企业景气指数_月度.csv (247行)
2026-01-20 09:52:04,920 - data_processing - INFO - 已合并: 企业景气指数_月度.csv (2列)
2026-01-20 09:52:04,925 - data_processing - INFO - 已保存: 统一月度数据集.csv (250行 × 15列)
2026-01-20 09:52:04,925 - data_processing - INFO - 统一数据集: 250行 × 15列 (2005-03-01 ~ 2025-12-01)
2026-01-20 09:52:04,926 - data_processing - INFO - 步骤 3 完成
2026-01-20 09:52:04,928 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 09:52:04,930 - data_processing - INFO - 删除中文列: month
2026-01-20 09:52:04,932 - data_processing - ERROR - 转换失败 CPI_标准日期.csv: 'DataFrame' object has no attribute 'dtype'
2026-01-20 09:52:04,932 - data_processing - ERROR - 转换CPI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 127, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2611, in _prepare_pandas
    data = _cast_to_stata_types(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 595, in _cast_to_stata_types
    isinstance(data[col].dtype, ExtensionDtype)
               ^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'
2026-01-20 09:52:04,936 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 09:52:04,936 - data_processing - INFO - 删除中文列: month
2026-01-20 09:52:04,937 - data_processing - ERROR - 转换失败 PPI_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:52:04,937 - data_processing - ERROR - 转换PPI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 127, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:52:04,939 - data_processing - INFO - 正在转换: M2_标准日期.csv
2026-01-20 09:52:04,940 - data_processing - INFO - 删除中文列: month
2026-01-20 09:52:04,942 - data_processing - ERROR - 转换失败 M2_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:52:04,942 - data_processing - ERROR - 转换M2_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 127, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:52:04,944 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 09:52:04,944 - data_processing - INFO - 删除中文列: month
2026-01-20 09:52:04,945 - data_processing - ERROR - 转换失败 PMI_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:52:04,945 - data_processing - ERROR - 转换PMI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 127, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:52:04,947 - data_processing - INFO - 正在转换: GDP_标准日期.csv
2026-01-20 09:52:04,948 - data_processing - INFO - 删除中文列: quarter
2026-01-20 09:52:04,950 - data_processing - ERROR - 转换失败 GDP_标准日期.csv: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-20 09:52:04,950 - data_processing - ERROR - 转换GDP_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 127, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-20 09:52:04,951 - data_processing - INFO - 正在转换: 企业景气指数_标准日期.csv
2026-01-20 09:52:04,951 - data_processing - INFO - 删除中文列: quarter
2026-01-20 09:52:04,953 - data_processing - ERROR - 转换失败 企业景气指数_标准日期.csv: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-20 09:52:04,953 - data_processing - ERROR - 转换企业景气指数_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 127, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-20 09:52:04,954 - data_processing - WARNING - 文件不存在: 工资数据_标准日期.csv
2026-01-20 09:52:04,955 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 09:52:04,955 - data_processing - INFO - 删除中文列: month
2026-01-20 09:52:04,957 - data_processing - ERROR - 转换失败 新增贷款_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:52:04,957 - data_processing - ERROR - 转换新增贷款_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 127, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:52:04,977 - data_processing - INFO - 正在转换: SHIBOR_标准日期.csv
2026-01-20 09:52:04,979 - data_processing - ERROR - 转换失败 SHIBOR_标准日期.csv: 'DataFrame' object has no attribute 'dtype'
2026-01-20 09:52:04,979 - data_processing - ERROR - 转换SHIBOR_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 127, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2611, in _prepare_pandas
    data = _cast_to_stata_types(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 595, in _cast_to_stata_types
    isinstance(data[col].dtype, ExtensionDtype)
               ^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'
2026-01-20 09:52:04,987 - data_processing - INFO - 正在转换: 非制造业PMI_标准日期.csv
2026-01-20 09:52:04,988 - data_processing - ERROR - 转换失败 非制造业PMI_标准日期.csv: 'DataFrame' object has no attribute 'dtype'
2026-01-20 09:52:04,988 - data_processing - ERROR - 转换非制造业PMI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 127, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2611, in _prepare_pandas
    data = _cast_to_stata_types(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 595, in _cast_to_stata_types
    isinstance(data[col].dtype, ExtensionDtype)
               ^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\generic.py", line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'dtype'
2026-01-20 09:52:04,989 - data_processing - INFO - 成功: 0/10 个文件
2026-01-20 09:52:04,989 - data_processing - WARNING - 步骤 4 部分完成或跳过
2026-01-20 09:54:43,615 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 09:54:43,618 - data_processing - INFO - 删除中文列: month
2026-01-20 09:54:43,623 - data_processing - ERROR - 转换失败 CPI_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:54:43,623 - data_processing - ERROR - 转换CPI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 149, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:54:43,627 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 09:54:43,627 - data_processing - INFO - 删除中文列: month
2026-01-20 09:54:43,629 - data_processing - ERROR - 转换失败 PPI_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:54:43,629 - data_processing - ERROR - 转换PPI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 149, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:54:43,631 - data_processing - INFO - 正在转换: M2_标准日期.csv
2026-01-20 09:54:43,631 - data_processing - INFO - 删除中文列: month
2026-01-20 09:54:43,633 - data_processing - ERROR - 转换失败 M2_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:54:43,634 - data_processing - ERROR - 转换M2_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 149, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:54:43,635 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 09:54:43,635 - data_processing - INFO - 删除中文列: month
2026-01-20 09:54:43,637 - data_processing - ERROR - 转换失败 PMI_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:54:43,637 - data_processing - ERROR - 转换PMI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 149, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:54:43,639 - data_processing - INFO - 正在转换: GDP_标准日期.csv
2026-01-20 09:54:43,639 - data_processing - INFO - 删除中文列: quarter
2026-01-20 09:54:43,641 - data_processing - ERROR - 转换失败 GDP_标准日期.csv: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-20 09:54:43,641 - data_processing - ERROR - 转换GDP_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 149, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-20 09:54:43,642 - data_processing - INFO - 正在转换: 企业景气指数_标准日期.csv
2026-01-20 09:54:43,642 - data_processing - INFO - 删除中文列: quarter
2026-01-20 09:54:43,645 - data_processing - ERROR - 转换失败 企业景气指数_标准日期.csv: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-20 09:54:43,645 - data_processing - ERROR - 转换企业景气指数_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 149, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 4-5: ordinal not in range(256)
2026-01-20 09:54:43,646 - data_processing - WARNING - 文件不存在: 工资数据_标准日期.csv
2026-01-20 09:54:43,647 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 09:54:43,647 - data_processing - INFO - 删除中文列: month
2026-01-20 09:54:43,649 - data_processing - ERROR - 转换失败 新增贷款_标准日期.csv: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:54:43,649 - data_processing - ERROR - 转换新增贷款_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 149, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode character '\u5e74' in position 4: ordinal not in range(256)
2026-01-20 09:54:43,656 - data_processing - INFO - 正在转换: SHIBOR_标准日期.csv
2026-01-20 09:54:43,666 - data_processing - INFO - SHIBOR_标准日期.csv → SHIBOR_标准日期.dta (4818行 × 5列)
2026-01-20 09:54:43,668 - data_processing - INFO - 正在转换: 非制造业PMI_标准日期.csv
2026-01-20 09:54:43,670 - data_processing - ERROR - 转换失败 非制造业PMI_标准日期.csv: 'latin-1' codec can't encode characters in position 0-7: ordinal not in range(256)
2026-01-20 09:54:43,670 - data_processing - ERROR - 转换非制造业PMI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 149, in convert_single_file
    df.to_stata(dta_path, write_index=False, version=config.STATA_VERSION)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\frame.py", line 2904, in to_stata
    writer = statawriter(
             ^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 3319, in __init__
    super().__init__(
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2369, in __init__
    self._prepare_pandas(data)
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2651, in _prepare_pandas
    self._encode_strings()
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\io\stata.py", line 2691, in _encode_strings
    encoded = self.data[col].str.encode(self._encoding)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 140, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\accessor.py", line 2062, in encode
    result = self._data.array._str_encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 278, in _str_encode
    return self._str_map(f, dtype=object)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 82, in _str_map
    result = lib.map_infer_mask(arr, f, mask.view(np.uint8), map_convert)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2922, in pandas._libs.lib.map_infer_mask
  File "pandas/_libs/lib.pyx", line 2959, in pandas._libs.lib._map_infer_mask
  File "D:\Anaconda3\envs\finance\Lib\site-packages\pandas\core\strings\object_array.py", line 277, in <lambda>
    f = lambda x: x.encode(encoding, errors=errors)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 0-7: ordinal not in range(256)
2026-01-20 09:54:43,670 - data_processing - INFO - 成功: 1/10 个文件
2026-01-20 09:55:34,097 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 09:55:34,100 - data_processing - INFO - 删除中文列: month, var
2026-01-20 09:55:34,106 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 09:55:34,108 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 09:55:34,108 - data_processing - INFO - 删除中文列: month, var
2026-01-20 09:55:34,111 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (240行 × 4列)
2026-01-20 09:55:34,112 - data_processing - INFO - 正在转换: M2_标准日期.csv
2026-01-20 09:55:34,113 - data_processing - INFO - 删除中文列: month, var
2026-01-20 09:55:34,117 - data_processing - INFO - M2_标准日期.csv → M2_标准日期.dta (216行 × 10列)
2026-01-20 09:55:34,118 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 09:55:34,119 - data_processing - INFO - 删除中文列: month, var
2026-01-20 09:55:34,121 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 09:55:34,122 - data_processing - INFO - 正在转换: GDP_标准日期.csv
2026-01-20 09:55:34,123 - data_processing - INFO - 删除中文列: quarter, var
2026-01-20 09:55:34,126 - data_processing - INFO - GDP_标准日期.csv → GDP_标准日期.dta (80行 × 9列)
2026-01-20 09:55:34,127 - data_processing - INFO - 正在转换: 企业景气指数_标准日期.csv
2026-01-20 09:55:34,128 - data_processing - INFO - 删除中文列: quarter, var
2026-01-20 09:55:34,131 - data_processing - INFO - 企业景气指数_标准日期.csv → 企业景气指数_标准日期.dta (83行 × 7列)
2026-01-20 09:55:34,131 - data_processing - WARNING - 文件不存在: 工资数据_标准日期.csv
2026-01-20 09:55:34,132 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 09:55:34,132 - data_processing - INFO - 删除中文列: month, var
2026-01-20 09:55:34,136 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 09:55:34,141 - data_processing - INFO - 正在转换: SHIBOR_标准日期.csv
2026-01-20 09:55:34,150 - data_processing - INFO - SHIBOR_标准日期.csv → SHIBOR_标准日期.dta (4818行 × 5列)
2026-01-20 09:55:34,151 - data_processing - INFO - 正在转换: 非制造业PMI_标准日期.csv
2026-01-20 09:55:34,152 - data_processing - INFO - 删除中文列: var
2026-01-20 09:55:34,156 - data_processing - INFO - 非制造业PMI_标准日期.csv → 非制造业PMI_标准日期.dta (226行 × 6列)
2026-01-20 09:55:34,156 - data_processing - INFO - 成功: 9/10 个文件
2026-01-20 09:59:06,163 - data_processing - INFO - AKShare 库加载成功
2026-01-20 09:59:06,164 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 09:59:06,508 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 09:59:06,508 - data_processing - INFO - PPI: 240行数据
2026-01-20 09:59:07,508 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 09:59:07,907 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 09:59:07,907 - data_processing - INFO - CPI: 216行数据
2026-01-20 09:59:08,908 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 09:59:09,149 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 09:59:09,150 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 09:59:10,151 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 09:59:10,387 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 09:59:10,388 - data_processing - INFO - GDP: 80行数据
2026-01-20 09:59:11,388 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 09:59:11,722 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 09:59:11,722 - data_processing - INFO - PMI: 216行数据
2026-01-20 09:59:12,724 - data_processing - INFO - 步骤 1 完成
2026-01-20 09:59:12,736 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 09:59:12,740 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 09:59:12,742 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 09:59:12,754 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 09:59:12,756 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 09:59:12,757 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 09:59:12,767 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 09:59:12,769 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 09:59:12,769 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 09:59:12,771 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 09:59:12,773 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 09:59:12,773 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 09:59:12,783 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 09:59:12,785 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 09:59:12,786 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 09:59:12,786 - data_processing - INFO - 成功: 5个文件
2026-01-20 09:59:12,786 - data_processing - INFO - 步骤 2 完成
2026-01-20 09:59:12,797 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 09:59:12,797 - data_processing - INFO - 原始数据: 80行
2026-01-20 09:59:12,799 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 09:59:12,805 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 09:59:12,805 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 09:59:12,805 - data_processing - WARNING - 文件不存在: 企业景气指数_标准日期.csv
2026-01-20 09:59:12,805 - data_processing - WARNING - 文件不存在: 工资数据_标准日期.csv
2026-01-20 09:59:12,805 - data_processing - INFO - 成功转换: 1/3 个文件
2026-01-20 09:59:12,815 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 09:59:12,816 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 09:59:12,826 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 09:59:12,829 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 09:59:12,829 - data_processing - WARNING - 跳过: M2_标准日期.csv
2026-01-20 09:59:12,842 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 09:59:12,844 - data_processing - INFO - 已合并: PMI_标准日期.csv (2列)
2026-01-20 09:59:12,854 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 09:59:12,856 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 09:59:12,873 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 09:59:12,875 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 09:59:12,875 - data_processing - WARNING - 跳过: 企业景气指数_月度.csv
2026-01-20 09:59:12,878 - data_processing - INFO - 已保存: 统一月度数据集.csv (240行 × 11列)
2026-01-20 09:59:12,879 - data_processing - INFO - 统一数据集: 240行 × 11列 (2006-01-01 ~ 2025-12-01)
2026-01-20 09:59:12,880 - data_processing - INFO - 步骤 3 完成
2026-01-20 09:59:12,881 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 09:59:12,885 - data_processing - INFO - 删除中文列: month, var
2026-01-20 09:59:12,889 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 09:59:12,890 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 09:59:12,891 - data_processing - INFO - 删除中文列: month, var
2026-01-20 09:59:12,894 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (240行 × 4列)
2026-01-20 09:59:12,895 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 09:59:12,896 - data_processing - INFO - 删除中文列: month, var
2026-01-20 09:59:12,898 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 09:59:12,899 - data_processing - INFO - 正在转换: GDP_标准日期.csv
2026-01-20 09:59:12,900 - data_processing - INFO - 删除中文列: quarter, var
2026-01-20 09:59:12,903 - data_processing - INFO - GDP_标准日期.csv → GDP_标准日期.dta (80行 × 9列)
2026-01-20 09:59:12,904 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 09:59:12,904 - data_processing - INFO - 删除中文列: month, var
2026-01-20 09:59:12,908 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 09:59:12,908 - data_processing - INFO - 成功: 5/5 个文件
2026-01-20 09:59:12,908 - data_processing - INFO - 步骤 4 完成
2026-01-20 10:01:26,281 - data_processing - INFO - AKShare 库加载成功
2026-01-20 10:01:26,281 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 10:01:26,529 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 10:01:26,530 - data_processing - INFO - PPI: 240行数据
2026-01-20 10:01:27,531 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 10:01:27,829 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 10:01:27,829 - data_processing - INFO - CPI: 216行数据
2026-01-20 10:01:28,830 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 10:01:29,089 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 10:01:29,090 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 10:01:30,090 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 10:01:30,334 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 10:01:30,334 - data_processing - INFO - GDP: 80行数据
2026-01-20 10:01:31,335 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 10:01:31,562 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 10:01:31,562 - data_processing - INFO - PMI: 216行数据
2026-01-20 10:01:32,563 - data_processing - INFO - 步骤 1 完成
2026-01-20 10:01:32,579 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 10:01:32,583 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 10:01:32,587 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 10:01:32,602 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 10:01:32,607 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 10:01:32,608 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 10:01:32,620 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 10:01:32,625 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 10:01:32,625 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 10:01:32,627 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 10:01:32,629 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 10:01:32,629 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 10:01:32,641 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 10:01:32,643 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 10:01:32,643 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 10:01:32,643 - data_processing - INFO - 成功: 5个文件
2026-01-20 10:01:32,643 - data_processing - INFO - 步骤 2 完成
2026-01-20 10:01:32,659 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 10:01:32,659 - data_processing - INFO - 原始数据: 80行
2026-01-20 10:01:32,663 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 10:01:32,672 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 10:01:32,673 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 10:01:32,673 - data_processing - INFO - 成功转换: 1/1 个文件
2026-01-20 10:01:32,685 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 10:01:32,686 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 10:01:32,700 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 10:01:32,705 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 10:01:32,718 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 10:01:32,720 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 10:01:32,733 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 10:01:32,735 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 10:01:32,748 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 10:01:32,751 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 10:01:32,753 - data_processing - INFO - 已保存: 统一月度数据集.csv (240行 × 10列)
2026-01-20 10:01:32,753 - data_processing - INFO - 统一数据集: 240行 × 10列 (2006-01-01 ~ 2025-12-01)
2026-01-20 10:01:32,754 - data_processing - INFO - 步骤 3 完成
2026-01-20 10:01:32,756 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 10:01:32,759 - data_processing - INFO - 删除中文列: month, var
2026-01-20 10:01:32,763 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 10:01:32,764 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 10:01:32,765 - data_processing - INFO - 删除中文列: month, var
2026-01-20 10:01:32,767 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (240行 × 4列)
2026-01-20 10:01:32,768 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 10:01:32,769 - data_processing - INFO - 删除中文列: month, var
2026-01-20 10:01:32,772 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 10:01:32,773 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 10:01:32,777 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (238行 × 9列)
2026-01-20 10:01:32,778 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 10:01:32,778 - data_processing - INFO - 删除中文列: month, var
2026-01-20 10:01:32,782 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 10:01:32,782 - data_processing - INFO - 成功: 5/5 个文件
2026-01-20 10:01:32,782 - data_processing - INFO - 步骤 4 完成
2026-01-20 10:04:23,756 - data_processing - INFO - AKShare 库加载成功
2026-01-20 10:04:23,757 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 10:04:23,793 - data_processing - ERROR - 未找到Stata可执行文件
2026-01-20 10:04:23,793 - data_processing - WARNING - 请确保Stata已安装，或手动运行: stata -b do svar_analysis.do
2026-01-20 10:05:47,948 - data_processing - INFO - AKShare 库加载成功
2026-01-20 10:05:47,949 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 10:05:47,949 - data_processing - ERROR - 未安装pystata模块
2026-01-20 10:05:47,949 - data_processing - WARNING - 请运行: pip install pystata
2026-01-20 10:05:47,949 - data_processing - WARNING - 或手动在Stata中运行: do svar_analysis.do
2026-01-20 10:07:32,698 - data_processing - INFO - AKShare 库加载成功
2026-01-20 10:07:32,698 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 10:07:32,700 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 10:07:32,700 - data_processing - ERROR - 未找到Stata安装目录
2026-01-20 10:07:32,700 - data_processing - WARNING - 请确保Stata已安装，或手动指定Stata路径
2026-01-20 10:08:45,699 - data_processing - INFO - AKShare 库加载成功
2026-01-20 10:08:45,699 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 10:08:45,700 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 10:08:45,703 - data_processing - ERROR - Stata初始化失败: [Errno The system cannot find the shared library within the specified path: %s] D:\stata19
2026-01-20 10:08:45,703 - data_processing - WARNING - 请确保Stata已正确安装
2026-01-20 10:08:45,703 - data_processing - ERROR - Stata初始化失败
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 371, in run_stata_analysis
    stata_setup.config(stata_dir, 'se')
  File "C:\Users\123\AppData\Roaming\Python\Python311\site-packages\stata_setup.py", line 45, in config
    config.init(edition, splash=splash)
  File "D:\stata19\utilities\pystata\config.py", line 240, in init
    lib_path = os.path.normpath(_get_lib_path(st_home, edition))
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\stata19\utilities\pystata\config.py", line 82, in _get_lib_path
    raise FileNotFoundError('The system cannot find the shared library within the specified path: %s', st_home)
FileNotFoundError: [Errno The system cannot find the shared library within the specified path: %s] D:\stata19
2026-01-20 10:10:33,361 - data_processing - INFO - AKShare 库加载成功
2026-01-20 10:10:33,361 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 10:10:33,362 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 10:10:33,362 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 10:10:34,315 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 10:11:05,705 - data_processing - INFO - 生成了 17 个输出文件
2026-01-20 10:11:05,706 - data_processing - INFO - Stata分析完成
2026-01-20 10:14:16,723 - data_processing - INFO - AKShare 库加载成功
2026-01-20 10:14:16,723 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 10:14:16,724 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 10:14:16,724 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 10:14:17,168 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 10:14:28,651 - data_processing - INFO - 生成了 17 个输出文件
2026-01-20 10:14:28,651 - data_processing - INFO - Stata分析完成
2026-01-20 10:20:17,136 - data_processing - INFO - AKShare 库加载成功
2026-01-20 10:20:17,137 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 10:20:17,367 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 10:20:17,367 - data_processing - INFO - PPI: 240行数据
2026-01-20 10:20:18,367 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 10:20:18,629 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 10:20:18,629 - data_processing - INFO - CPI: 216行数据
2026-01-20 10:20:19,630 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 10:20:19,891 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 10:20:19,891 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 10:20:20,892 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 10:20:21,136 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 10:20:21,136 - data_processing - INFO - GDP: 80行数据
2026-01-20 10:20:22,138 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 10:20:22,381 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 10:20:22,383 - data_processing - INFO - PMI: 216行数据
2026-01-20 10:20:23,384 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 10:20:23,384 - data_processing - ERROR - 国债数据获取失败: bond_zh_us_rate() got an unexpected keyword argument 'symbol'
2026-01-20 10:20:23,384 - data_processing - ERROR - 获取国债数据时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\data_fetcher.py", line 105, in _fetch_bond_data
    df_10y = self.ak.bond_zh_us_rate(symbol="中国国债收益率10年")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: bond_zh_us_rate() got an unexpected keyword argument 'symbol'
2026-01-20 10:20:23,384 - data_processing - INFO - 步骤 1 完成
2026-01-20 10:20:23,397 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 10:20:23,400 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 10:20:23,401 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 10:20:23,412 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 10:20:23,415 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 10:20:23,415 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 10:20:23,427 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 10:20:23,429 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 10:20:23,430 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 10:20:23,431 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 10:20:23,432 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 10:20:23,434 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 10:20:23,444 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 10:20:23,446 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 10:20:23,447 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 10:20:23,447 - data_processing - WARNING - 文件不存在: 国债利差_原始数据.csv
2026-01-20 10:20:23,447 - data_processing - INFO - 成功: 5个文件
2026-01-20 10:20:23,447 - data_processing - WARNING - 失败: 1个文件
2026-01-20 10:20:23,447 - data_processing - INFO - 步骤 2 完成
2026-01-20 10:20:23,457 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 10:20:23,457 - data_processing - INFO - 原始数据: 80行
2026-01-20 10:20:23,459 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 10:20:23,463 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 10:20:23,463 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 10:20:23,463 - data_processing - WARNING - 文件不存在: 国债利差_标准日期.csv
2026-01-20 10:20:23,463 - data_processing - INFO - 成功转换: 1/2 个文件
2026-01-20 10:20:23,477 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 10:20:23,478 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 10:20:23,497 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 10:20:23,501 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 10:20:23,517 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 10:20:23,520 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 10:20:23,534 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 10:20:23,535 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 10:20:23,549 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 10:20:23,550 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 10:20:23,550 - data_processing - WARNING - 跳过: 国债利差_月度.csv
2026-01-20 10:20:23,553 - data_processing - INFO - 已保存: 统一月度数据集.csv (240行 × 10列)
2026-01-20 10:20:23,554 - data_processing - INFO - 统一数据集: 240行 × 10列 (2006-01-01 ~ 2025-12-01)
2026-01-20 10:20:23,555 - data_processing - INFO - 步骤 3 完成
2026-01-20 10:20:23,556 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 10:20:23,560 - data_processing - INFO - 删除中文列: month, var
2026-01-20 10:20:23,565 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 10:20:23,566 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 10:20:23,566 - data_processing - INFO - 删除中文列: month, var
2026-01-20 10:20:23,568 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (240行 × 4列)
2026-01-20 10:20:23,569 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 10:20:23,570 - data_processing - INFO - 删除中文列: month, var
2026-01-20 10:20:23,572 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 10:20:23,572 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 10:20:23,576 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (238行 × 9列)
2026-01-20 10:20:23,577 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 10:20:23,577 - data_processing - INFO - 删除中文列: month, var
2026-01-20 10:20:23,580 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 10:20:23,580 - data_processing - WARNING - 文件不存在: 国债利差_月度.csv
2026-01-20 10:20:23,580 - data_processing - INFO - 成功: 5/6 个文件
2026-01-20 10:20:23,580 - data_processing - INFO - 步骤 4 完成
2026-01-20 10:20:23,580 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 10:20:23,581 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 10:20:23,581 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 10:20:24,011 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 10:20:35,101 - data_processing - INFO - 生成了 17 个输出文件
2026-01-20 10:20:35,101 - data_processing - INFO - Stata分析完成
2026-01-20 10:20:35,101 - data_processing - INFO - 步骤 5 完成
2026-01-20 10:21:41,538 - data_processing - INFO - AKShare 库加载成功
2026-01-20 10:21:41,539 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 10:21:41,817 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 10:21:41,817 - data_processing - INFO - PPI: 240行数据
2026-01-20 10:21:42,818 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 10:21:43,056 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 10:21:43,056 - data_processing - INFO - CPI: 216行数据
2026-01-20 10:21:44,057 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 10:21:44,273 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 10:21:44,273 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 10:21:45,275 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 10:21:45,610 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 10:21:45,612 - data_processing - INFO - GDP: 80行数据
2026-01-20 10:21:46,612 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 10:21:47,114 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 10:21:47,114 - data_processing - INFO - PMI: 216行数据
2026-01-20 10:21:48,115 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 10:21:52,694 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 10:21:52,695 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 10:21:52,695 - data_processing - ERROR - 未找到所需列。数据列: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 10:21:52,695 - data_processing - INFO - 识别列: 日期=日期, 1年期=中国国债收益率2年, 10年期=美国国债收益率10年-2年
2026-01-20 10:21:52,696 - data_processing - INFO - 计算利差完成: 5608行有效数据
2026-01-20 10:21:52,706 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (5608行 × 4列)
2026-01-20 10:21:52,706 - data_processing - INFO - 国债利差: 5608行数据 (10年期-1年期)
2026-01-20 10:24:03,236 - data_processing - INFO - AKShare 库加载成功
2026-01-20 10:24:03,237 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 10:24:03,506 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 10:24:03,506 - data_processing - INFO - PPI: 240行数据
2026-01-20 10:24:04,507 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 10:24:04,759 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 10:24:04,759 - data_processing - INFO - CPI: 216行数据
2026-01-20 10:24:05,760 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 10:24:06,022 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 10:24:06,022 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 10:24:07,024 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 10:24:07,265 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 10:24:07,265 - data_processing - INFO - GDP: 80行数据
2026-01-20 10:24:08,266 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 10:24:08,524 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 10:24:08,524 - data_processing - INFO - PMI: 216行数据
2026-01-20 10:24:09,525 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 10:24:18,424 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 10:24:18,425 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 10:24:18,425 - data_processing - INFO - 使用已有利差列: 中国国债收益率10年-2年
2026-01-20 10:24:18,432 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 10:24:18,478 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 10:24:18,478 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 10:27:13,713 - data_processing - INFO - AKShare 库加载成功
2026-01-20 10:27:13,713 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 10:27:13,932 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 10:27:13,932 - data_processing - INFO - PPI: 240行数据
2026-01-20 10:27:14,933 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 10:27:15,201 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 10:27:15,201 - data_processing - INFO - CPI: 216行数据
2026-01-20 10:27:16,202 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 10:27:16,806 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 10:27:16,807 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 10:27:17,807 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 10:27:18,551 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 10:27:18,551 - data_processing - INFO - GDP: 80行数据
2026-01-20 10:27:19,552 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 10:27:19,931 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 10:27:19,931 - data_processing - INFO - PMI: 216行数据
2026-01-20 10:27:20,932 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 10:27:20,933 - data_processing - INFO - bond_china_yield方法失败: bond_china_yield() got an unexpected keyword argument 'period'
2026-01-20 10:27:20,933 - data_processing - WARNING - bond_china_yield接口不可用，尝试其他方法...
2026-01-20 10:27:25,559 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 10:27:25,559 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 10:27:25,559 - data_processing - INFO - 找到中国国债期限: ['2y', '5y', '10y']
2026-01-20 10:27:25,559 - data_processing - WARNING - 数据源无1年期国债，使用2年期替代
2026-01-20 10:27:25,561 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 10:27:25,571 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 10:27:25,572 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 10:32:19,409 - data_processing - INFO - AKShare 库加载成功
2026-01-20 10:32:19,409 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 10:32:19,677 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 10:32:19,677 - data_processing - INFO - PPI: 240行数据
2026-01-20 10:32:20,678 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 10:32:20,949 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 10:32:20,950 - data_processing - INFO - CPI: 216行数据
2026-01-20 10:32:21,950 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 10:32:22,179 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 10:32:22,180 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 10:32:23,181 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 10:32:23,463 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 10:32:23,464 - data_processing - INFO - GDP: 80行数据
2026-01-20 10:32:24,464 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 10:32:24,784 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 10:32:24,785 - data_processing - INFO - PMI: 216行数据
2026-01-20 10:32:25,785 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 10:32:25,786 - data_processing - INFO - bond_china_yield获取失败: bond_china_yield() got an unexpected keyword argument 'period'
2026-01-20 10:32:30,406 - data_processing - INFO - 10年期名义国债: 9171行数据
2026-01-20 10:32:35,091 - data_processing - WARNING - 使用美国10年期国债收益率作为实际利率代理
2026-01-20 10:32:35,091 - data_processing - INFO - 10年期实际利率: 9171行数据
2026-01-20 10:32:35,095 - data_processing - INFO - 计算完成: 5617行有效数据
2026-01-20 10:32:35,105 - data_processing - INFO - 已保存: 通胀预期_原始数据.csv (5617行 × 4列)
2026-01-20 10:32:35,106 - data_processing - INFO - 通胀预期: 5617行数据 (10年期名义-实际利率)
2026-01-20 10:37:45,550 - data_processing - INFO - AKShare 库加载成功
2026-01-20 10:37:45,550 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 10:37:45,791 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 10:37:45,792 - data_processing - INFO - PPI: 240行数据
2026-01-20 10:37:46,792 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 10:37:47,091 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 10:37:47,092 - data_processing - INFO - CPI: 216行数据
2026-01-20 10:37:48,092 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 10:37:48,355 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 10:37:48,355 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 10:37:49,356 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 10:37:49,584 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 10:37:49,584 - data_processing - INFO - GDP: 80行数据
2026-01-20 10:37:50,585 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 10:37:50,978 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 10:37:50,978 - data_processing - INFO - PMI: 216行数据
2026-01-20 10:37:51,979 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 10:37:56,502 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 10:37:56,502 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 10:37:56,502 - data_processing - INFO - 识别列: 日期=日期, 2年期=中国国债收益率2年, 10年期=中国国债收益率10年
2026-01-20 10:37:56,504 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 10:37:56,515 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 10:37:56,515 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 10:38:15,098 - data_processing - INFO - AKShare 库加载成功
2026-01-20 10:38:15,098 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 10:38:15,346 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 10:38:15,347 - data_processing - INFO - PPI: 240行数据
2026-01-20 10:38:16,347 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 10:38:16,644 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 10:38:16,644 - data_processing - INFO - CPI: 216行数据
2026-01-20 10:38:17,646 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 10:38:17,987 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 10:38:17,987 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 10:38:18,988 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 10:38:19,192 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 10:38:19,193 - data_processing - INFO - GDP: 80行数据
2026-01-20 10:38:20,193 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 10:38:20,428 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 10:38:20,428 - data_processing - INFO - PMI: 216行数据
2026-01-20 10:38:21,429 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 10:38:25,832 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 10:38:25,833 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 10:38:25,833 - data_processing - INFO - 识别列: 日期=日期, 2年期=中国国债收益率2年, 10年期=中国国债收益率10年
2026-01-20 10:38:25,834 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 10:38:25,846 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 10:38:25,846 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 10:38:25,846 - data_processing - INFO - 步骤 1 完成
2026-01-20 10:38:25,876 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 10:38:25,881 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 10:38:25,882 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 10:38:25,905 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 10:38:25,907 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 10:38:25,908 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 10:38:25,919 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 10:38:25,921 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 10:38:25,923 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 10:38:25,924 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 10:38:25,925 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 10:38:25,926 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 10:38:25,938 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 10:38:25,940 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 10:38:25,940 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 10:38:25,970 - data_processing - INFO - 成功读取: 国债利差_原始数据.csv (6008行)
2026-01-20 10:38:25,981 - data_processing - INFO - 已保存: 国债利差_标准日期.csv (6008行 × 5列)
2026-01-20 10:38:25,983 - data_processing - INFO - 国债利差_原始数据.csv → 国债利差_标准日期.csv (6008行, 2002-01-04 ~ 2026-01-19)
2026-01-20 10:38:25,983 - data_processing - INFO - 成功: 6个文件
2026-01-20 10:38:25,984 - data_processing - INFO - 步骤 2 完成
2026-01-20 10:38:25,995 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 10:38:25,996 - data_processing - INFO - 原始数据: 80行
2026-01-20 10:38:25,997 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 10:38:26,001 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 10:38:26,001 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 10:38:26,020 - data_processing - INFO - 成功读取: 国债利差_标准日期.csv (6008行)
2026-01-20 10:38:26,020 - data_processing - INFO - 原始数据: 6008行
2026-01-20 10:38:26,022 - data_processing - INFO - 检测到日度数据（平均间隔1天）
2026-01-20 10:38:26,029 - data_processing - INFO - 已保存: 国债利差_月度.csv (289行 × 4列)
2026-01-20 10:38:26,029 - data_processing - INFO - 转换完成: 6008行 → 289行 (2002-01-01 ~ 2026-01-01) 方法: 日度平均
2026-01-20 10:38:26,030 - data_processing - INFO - 成功转换: 2/2 个文件
2026-01-20 10:38:26,044 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 10:38:26,046 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 10:38:26,060 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 10:38:26,062 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 10:38:26,075 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 10:38:26,077 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 10:38:26,093 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 10:38:26,094 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 10:38:26,108 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 10:38:26,110 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 10:38:26,125 - data_processing - INFO - 成功读取: 国债利差_月度.csv (289行)
2026-01-20 10:38:26,127 - data_processing - INFO - 已合并: 国债利差_月度.csv (1列)
2026-01-20 10:38:26,129 - data_processing - INFO - 已保存: 统一月度数据集.csv (289行 × 11列)
2026-01-20 10:38:26,130 - data_processing - INFO - 统一数据集: 289行 × 11列 (2002-01-01 ~ 2026-01-01)
2026-01-20 10:38:26,130 - data_processing - INFO - 步骤 3 完成
2026-01-20 10:38:26,131 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 10:38:26,134 - data_processing - INFO - 删除中文列: month, var
2026-01-20 10:38:26,138 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 10:38:26,140 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 10:38:26,140 - data_processing - INFO - 删除中文列: month, var
2026-01-20 10:38:26,144 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (240行 × 4列)
2026-01-20 10:38:26,145 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 10:38:26,146 - data_processing - INFO - 删除中文列: month, var
2026-01-20 10:38:26,149 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 10:38:26,150 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 10:38:26,153 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (238行 × 9列)
2026-01-20 10:38:26,154 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 10:38:26,155 - data_processing - INFO - 删除中文列: month, var
2026-01-20 10:38:26,158 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 10:38:26,159 - data_processing - INFO - 正在转换: 国债利差_月度.csv
2026-01-20 10:38:26,161 - data_processing - INFO - 国债利差_月度.csv → 国债利差_标准日期.dta (289行 × 4列)
2026-01-20 10:38:26,161 - data_processing - INFO - 成功: 6/6 个文件
2026-01-20 10:38:26,161 - data_processing - INFO - 步骤 4 完成
2026-01-20 10:38:26,161 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 10:38:26,163 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 10:38:26,163 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 10:38:26,581 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 10:38:37,205 - data_processing - INFO - 生成了 17 个输出文件
2026-01-20 10:38:37,205 - data_processing - INFO - Stata分析完成
2026-01-20 10:38:37,205 - data_processing - INFO - 步骤 5 完成
2026-01-20 11:03:50,834 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:03:50,834 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 11:03:51,075 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 11:03:51,075 - data_processing - INFO - PPI: 240行数据
2026-01-20 11:03:52,076 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 11:03:52,338 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 11:03:52,338 - data_processing - INFO - CPI: 216行数据
2026-01-20 11:03:53,340 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 11:03:53,861 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 11:03:53,861 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 11:03:54,862 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 11:03:55,105 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 11:03:55,105 - data_processing - INFO - GDP: 80行数据
2026-01-20 11:03:56,105 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 11:03:56,383 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 11:03:56,383 - data_processing - INFO - PMI: 216行数据
2026-01-20 11:03:57,383 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 11:04:02,221 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 11:04:02,221 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 11:04:02,221 - data_processing - INFO - 识别列: 日期=日期, 2年期=中国国债收益率2年, 10年期=中国国债收益率10年
2026-01-20 11:04:02,223 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 11:04:02,233 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 11:04:02,233 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 11:04:02,234 - data_processing - INFO - 步骤 1 完成
2026-01-20 11:04:02,245 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 11:04:02,247 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 11:04:02,248 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:04:02,266 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 11:04:02,270 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 11:04:02,271 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 11:04:02,288 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 11:04:02,292 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 11:04:02,293 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:04:02,295 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 11:04:02,297 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 11:04:02,299 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 11:04:02,322 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 11:04:02,324 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 11:04:02,325 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:04:02,427 - data_processing - INFO - 成功读取: 国债利差_原始数据.csv (6008行)
2026-01-20 11:04:02,439 - data_processing - INFO - 已保存: 国债利差_标准日期.csv (6008行 × 5列)
2026-01-20 11:04:02,440 - data_processing - INFO - 国债利差_原始数据.csv → 国债利差_标准日期.csv (6008行, 2002-01-04 ~ 2026-01-19)
2026-01-20 11:04:02,440 - data_processing - INFO - 成功: 6个文件
2026-01-20 11:04:02,440 - data_processing - INFO - 步骤 2 完成
2026-01-20 11:04:02,450 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 11:04:02,450 - data_processing - INFO - 原始数据: 80行
2026-01-20 11:04:02,452 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 11:04:02,457 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 11:04:02,457 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 11:04:02,510 - data_processing - INFO - 成功读取: 国债利差_标准日期.csv (6008行)
2026-01-20 11:04:02,510 - data_processing - INFO - 原始数据: 6008行
2026-01-20 11:04:02,512 - data_processing - INFO - 检测到日度数据（平均间隔1天）
2026-01-20 11:04:02,518 - data_processing - INFO - 已保存: 国债利差_月度.csv (289行 × 4列)
2026-01-20 11:04:02,518 - data_processing - INFO - 转换完成: 6008行 → 289行 (2002-01-01 ~ 2026-01-01) 方法: 日度平均
2026-01-20 11:04:02,518 - data_processing - INFO - 成功转换: 2/2 个文件
2026-01-20 11:04:02,534 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 11:04:02,535 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 11:04:02,553 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 11:04:02,555 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 11:04:02,580 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 11:04:02,583 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 11:04:02,605 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 11:04:02,606 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 11:04:02,635 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 11:04:02,637 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 11:04:02,675 - data_processing - INFO - 成功读取: 国债利差_月度.csv (289行)
2026-01-20 11:04:02,678 - data_processing - INFO - 已合并: 国债利差_月度.csv (1列)
2026-01-20 11:04:02,680 - data_processing - INFO - 已保存: 统一月度数据集.csv (289行 × 11列)
2026-01-20 11:04:02,680 - data_processing - INFO - 统一数据集: 289行 × 11列 (2002-01-01 ~ 2026-01-01)
2026-01-20 11:04:02,681 - data_processing - INFO - 步骤 3 完成
2026-01-20 11:04:02,682 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 11:04:02,685 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:04:02,689 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 11:04:02,690 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 11:04:02,690 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:04:02,692 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (240行 × 4列)
2026-01-20 11:04:02,693 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 11:04:02,694 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:04:02,696 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 11:04:02,697 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 11:04:02,701 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (238行 × 9列)
2026-01-20 11:04:02,702 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 11:04:02,702 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:04:02,705 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 11:04:02,706 - data_processing - INFO - 正在转换: 国债利差_月度.csv
2026-01-20 11:04:02,709 - data_processing - INFO - 国债利差_月度.csv → 国债利差_标准日期.dta (289行 × 4列)
2026-01-20 11:04:02,709 - data_processing - INFO - 成功: 6/6 个文件
2026-01-20 11:04:02,709 - data_processing - INFO - 步骤 4 完成
2026-01-20 11:04:02,710 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 11:04:02,711 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:04:02,711 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:04:03,168 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:04:14,108 - data_processing - INFO - 生成了 17 个输出文件
2026-01-20 11:04:14,108 - data_processing - INFO - Stata分析完成
2026-01-20 11:04:14,108 - data_processing - INFO - 步骤 5 完成
2026-01-20 11:07:03,488 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:07:03,488 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 11:07:03,941 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 11:07:03,941 - data_processing - INFO - PPI: 240行数据
2026-01-20 11:07:04,943 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 11:07:05,213 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 11:07:05,214 - data_processing - INFO - CPI: 216行数据
2026-01-20 11:07:06,215 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 11:07:06,491 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 11:07:06,491 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 11:07:07,493 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 11:07:07,719 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 11:07:07,720 - data_processing - INFO - GDP: 80行数据
2026-01-20 11:07:08,721 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 11:07:08,944 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 11:07:08,944 - data_processing - INFO - PMI: 216行数据
2026-01-20 11:07:09,945 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 11:07:14,935 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 11:07:14,935 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 11:07:14,935 - data_processing - INFO - 识别列: 日期=日期, 2年期=中国国债收益率2年, 10年期=中国国债收益率10年
2026-01-20 11:07:14,937 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 11:07:14,949 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 11:07:14,949 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 11:07:14,950 - data_processing - INFO - 步骤 1 完成
2026-01-20 11:07:14,973 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 11:07:14,978 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 11:07:14,979 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:07:14,993 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 11:07:14,997 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 11:07:14,998 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 11:07:15,010 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 11:07:15,012 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 11:07:15,013 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:07:15,015 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 11:07:15,016 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 11:07:15,017 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 11:07:15,028 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 11:07:15,031 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 11:07:15,032 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:07:15,062 - data_processing - INFO - 成功读取: 国债利差_原始数据.csv (6008行)
2026-01-20 11:07:15,077 - data_processing - INFO - 已保存: 国债利差_标准日期.csv (6008行 × 5列)
2026-01-20 11:07:15,079 - data_processing - INFO - 国债利差_原始数据.csv → 国债利差_标准日期.csv (6008行, 2002-01-04 ~ 2026-01-19)
2026-01-20 11:07:15,079 - data_processing - INFO - 成功: 6个文件
2026-01-20 11:07:15,079 - data_processing - INFO - 步骤 2 完成
2026-01-20 11:07:15,110 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 11:07:15,110 - data_processing - INFO - 原始数据: 80行
2026-01-20 11:07:15,114 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 11:07:15,122 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 11:07:15,123 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 11:07:15,169 - data_processing - INFO - 成功读取: 国债利差_标准日期.csv (6008行)
2026-01-20 11:07:15,169 - data_processing - INFO - 原始数据: 6008行
2026-01-20 11:07:15,171 - data_processing - INFO - 检测到日度数据（平均间隔1天）
2026-01-20 11:07:15,177 - data_processing - INFO - 已保存: 国债利差_月度.csv (289行 × 4列)
2026-01-20 11:07:15,177 - data_processing - INFO - 转换完成: 6008行 → 289行 (2002-01-01 ~ 2026-01-01) 方法: 日度平均
2026-01-20 11:07:15,177 - data_processing - INFO - 成功转换: 2/2 个文件
2026-01-20 11:07:15,219 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 11:07:15,221 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 11:07:15,248 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 11:07:15,249 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 11:07:15,272 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 11:07:15,273 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 11:07:15,288 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 11:07:15,289 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 11:07:15,301 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 11:07:15,303 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 11:07:15,315 - data_processing - INFO - 成功读取: 国债利差_月度.csv (289行)
2026-01-20 11:07:15,317 - data_processing - INFO - 已合并: 国债利差_月度.csv (1列)
2026-01-20 11:07:15,319 - data_processing - INFO - 已保存: 统一月度数据集.csv (289行 × 11列)
2026-01-20 11:07:15,319 - data_processing - INFO - 统一数据集: 289行 × 11列 (2002-01-01 ~ 2026-01-01)
2026-01-20 11:07:15,320 - data_processing - INFO - 步骤 3 完成
2026-01-20 11:07:15,321 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 11:07:15,324 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:07:15,330 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 11:07:15,331 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 11:07:15,331 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:07:15,334 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (240行 × 4列)
2026-01-20 11:07:15,335 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 11:07:15,336 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:07:15,339 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 11:07:15,340 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 11:07:15,344 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (238行 × 9列)
2026-01-20 11:07:15,345 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 11:07:15,346 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:07:15,348 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 11:07:15,349 - data_processing - INFO - 正在转换: 国债利差_月度.csv
2026-01-20 11:07:15,351 - data_processing - INFO - 国债利差_月度.csv → 国债利差_标准日期.dta (289行 × 4列)
2026-01-20 11:07:15,352 - data_processing - INFO - 成功: 6/6 个文件
2026-01-20 11:07:15,352 - data_processing - INFO - 步骤 4 完成
2026-01-20 11:07:15,352 - data_processing - ERROR - Stata分析失败: run_stata_analysis() missing 1 required positional argument: 'file_name'
2026-01-20 11:07:15,352 - data_processing - WARNING - 步骤 5 部分完成或跳过
2026-01-20 11:08:24,882 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:08:24,882 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 11:08:25,112 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 11:08:25,113 - data_processing - INFO - PPI: 240行数据
2026-01-20 11:08:26,114 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 11:08:26,392 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 11:08:26,392 - data_processing - INFO - CPI: 216行数据
2026-01-20 11:08:27,393 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 11:08:27,662 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 11:08:27,663 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 11:08:28,664 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 11:08:28,919 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 11:08:28,919 - data_processing - INFO - GDP: 80行数据
2026-01-20 11:08:29,920 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 11:08:30,178 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 11:08:30,178 - data_processing - INFO - PMI: 216行数据
2026-01-20 11:08:31,179 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 11:08:36,177 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 11:08:36,178 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 11:08:36,178 - data_processing - INFO - 识别列: 日期=日期, 2年期=中国国债收益率2年, 10年期=中国国债收益率10年
2026-01-20 11:08:36,179 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 11:08:36,191 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 11:08:36,191 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 11:08:36,192 - data_processing - INFO - 步骤 1 完成
2026-01-20 11:08:36,233 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 11:08:36,242 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 11:08:36,244 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:08:36,284 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 11:08:36,292 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 11:08:36,295 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 11:08:36,347 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 11:08:36,358 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 11:08:36,361 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:08:36,369 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 11:08:36,375 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 11:08:36,376 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 11:08:36,416 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 11:08:36,418 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 11:08:36,418 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:08:36,476 - data_processing - INFO - 成功读取: 国债利差_原始数据.csv (6008行)
2026-01-20 11:08:36,486 - data_processing - INFO - 已保存: 国债利差_标准日期.csv (6008行 × 5列)
2026-01-20 11:08:36,488 - data_processing - INFO - 国债利差_原始数据.csv → 国债利差_标准日期.csv (6008行, 2002-01-04 ~ 2026-01-19)
2026-01-20 11:08:36,488 - data_processing - INFO - 成功: 6个文件
2026-01-20 11:08:36,488 - data_processing - INFO - 步骤 2 完成
2026-01-20 11:08:36,499 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 11:08:36,499 - data_processing - INFO - 原始数据: 80行
2026-01-20 11:08:36,500 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 11:08:36,505 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 11:08:36,505 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 11:08:36,526 - data_processing - INFO - 成功读取: 国债利差_标准日期.csv (6008行)
2026-01-20 11:08:36,526 - data_processing - INFO - 原始数据: 6008行
2026-01-20 11:08:36,528 - data_processing - INFO - 检测到日度数据（平均间隔1天）
2026-01-20 11:08:36,536 - data_processing - INFO - 已保存: 国债利差_月度.csv (289行 × 4列)
2026-01-20 11:08:36,536 - data_processing - INFO - 转换完成: 6008行 → 289行 (2002-01-01 ~ 2026-01-01) 方法: 日度平均
2026-01-20 11:08:36,536 - data_processing - INFO - 成功转换: 2/2 个文件
2026-01-20 11:08:36,551 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 11:08:36,552 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 11:08:36,561 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 11:08:36,562 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 11:08:36,576 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 11:08:36,577 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 11:08:36,586 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 11:08:36,587 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 11:08:36,595 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 11:08:36,597 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 11:08:36,621 - data_processing - INFO - 成功读取: 国债利差_月度.csv (289行)
2026-01-20 11:08:36,625 - data_processing - INFO - 已合并: 国债利差_月度.csv (1列)
2026-01-20 11:08:36,628 - data_processing - INFO - 已保存: 统一月度数据集.csv (289行 × 11列)
2026-01-20 11:08:36,629 - data_processing - INFO - 统一数据集: 289行 × 11列 (2002-01-01 ~ 2026-01-01)
2026-01-20 11:08:36,629 - data_processing - INFO - 步骤 3 完成
2026-01-20 11:08:36,631 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 11:08:36,634 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:08:36,638 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 11:08:36,639 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 11:08:36,639 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:08:36,642 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (240行 × 4列)
2026-01-20 11:08:36,643 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 11:08:36,644 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:08:36,648 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 11:08:36,648 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 11:08:36,652 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (238行 × 9列)
2026-01-20 11:08:36,653 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 11:08:36,654 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:08:36,657 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 11:08:36,657 - data_processing - INFO - 正在转换: 国债利差_月度.csv
2026-01-20 11:08:36,660 - data_processing - INFO - 国债利差_月度.csv → 国债利差_标准日期.dta (289行 × 4列)
2026-01-20 11:08:36,660 - data_processing - INFO - 成功: 6/6 个文件
2026-01-20 11:08:36,660 - data_processing - INFO - 步骤 4 完成
2026-01-20 11:08:36,660 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 11:08:36,661 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:08:36,661 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:08:37,116 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:08:48,427 - data_processing - INFO - 生成了 17 个输出文件
2026-01-20 11:08:48,427 - data_processing - INFO - Stata分析完成
2026-01-20 11:08:48,427 - data_processing - INFO - 步骤 5 完成
2026-01-20 11:10:55,653 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:10:55,653 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:10:55,654 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:10:55,654 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:10:56,091 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:10:57,238 - data_processing - ERROR - 运行Stata时出错: variable inf_exp not found
r(111);

end of do-file

r(111);

2026-01-20 11:10:57,238 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: variable inf_exp not found
r(111);

end of do-file

r(111);

2026-01-20 11:10:57,239 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 11:10:57,471 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 11:10:57,471 - data_processing - INFO - PPI: 240行数据
2026-01-20 11:10:58,472 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 11:10:58,724 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 11:10:58,724 - data_processing - INFO - CPI: 216行数据
2026-01-20 11:10:59,725 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 11:10:59,951 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 11:10:59,951 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 11:11:00,951 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 11:11:01,210 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 11:11:01,210 - data_processing - INFO - GDP: 80行数据
2026-01-20 11:11:02,211 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 11:11:02,459 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 11:11:02,459 - data_processing - INFO - PMI: 216行数据
2026-01-20 11:11:03,459 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 11:11:08,209 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 11:11:08,209 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 11:11:08,209 - data_processing - INFO - 识别列: 日期=日期, 2年期=中国国债收益率2年, 10年期=中国国债收益率10年
2026-01-20 11:11:08,211 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 11:11:08,223 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 11:11:08,223 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 11:11:08,223 - data_processing - INFO - 步骤 1 完成
2026-01-20 11:11:08,253 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 11:11:08,257 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 11:11:08,258 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:11:08,282 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 11:11:08,285 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 11:11:08,286 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 11:11:08,304 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 11:11:08,306 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 11:11:08,307 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:11:08,308 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 11:11:08,311 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 11:11:08,312 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 11:11:08,325 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 11:11:08,328 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 11:11:08,329 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:11:08,360 - data_processing - INFO - 成功读取: 国债利差_原始数据.csv (6008行)
2026-01-20 11:11:08,373 - data_processing - INFO - 已保存: 国债利差_标准日期.csv (6008行 × 5列)
2026-01-20 11:11:08,375 - data_processing - INFO - 国债利差_原始数据.csv → 国债利差_标准日期.csv (6008行, 2002-01-04 ~ 2026-01-19)
2026-01-20 11:11:08,375 - data_processing - INFO - 成功: 6个文件
2026-01-20 11:11:08,375 - data_processing - INFO - 步骤 2 完成
2026-01-20 11:11:08,388 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 11:11:08,388 - data_processing - INFO - 原始数据: 80行
2026-01-20 11:11:08,389 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 11:11:08,394 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 11:11:08,395 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 11:11:08,424 - data_processing - INFO - 成功读取: 国债利差_标准日期.csv (6008行)
2026-01-20 11:11:08,424 - data_processing - INFO - 原始数据: 6008行
2026-01-20 11:11:08,426 - data_processing - INFO - 检测到日度数据（平均间隔1天）
2026-01-20 11:11:08,433 - data_processing - INFO - 已保存: 国债利差_月度.csv (289行 × 4列)
2026-01-20 11:11:08,434 - data_processing - INFO - 转换完成: 6008行 → 289行 (2002-01-01 ~ 2026-01-01) 方法: 日度平均
2026-01-20 11:11:08,434 - data_processing - INFO - 成功转换: 2/2 个文件
2026-01-20 11:11:08,471 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 11:11:08,472 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 11:11:08,489 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 11:11:08,491 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 11:11:08,505 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 11:11:08,508 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 11:11:08,548 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 11:11:08,550 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 11:11:08,581 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 11:11:08,583 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 11:11:08,610 - data_processing - INFO - 成功读取: 国债利差_月度.csv (289行)
2026-01-20 11:11:08,612 - data_processing - INFO - 已合并: 国债利差_月度.csv (1列)
2026-01-20 11:11:08,614 - data_processing - INFO - 已保存: 统一月度数据集.csv (289行 × 11列)
2026-01-20 11:11:08,615 - data_processing - INFO - 统一数据集: 289行 × 11列 (2002-01-01 ~ 2026-01-01)
2026-01-20 11:11:08,615 - data_processing - INFO - 步骤 3 完成
2026-01-20 11:11:08,617 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 11:11:08,620 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:11:08,625 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 11:11:08,627 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 11:11:08,627 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:11:08,631 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (240行 × 4列)
2026-01-20 11:11:08,632 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 11:11:08,632 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:11:08,635 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 11:11:08,637 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 11:11:08,641 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (238行 × 9列)
2026-01-20 11:11:08,642 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 11:11:08,643 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:11:08,646 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 11:11:08,647 - data_processing - INFO - 正在转换: 国债利差_月度.csv
2026-01-20 11:11:08,650 - data_processing - INFO - 国债利差_月度.csv → 国债利差_标准日期.dta (289行 × 4列)
2026-01-20 11:11:08,650 - data_processing - INFO - 成功: 6/6 个文件
2026-01-20 11:11:08,650 - data_processing - INFO - 步骤 4 完成
2026-01-20 11:11:08,650 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 11:11:08,650 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:11:08,650 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:11:08,650 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:11:19,348 - data_processing - INFO - 生成了 18 个输出文件
2026-01-20 11:11:19,348 - data_processing - INFO - Stata分析完成
2026-01-20 11:11:19,348 - data_processing - INFO - 步骤 5 完成
2026-01-20 11:11:19,348 - data_processing - ERROR - 步骤 6 失败: 'bool' object is not callable
2026-01-20 11:11:19,348 - data_processing - ERROR - 执行步骤6时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 89, in run_all
    success = step_func()
              ^^^^^^^^^^^
TypeError: 'bool' object is not callable
2026-01-20 11:12:52,614 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:12:52,614 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:12:52,615 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:12:52,615 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:12:53,064 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:12:54,257 - data_processing - ERROR - 运行Stata时出错: file ../output/扩展SVAR_价格变量时间序列图.png written in PNG format

. 
. * 生成时间序列图 - 传导渠道变量
. tsline inf_exp pmi, ///
>     title("传导渠道变量") ///
>     ytitle("指数/利差") ///
>     legend(label(1 "通胀预期(利差)") label(2 "PMI")) ///
>     name(tsline_channel, replace)
variable inf_exp not found
r(111);

end of do-file

r(111);

2026-01-20 11:12:54,257 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: file ../output/扩展SVAR_价格变量时间序列图.png written in PNG format

. 
. * 生成时间序列图 - 传导渠道变量
. tsline inf_exp pmi, ///
>     title("传导渠道变量") ///
>     ytitle("指数/利差") ///
>     legend(label(1 "通胀预期(利差)") label(2 "PMI")) ///
>     name(tsline_channel, replace)
variable inf_exp not found
r(111);

end of do-file

r(111);

2026-01-20 11:12:54,258 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 11:12:54,625 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 11:12:54,626 - data_processing - INFO - PPI: 240行数据
2026-01-20 11:12:55,626 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 11:12:55,896 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 11:12:55,896 - data_processing - INFO - CPI: 216行数据
2026-01-20 11:12:56,896 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 11:12:57,136 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 11:12:57,136 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 11:12:58,137 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 11:12:58,358 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 11:12:58,358 - data_processing - INFO - GDP: 80行数据
2026-01-20 11:12:59,359 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 11:12:59,618 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 11:12:59,618 - data_processing - INFO - PMI: 216行数据
2026-01-20 11:13:00,619 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 11:13:05,879 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 11:13:05,880 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 11:13:05,880 - data_processing - INFO - 识别列: 日期=日期, 2年期=中国国债收益率2年, 10年期=中国国债收益率10年
2026-01-20 11:13:05,881 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 11:13:05,892 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 11:13:05,892 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 11:13:05,892 - data_processing - INFO - 步骤 1 完成
2026-01-20 11:13:05,914 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 11:13:05,917 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 11:13:05,917 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:13:05,953 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 11:13:05,957 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 11:13:05,958 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 11:13:05,975 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 11:13:05,980 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 11:13:05,981 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:13:05,983 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 11:13:05,985 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 11:13:05,985 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 11:13:06,001 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 11:13:06,004 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 11:13:06,005 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:13:06,043 - data_processing - INFO - 成功读取: 国债利差_原始数据.csv (6008行)
2026-01-20 11:13:06,056 - data_processing - INFO - 已保存: 国债利差_标准日期.csv (6008行 × 5列)
2026-01-20 11:13:06,058 - data_processing - INFO - 国债利差_原始数据.csv → 国债利差_标准日期.csv (6008行, 2002-01-04 ~ 2026-01-19)
2026-01-20 11:13:06,058 - data_processing - INFO - 成功: 6个文件
2026-01-20 11:13:06,058 - data_processing - INFO - 步骤 2 完成
2026-01-20 11:13:06,074 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 11:13:06,074 - data_processing - INFO - 原始数据: 80行
2026-01-20 11:13:06,075 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 11:13:06,082 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 11:13:06,082 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 11:13:06,113 - data_processing - INFO - 成功读取: 国债利差_标准日期.csv (6008行)
2026-01-20 11:13:06,114 - data_processing - INFO - 原始数据: 6008行
2026-01-20 11:13:06,115 - data_processing - INFO - 检测到日度数据（平均间隔1天）
2026-01-20 11:13:06,122 - data_processing - INFO - 已保存: 国债利差_月度.csv (289行 × 4列)
2026-01-20 11:13:06,122 - data_processing - INFO - 转换完成: 6008行 → 289行 (2002-01-01 ~ 2026-01-01) 方法: 日度平均
2026-01-20 11:13:06,122 - data_processing - INFO - 成功转换: 2/2 个文件
2026-01-20 11:13:06,137 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 11:13:06,137 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 11:13:06,161 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 11:13:06,167 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 11:13:06,190 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 11:13:06,193 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 11:13:06,211 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 11:13:06,217 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 11:13:06,239 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 11:13:06,245 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 11:13:06,299 - data_processing - INFO - 成功读取: 国债利差_月度.csv (289行)
2026-01-20 11:13:06,304 - data_processing - INFO - 已合并: 国债利差_月度.csv (1列)
2026-01-20 11:13:06,309 - data_processing - INFO - 已保存: 统一月度数据集.csv (289行 × 11列)
2026-01-20 11:13:06,310 - data_processing - INFO - 统一数据集: 289行 × 11列 (2002-01-01 ~ 2026-01-01)
2026-01-20 11:13:06,311 - data_processing - INFO - 步骤 3 完成
2026-01-20 11:13:06,312 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 11:13:06,315 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:13:06,319 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 11:13:06,320 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 11:13:06,321 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:13:06,323 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (240行 × 4列)
2026-01-20 11:13:06,324 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 11:13:06,325 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:13:06,327 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 11:13:06,327 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 11:13:06,332 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (238行 × 9列)
2026-01-20 11:13:06,333 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 11:13:06,333 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:13:06,336 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 11:13:06,337 - data_processing - INFO - 正在转换: 国债利差_月度.csv
2026-01-20 11:13:06,339 - data_processing - INFO - 国债利差_月度.csv → 国债利差_标准日期.dta (289行 × 4列)
2026-01-20 11:13:06,339 - data_processing - INFO - 成功: 6/6 个文件
2026-01-20 11:13:06,339 - data_processing - INFO - 步骤 4 完成
2026-01-20 11:13:06,339 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 11:13:06,339 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:13:06,339 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:13:06,339 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:13:17,085 - data_processing - INFO - 生成了 18 个输出文件
2026-01-20 11:13:17,085 - data_processing - INFO - Stata分析完成
2026-01-20 11:13:17,085 - data_processing - INFO - 步骤 5 完成
2026-01-20 11:13:17,085 - data_processing - ERROR - 步骤 6 失败: 'bool' object is not callable
2026-01-20 11:13:17,085 - data_processing - ERROR - 执行步骤6时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 89, in run_all
    success = step_func()
              ^^^^^^^^^^^
TypeError: 'bool' object is not callable
2026-01-20 11:17:19,993 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:17:19,993 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:17:19,994 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:17:19,994 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:17:20,440 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:17:21,566 - data_processing - ERROR - 运行Stata时出错: file ../output/扩展SVAR_价格变量时间序列图.png written in PNG format

. 
. * 生成时间序列图 - 传导渠道变量
. tsline inf_exp pmi, ///
>     title("传导渠道变量") ///
>     ytitle("指数/利差") ///
>     legend(label(1 "通胀预期(利差)") label(2 "PMI")) ///
>     name(tsline_channel, replace)
variable inf_exp not found
r(111);

end of do-file

r(111);

2026-01-20 11:17:21,566 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: file ../output/扩展SVAR_价格变量时间序列图.png written in PNG format

. 
. * 生成时间序列图 - 传导渠道变量
. tsline inf_exp pmi, ///
>     title("传导渠道变量") ///
>     ytitle("指数/利差") ///
>     legend(label(1 "通胀预期(利差)") label(2 "PMI")) ///
>     name(tsline_channel, replace)
variable inf_exp not found
r(111);

end of do-file

r(111);

2026-01-20 11:17:21,567 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 11:17:22,092 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 11:17:22,092 - data_processing - INFO - PPI: 240行数据
2026-01-20 11:17:23,093 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 11:17:23,393 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 11:17:23,393 - data_processing - INFO - CPI: 216行数据
2026-01-20 11:17:24,394 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 11:17:24,641 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 11:17:24,641 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 11:17:25,642 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 11:17:25,902 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 11:17:25,903 - data_processing - INFO - GDP: 80行数据
2026-01-20 11:17:26,904 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 11:17:27,201 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 11:17:27,201 - data_processing - INFO - PMI: 216行数据
2026-01-20 11:17:28,203 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 11:17:33,086 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 11:17:33,086 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 11:17:33,086 - data_processing - INFO - 识别列: 日期=日期, 2年期=中国国债收益率2年, 10年期=中国国债收益率10年
2026-01-20 11:17:33,088 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 11:17:33,100 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 11:17:33,100 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 11:17:33,100 - data_processing - INFO - 步骤 1 完成
2026-01-20 11:17:33,115 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 11:17:33,119 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 11:17:33,119 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:17:33,130 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 11:17:33,133 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 11:17:33,134 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 11:17:33,170 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 11:17:33,179 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 11:17:33,181 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:17:33,184 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 11:17:33,188 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 11:17:33,190 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 11:17:33,243 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 11:17:33,248 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 11:17:33,251 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:17:33,330 - data_processing - INFO - 成功读取: 国债利差_原始数据.csv (6008行)
2026-01-20 11:17:33,344 - data_processing - INFO - 已保存: 国债利差_标准日期.csv (6008行 × 5列)
2026-01-20 11:17:33,345 - data_processing - INFO - 国债利差_原始数据.csv → 国债利差_标准日期.csv (6008行, 2002-01-04 ~ 2026-01-19)
2026-01-20 11:17:33,345 - data_processing - INFO - 成功: 6个文件
2026-01-20 11:17:33,345 - data_processing - INFO - 步骤 2 完成
2026-01-20 11:17:33,382 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 11:17:33,383 - data_processing - INFO - 原始数据: 80行
2026-01-20 11:17:33,386 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 11:17:33,391 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 11:17:33,392 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 11:17:33,420 - data_processing - INFO - 成功读取: 国债利差_标准日期.csv (6008行)
2026-01-20 11:17:33,420 - data_processing - INFO - 原始数据: 6008行
2026-01-20 11:17:33,423 - data_processing - INFO - 检测到日度数据（平均间隔1天）
2026-01-20 11:17:33,429 - data_processing - INFO - 已保存: 国债利差_月度.csv (289行 × 4列)
2026-01-20 11:17:33,429 - data_processing - INFO - 转换完成: 6008行 → 289行 (2002-01-01 ~ 2026-01-01) 方法: 日度平均
2026-01-20 11:17:33,429 - data_processing - INFO - 成功转换: 2/2 个文件
2026-01-20 11:17:33,452 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 11:17:33,453 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 11:17:33,502 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 11:17:33,511 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 11:17:33,564 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 11:17:33,566 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 11:17:33,616 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 11:17:33,619 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 11:17:33,657 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 11:17:33,660 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 11:17:33,697 - data_processing - INFO - 成功读取: 国债利差_月度.csv (289行)
2026-01-20 11:17:33,702 - data_processing - INFO - 已合并: 国债利差_月度.csv (1列)
2026-01-20 11:17:33,707 - data_processing - INFO - 已保存: 统一月度数据集.csv (289行 × 11列)
2026-01-20 11:17:33,707 - data_processing - INFO - 统一数据集: 289行 × 11列 (2002-01-01 ~ 2026-01-01)
2026-01-20 11:17:33,708 - data_processing - INFO - 步骤 3 完成
2026-01-20 11:17:33,709 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 11:17:33,712 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:17:33,717 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 11:17:33,717 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 11:17:33,718 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:17:33,720 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (240行 × 4列)
2026-01-20 11:17:33,721 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 11:17:33,722 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:17:33,724 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 11:17:33,725 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 11:17:33,729 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (238行 × 9列)
2026-01-20 11:17:33,730 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 11:17:33,731 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:17:33,734 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 11:17:33,735 - data_processing - INFO - 正在转换: 国债利差_月度.csv
2026-01-20 11:17:33,738 - data_processing - INFO - 国债利差_月度.csv → 国债利差_标准日期.dta (289行 × 4列)
2026-01-20 11:17:33,738 - data_processing - INFO - 成功: 6/6 个文件
2026-01-20 11:17:33,738 - data_processing - INFO - 步骤 4 完成
2026-01-20 11:17:33,738 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 11:17:33,738 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:17:33,738 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:17:33,738 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:17:44,910 - data_processing - INFO - 生成了 18 个输出文件
2026-01-20 11:17:44,910 - data_processing - INFO - Stata分析完成
2026-01-20 11:17:44,910 - data_processing - INFO - 步骤 5 完成
2026-01-20 11:17:44,910 - data_processing - ERROR - 步骤 6 失败: 'bool' object is not callable
2026-01-20 11:17:44,910 - data_processing - ERROR - 执行步骤6时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 89, in run_all
    success = step_func()
              ^^^^^^^^^^^
TypeError: 'bool' object is not callable
2026-01-20 11:18:09,998 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:18:09,998 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:18:09,999 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:18:09,999 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:18:10,433 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:18:11,592 - data_processing - ERROR - 运行Stata时出错: file ../output/扩展SVAR_价格变量时间序列图.png written in PNG format

. 
. * 生成时间序列图 - 传导渠道变量
. tsline inf_exp pmi, ///
>     title("传导渠道变量") ///
>     ytitle("指数/利差") ///
>     legend(label(1 "通胀预期(利差)") label(2 "PMI")) ///
>     name(tsline_channel, replace)
pmi ambiguous abbreviation
r(111);

end of do-file

r(111);

2026-01-20 11:18:11,592 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: file ../output/扩展SVAR_价格变量时间序列图.png written in PNG format

. 
. * 生成时间序列图 - 传导渠道变量
. tsline inf_exp pmi, ///
>     title("传导渠道变量") ///
>     ytitle("指数/利差") ///
>     legend(label(1 "通胀预期(利差)") label(2 "PMI")) ///
>     name(tsline_channel, replace)
pmi ambiguous abbreviation
r(111);

end of do-file

r(111);

2026-01-20 11:18:11,593 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 11:18:11,845 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 11:18:11,845 - data_processing - INFO - PPI: 240行数据
2026-01-20 11:18:12,846 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 11:18:13,113 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 11:18:13,113 - data_processing - INFO - CPI: 216行数据
2026-01-20 11:18:14,114 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 11:18:14,418 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 11:18:14,418 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 11:18:15,418 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 11:18:15,691 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 11:18:15,691 - data_processing - INFO - GDP: 80行数据
2026-01-20 11:18:16,692 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 11:18:16,934 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 11:18:16,934 - data_processing - INFO - PMI: 216行数据
2026-01-20 11:18:17,935 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 11:18:23,005 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 11:18:23,005 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 11:18:23,007 - data_processing - INFO - 识别列: 日期=日期, 2年期=中国国债收益率2年, 10年期=中国国债收益率10年
2026-01-20 11:18:23,009 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 11:18:23,019 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 11:18:23,020 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 11:18:23,020 - data_processing - INFO - 步骤 1 完成
2026-01-20 11:18:23,030 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 11:18:23,033 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 11:18:23,034 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:18:23,048 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 11:18:23,050 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 11:18:23,051 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 11:18:23,059 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 11:18:23,061 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 11:18:23,062 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:18:23,063 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 11:18:23,065 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 11:18:23,065 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 11:18:23,080 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 11:18:23,083 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 11:18:23,083 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:18:23,111 - data_processing - INFO - 成功读取: 国债利差_原始数据.csv (6008行)
2026-01-20 11:18:23,122 - data_processing - INFO - 已保存: 国债利差_标准日期.csv (6008行 × 5列)
2026-01-20 11:18:23,124 - data_processing - INFO - 国债利差_原始数据.csv → 国债利差_标准日期.csv (6008行, 2002-01-04 ~ 2026-01-19)
2026-01-20 11:18:23,124 - data_processing - INFO - 成功: 6个文件
2026-01-20 11:18:23,124 - data_processing - INFO - 步骤 2 完成
2026-01-20 11:18:23,139 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 11:18:23,139 - data_processing - INFO - 原始数据: 80行
2026-01-20 11:18:23,140 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 11:18:23,145 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 11:18:23,145 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 11:18:23,165 - data_processing - INFO - 成功读取: 国债利差_标准日期.csv (6008行)
2026-01-20 11:18:23,165 - data_processing - INFO - 原始数据: 6008行
2026-01-20 11:18:23,167 - data_processing - INFO - 检测到日度数据（平均间隔1天）
2026-01-20 11:18:23,173 - data_processing - INFO - 已保存: 国债利差_月度.csv (289行 × 4列)
2026-01-20 11:18:23,173 - data_processing - INFO - 转换完成: 6008行 → 289行 (2002-01-01 ~ 2026-01-01) 方法: 日度平均
2026-01-20 11:18:23,173 - data_processing - INFO - 成功转换: 2/2 个文件
2026-01-20 11:18:23,186 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 11:18:23,187 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 11:18:23,199 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 11:18:23,201 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 11:18:23,217 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 11:18:23,218 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 11:18:23,233 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 11:18:23,235 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 11:18:23,244 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 11:18:23,245 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 11:18:23,260 - data_processing - INFO - 成功读取: 国债利差_月度.csv (289行)
2026-01-20 11:18:23,262 - data_processing - INFO - 已合并: 国债利差_月度.csv (1列)
2026-01-20 11:18:23,264 - data_processing - INFO - 已保存: 统一月度数据集.csv (289行 × 11列)
2026-01-20 11:18:23,265 - data_processing - INFO - 统一数据集: 289行 × 11列 (2002-01-01 ~ 2026-01-01)
2026-01-20 11:18:23,265 - data_processing - INFO - 步骤 3 完成
2026-01-20 11:18:23,266 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 11:18:23,268 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:18:23,273 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 11:18:23,274 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 11:18:23,275 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:18:23,278 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (240行 × 4列)
2026-01-20 11:18:23,278 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 11:18:23,279 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:18:23,282 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 11:18:23,282 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 11:18:23,287 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (238行 × 9列)
2026-01-20 11:18:23,287 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 11:18:23,288 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:18:23,291 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 11:18:23,292 - data_processing - INFO - 正在转换: 国债利差_月度.csv
2026-01-20 11:18:23,295 - data_processing - INFO - 国债利差_月度.csv → 国债利差_标准日期.dta (289行 × 4列)
2026-01-20 11:18:23,295 - data_processing - INFO - 成功: 6/6 个文件
2026-01-20 11:18:23,295 - data_processing - INFO - 步骤 4 完成
2026-01-20 11:18:23,295 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 11:18:23,295 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:18:23,295 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:18:23,295 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:19:26,067 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:19:26,067 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:19:26,067 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:19:26,067 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:19:26,505 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:19:27,591 - data_processing - ERROR - 运行Stata时出错: file ../output/扩展SVAR_价格变量时间序列图.png written in PNG format

. 
. * 生成时间序列图 - 传导渠道变量
. tsline inf_exp pmi, ///
>     title("传导渠道变量") ///
>     ytitle("指数/利差") ///
>     legend(label(1 "通胀预期(利差)") label(2 "PMI")) ///
>     name(tsline_channel, replace)
pmi ambiguous abbreviation
r(111);

end of do-file

r(111);

2026-01-20 11:19:27,591 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: file ../output/扩展SVAR_价格变量时间序列图.png written in PNG format

. 
. * 生成时间序列图 - 传导渠道变量
. tsline inf_exp pmi, ///
>     title("传导渠道变量") ///
>     ytitle("指数/利差") ///
>     legend(label(1 "通胀预期(利差)") label(2 "PMI")) ///
>     name(tsline_channel, replace)
pmi ambiguous abbreviation
r(111);

end of do-file

r(111);

2026-01-20 11:19:27,592 - data_processing - INFO - 步骤 1 完成
2026-01-20 11:19:27,592 - data_processing - INFO - 步骤 2 完成
2026-01-20 11:19:27,592 - data_processing - INFO - 步骤 3 完成
2026-01-20 11:19:27,592 - data_processing - INFO - 步骤 4 完成
2026-01-20 11:19:27,592 - data_processing - INFO - 步骤 5 完成
2026-01-20 11:19:27,592 - data_processing - WARNING - 步骤 6 部分完成或跳过
2026-01-20 11:19:49,551 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:19:49,551 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:19:49,552 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:19:49,552 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:19:49,988 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:19:51,071 - data_processing - ERROR - 运行Stata时出错: 
. 
. * 生成时间序列图 - 传导渠道变量
. tsline inf_exp pmi, ///
>     title("传导渠道变量") ///
>     ytitle("指数/利差") ///
>     legend(label(1 "通胀预期(利差)") label(2 "PMI")) ///
>     name(tsline_channel, replace)
pmi ambiguous abbreviation
r(111);

end of do-file

r(111);

2026-01-20 11:19:51,071 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: 
. 
. * 生成时间序列图 - 传导渠道变量
. tsline inf_exp pmi, ///
>     title("传导渠道变量") ///
>     ytitle("指数/利差") ///
>     legend(label(1 "通胀预期(利差)") label(2 "PMI")) ///
>     name(tsline_channel, replace)
pmi ambiguous abbreviation
r(111);

end of do-file

r(111);

2026-01-20 11:19:51,072 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 11:19:51,322 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 11:19:51,323 - data_processing - INFO - PPI: 240行数据
2026-01-20 11:19:52,324 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 11:19:52,647 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 11:19:52,647 - data_processing - INFO - CPI: 216行数据
2026-01-20 11:19:53,649 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 11:19:53,941 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 11:19:53,941 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 11:19:54,942 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 11:19:55,193 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 11:19:55,194 - data_processing - INFO - GDP: 80行数据
2026-01-20 11:19:56,196 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 11:19:56,568 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 11:19:56,568 - data_processing - INFO - PMI: 216行数据
2026-01-20 11:19:57,569 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 11:20:02,345 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 11:20:02,347 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 11:20:02,347 - data_processing - INFO - 识别列: 日期=日期, 2年期=中国国债收益率2年, 10年期=中国国债收益率10年
2026-01-20 11:20:02,349 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 11:20:02,360 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 11:20:02,360 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 11:20:02,361 - data_processing - INFO - 步骤 1 完成
2026-01-20 11:20:02,371 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 11:20:02,374 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 11:20:02,375 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:20:02,404 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 11:20:02,409 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 11:20:02,410 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 11:20:02,452 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 11:20:02,455 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 11:20:02,456 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:20:02,459 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 11:20:02,462 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 11:20:02,463 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 11:20:02,482 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 11:20:02,485 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 11:20:02,485 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:20:02,548 - data_processing - INFO - 成功读取: 国债利差_原始数据.csv (6008行)
2026-01-20 11:20:02,561 - data_processing - INFO - 已保存: 国债利差_标准日期.csv (6008行 × 5列)
2026-01-20 11:20:02,562 - data_processing - INFO - 国债利差_原始数据.csv → 国债利差_标准日期.csv (6008行, 2002-01-04 ~ 2026-01-19)
2026-01-20 11:20:02,562 - data_processing - INFO - 成功: 6个文件
2026-01-20 11:20:02,562 - data_processing - INFO - 步骤 2 完成
2026-01-20 11:20:02,592 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 11:20:02,592 - data_processing - INFO - 原始数据: 80行
2026-01-20 11:20:02,594 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 11:20:02,600 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 11:20:02,600 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 11:20:02,624 - data_processing - INFO - 成功读取: 国债利差_标准日期.csv (6008行)
2026-01-20 11:20:02,624 - data_processing - INFO - 原始数据: 6008行
2026-01-20 11:20:02,626 - data_processing - INFO - 检测到日度数据（平均间隔1天）
2026-01-20 11:20:02,631 - data_processing - INFO - 已保存: 国债利差_月度.csv (289行 × 4列)
2026-01-20 11:20:02,632 - data_processing - INFO - 转换完成: 6008行 → 289行 (2002-01-01 ~ 2026-01-01) 方法: 日度平均
2026-01-20 11:20:02,632 - data_processing - INFO - 成功转换: 2/2 个文件
2026-01-20 11:20:02,650 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 11:20:02,651 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 11:20:02,666 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 11:20:02,669 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 11:20:02,683 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 11:20:02,685 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 11:20:02,696 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 11:20:02,697 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 11:20:02,711 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 11:20:02,714 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 11:20:02,752 - data_processing - INFO - 成功读取: 国债利差_月度.csv (289行)
2026-01-20 11:20:02,759 - data_processing - INFO - 已合并: 国债利差_月度.csv (1列)
2026-01-20 11:20:02,765 - data_processing - INFO - 已保存: 统一月度数据集.csv (289行 × 11列)
2026-01-20 11:20:02,767 - data_processing - INFO - 统一数据集: 289行 × 11列 (2002-01-01 ~ 2026-01-01)
2026-01-20 11:20:02,768 - data_processing - INFO - 步骤 3 完成
2026-01-20 11:20:02,770 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 11:20:02,774 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:20:02,779 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 11:20:02,780 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 11:20:02,781 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:20:02,783 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (240行 × 4列)
2026-01-20 11:20:02,784 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 11:20:02,784 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:20:02,788 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 11:20:02,788 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 11:20:02,792 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (238行 × 9列)
2026-01-20 11:20:02,793 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 11:20:02,793 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:20:02,795 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 11:20:02,797 - data_processing - INFO - 正在转换: 国债利差_月度.csv
2026-01-20 11:20:02,800 - data_processing - INFO - 国债利差_月度.csv → 国债利差_标准日期.dta (289行 × 4列)
2026-01-20 11:20:02,800 - data_processing - INFO - 成功: 6/6 个文件
2026-01-20 11:20:02,800 - data_processing - INFO - 步骤 4 完成
2026-01-20 11:20:02,800 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 11:20:02,800 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:20:02,800 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:20:02,800 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:20:18,417 - data_processing - INFO - 生成了 18 个输出文件
2026-01-20 11:20:18,417 - data_processing - INFO - Stata分析完成
2026-01-20 11:20:18,417 - data_processing - INFO - 步骤 5 完成
2026-01-20 11:20:18,417 - data_processing - ERROR - 步骤 6 失败: 'bool' object is not callable
2026-01-20 11:20:18,417 - data_processing - ERROR - 执行步骤6时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 89, in run_all
    success = step_func()
              ^^^^^^^^^^^
TypeError: 'bool' object is not callable
2026-01-20 11:21:15,851 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:21:15,852 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 11:21:16,245 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 11:21:16,246 - data_processing - INFO - PPI: 240行数据
2026-01-20 11:21:17,246 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 11:21:17,520 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 11:21:17,520 - data_processing - INFO - CPI: 216行数据
2026-01-20 11:21:18,521 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 11:21:18,854 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 11:21:18,855 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 11:21:19,856 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 11:21:20,264 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 11:21:20,264 - data_processing - INFO - GDP: 80行数据
2026-01-20 11:21:21,265 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 11:21:21,525 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 11:21:21,525 - data_processing - INFO - PMI: 216行数据
2026-01-20 11:21:22,526 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 11:21:27,417 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 11:21:27,417 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 11:21:27,417 - data_processing - INFO - 识别列: 日期=日期, 2年期=中国国债收益率2年, 10年期=中国国债收益率10年
2026-01-20 11:21:27,419 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 11:21:27,432 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 11:21:27,432 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 11:21:27,433 - data_processing - INFO - 步骤 1 完成
2026-01-20 11:21:27,442 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 11:21:27,445 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 11:21:27,446 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:21:27,466 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 11:21:27,469 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 11:21:27,470 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 11:21:27,491 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 11:21:27,497 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 11:21:27,499 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:21:27,503 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 11:21:27,507 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 11:21:27,508 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 11:21:27,539 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 11:21:27,545 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 11:21:27,546 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:21:27,594 - data_processing - INFO - 成功读取: 国债利差_原始数据.csv (6008行)
2026-01-20 11:21:27,608 - data_processing - INFO - 已保存: 国债利差_标准日期.csv (6008行 × 5列)
2026-01-20 11:21:27,609 - data_processing - INFO - 国债利差_原始数据.csv → 国债利差_标准日期.csv (6008行, 2002-01-04 ~ 2026-01-19)
2026-01-20 11:21:27,609 - data_processing - INFO - 成功: 6个文件
2026-01-20 11:21:27,609 - data_processing - INFO - 步骤 2 完成
2026-01-20 11:21:27,637 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 11:21:27,638 - data_processing - INFO - 原始数据: 80行
2026-01-20 11:21:27,639 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 11:21:27,645 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 11:21:27,645 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 11:21:27,677 - data_processing - INFO - 成功读取: 国债利差_标准日期.csv (6008行)
2026-01-20 11:21:27,677 - data_processing - INFO - 原始数据: 6008行
2026-01-20 11:21:27,679 - data_processing - INFO - 检测到日度数据（平均间隔1天）
2026-01-20 11:21:27,685 - data_processing - INFO - 已保存: 国债利差_月度.csv (289行 × 4列)
2026-01-20 11:21:27,685 - data_processing - INFO - 转换完成: 6008行 → 289行 (2002-01-01 ~ 2026-01-01) 方法: 日度平均
2026-01-20 11:21:27,685 - data_processing - INFO - 成功转换: 2/2 个文件
2026-01-20 11:21:27,722 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 11:21:27,724 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 11:21:27,759 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 11:21:27,763 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 11:21:27,788 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 11:21:27,794 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 11:21:27,813 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 11:21:27,819 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 11:21:27,838 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 11:21:27,842 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 11:21:27,864 - data_processing - INFO - 成功读取: 国债利差_月度.csv (289行)
2026-01-20 11:21:27,867 - data_processing - INFO - 已合并: 国债利差_月度.csv (1列)
2026-01-20 11:21:27,870 - data_processing - INFO - 已保存: 统一月度数据集.csv (289行 × 11列)
2026-01-20 11:21:27,870 - data_processing - INFO - 统一数据集: 289行 × 11列 (2002-01-01 ~ 2026-01-01)
2026-01-20 11:21:27,871 - data_processing - INFO - 步骤 3 完成
2026-01-20 11:21:27,872 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 11:21:27,875 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:21:27,880 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 11:21:27,881 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 11:21:27,881 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:21:27,884 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (240行 × 4列)
2026-01-20 11:21:27,885 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 11:21:27,885 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:21:27,888 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 11:21:27,889 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 11:21:27,892 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (238行 × 9列)
2026-01-20 11:21:27,894 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 11:21:27,894 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:21:27,897 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 11:21:27,898 - data_processing - INFO - 正在转换: 国债利差_月度.csv
2026-01-20 11:21:27,901 - data_processing - INFO - 国债利差_月度.csv → 国债利差_标准日期.dta (289行 × 4列)
2026-01-20 11:21:27,901 - data_processing - INFO - 成功: 6/6 个文件
2026-01-20 11:21:27,901 - data_processing - INFO - 步骤 4 完成
2026-01-20 11:21:27,901 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 11:21:27,902 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:21:27,902 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:21:28,323 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:21:39,448 - data_processing - INFO - 生成了 18 个输出文件
2026-01-20 11:21:39,448 - data_processing - INFO - Stata分析完成
2026-01-20 11:21:39,448 - data_processing - INFO - 步骤 5 完成
2026-01-20 11:21:39,448 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:21:39,448 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:21:39,448 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:21:39,448 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:21:40,211 - data_processing - ERROR - 运行Stata时出错: pmi ambiguous abbreviation
r(111);

end of do-file

r(111);

2026-01-20 11:21:40,211 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: pmi ambiguous abbreviation
r(111);

end of do-file

r(111);

2026-01-20 11:21:40,212 - data_processing - WARNING - 步骤 6 部分完成或跳过
2026-01-20 11:25:13,462 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:25:13,462 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 11:25:13,717 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 11:25:13,718 - data_processing - INFO - PPI: 240行数据
2026-01-20 11:25:14,718 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 11:25:15,015 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 11:25:15,015 - data_processing - INFO - CPI: 216行数据
2026-01-20 11:25:16,017 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 11:25:16,536 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 11:25:16,537 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 11:25:17,538 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 11:25:17,797 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 11:25:17,798 - data_processing - INFO - GDP: 80行数据
2026-01-20 11:25:18,799 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 11:25:19,027 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 11:25:19,027 - data_processing - INFO - PMI: 216行数据
2026-01-20 11:25:20,028 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 11:25:24,875 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 11:25:24,875 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 11:25:24,875 - data_processing - INFO - 识别列: 日期=日期, 2年期=中国国债收益率2年, 10年期=中国国债收益率10年
2026-01-20 11:25:24,878 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 11:25:24,889 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 11:25:24,889 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 11:25:24,890 - data_processing - INFO - 步骤 1 完成
2026-01-20 11:25:24,908 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 11:25:24,912 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 11:25:24,912 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:25:24,926 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 11:25:24,929 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 11:25:24,929 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 11:25:24,943 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 11:25:24,945 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 11:25:24,947 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:25:24,949 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 11:25:24,951 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 11:25:24,952 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 11:25:24,966 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 11:25:24,969 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 11:25:24,970 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 11:25:25,005 - data_processing - INFO - 成功读取: 国债利差_原始数据.csv (6008行)
2026-01-20 11:25:25,019 - data_processing - INFO - 已保存: 国债利差_标准日期.csv (6008行 × 5列)
2026-01-20 11:25:25,020 - data_processing - INFO - 国债利差_原始数据.csv → 国债利差_标准日期.csv (6008行, 2002-01-04 ~ 2026-01-19)
2026-01-20 11:25:25,020 - data_processing - INFO - 成功: 6个文件
2026-01-20 11:25:25,021 - data_processing - INFO - 步骤 2 完成
2026-01-20 11:25:25,041 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 11:25:25,041 - data_processing - INFO - 原始数据: 80行
2026-01-20 11:25:25,043 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 11:25:25,048 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 11:25:25,049 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 11:25:25,099 - data_processing - INFO - 成功读取: 国债利差_标准日期.csv (6008行)
2026-01-20 11:25:25,099 - data_processing - INFO - 原始数据: 6008行
2026-01-20 11:25:25,102 - data_processing - INFO - 检测到日度数据（平均间隔1天）
2026-01-20 11:25:25,108 - data_processing - INFO - 已保存: 国债利差_月度.csv (289行 × 4列)
2026-01-20 11:25:25,108 - data_processing - INFO - 转换完成: 6008行 → 289行 (2002-01-01 ~ 2026-01-01) 方法: 日度平均
2026-01-20 11:25:25,108 - data_processing - INFO - 成功转换: 2/2 个文件
2026-01-20 11:25:25,165 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 11:25:25,168 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 11:25:25,191 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 11:25:25,194 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 11:25:25,221 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 11:25:25,225 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 11:25:25,275 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 11:25:25,282 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 11:25:25,348 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 11:25:25,351 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 11:25:25,400 - data_processing - INFO - 成功读取: 国债利差_月度.csv (289行)
2026-01-20 11:25:25,403 - data_processing - INFO - 已合并: 国债利差_月度.csv (1列)
2026-01-20 11:25:25,405 - data_processing - INFO - 已保存: 统一月度数据集.csv (289行 × 11列)
2026-01-20 11:25:25,406 - data_processing - INFO - 统一数据集: 289行 × 11列 (2002-01-01 ~ 2026-01-01)
2026-01-20 11:25:25,406 - data_processing - INFO - 步骤 3 完成
2026-01-20 11:25:25,407 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 11:25:25,411 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:25:25,416 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 11:25:25,417 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 11:25:25,417 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:25:25,419 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (240行 × 4列)
2026-01-20 11:25:25,420 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 11:25:25,421 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:25:25,423 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 11:25:25,424 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 11:25:25,429 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (238行 × 9列)
2026-01-20 11:25:25,430 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 11:25:25,430 - data_processing - INFO - 删除中文列: month, var
2026-01-20 11:25:25,432 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 11:25:25,433 - data_processing - INFO - 正在转换: 国债利差_月度.csv
2026-01-20 11:25:25,435 - data_processing - INFO - 国债利差_月度.csv → 国债利差_标准日期.dta (289行 × 4列)
2026-01-20 11:25:25,435 - data_processing - INFO - 成功: 6/6 个文件
2026-01-20 11:25:25,435 - data_processing - INFO - 步骤 4 完成
2026-01-20 11:25:25,435 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 11:25:25,437 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:25:25,438 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:25:25,869 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:25:36,831 - data_processing - INFO - 生成了 18 个输出文件
2026-01-20 11:25:36,831 - data_processing - INFO - Stata分析完成
2026-01-20 11:25:36,831 - data_processing - INFO - 步骤 5 完成
2026-01-20 11:25:36,831 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:25:36,831 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:25:36,831 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:25:36,831 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:25:37,622 - data_processing - ERROR - 运行Stata时出错: r(111);

end of do-file

r(111);

2026-01-20 11:25:37,622 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: r(111);

end of do-file

r(111);

2026-01-20 11:25:37,623 - data_processing - WARNING - 步骤 6 部分完成或跳过
2026-01-20 11:27:09,527 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:27:09,528 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:27:09,528 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:27:09,529 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:27:09,997 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:27:11,308 - data_processing - ERROR - 运行Stata时出错: file ../output/扩展SVAR_传导渠道时间序列图.png written in PNG format

. 
. * 相关性分析
. display _newline "变量相关性矩阵："

变量相关性矩阵：

. correlate ppi_yoy inf_exp pmi_mfg_yoy credit cpi_national_yoy
variable credit not found
r(111);

end of do-file

r(111);

2026-01-20 11:27:11,308 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: file ../output/扩展SVAR_传导渠道时间序列图.png written in PNG format

. 
. * 相关性分析
. display _newline "变量相关性矩阵："

变量相关性矩阵：

. correlate ppi_yoy inf_exp pmi_mfg_yoy credit cpi_national_yoy
variable credit not found
r(111);

end of do-file

r(111);

2026-01-20 11:29:45,452 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:29:45,452 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:29:45,453 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:29:45,453 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:29:45,888 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:29:47,731 - data_processing - ERROR - 运行Stata时出错: ------------------------------------------------------------------------------
D.           |
 pmi_mfg_yoy | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
 pmi_mfg_yoy |
         L1. |  -.3010114   .0679493    -4.43   0.000    -.4349844   -.1670383
         LD. |  -.1042325   .0817138    -1.28   0.204    -.2653443    .0568793
        L2D. |  -.0360679   .0788913    -0.46   0.648    -.1916147    .1194789
        L3D. |   -.016399   .0752142    -0.22   0.828    -.1646959    .1318979
        L4D. |   .0431986   .0696651     0.62   0.536    -.0941573    .1805545
             |
      _trend |   .0015098   .0062491     0.24   0.809    -.0108112    .0138309
       _cons |   -.254353    .786981    -0.32   0.747    -1.806013    1.297307
------------------------------------------------------------------------------

. 
. * 对新增贷款进行ADF检验
. display _newline "4. 新增贷款 - ADF检验"

4. 新增贷款 - ADF检验

. dfuller credit, lags(4) regress
variable credit not found
r(111);

end of do-file

r(111);

2026-01-20 11:29:47,731 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: ------------------------------------------------------------------------------
D.           |
 pmi_mfg_yoy | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
 pmi_mfg_yoy |
         L1. |  -.3010114   .0679493    -4.43   0.000    -.4349844   -.1670383
         LD. |  -.1042325   .0817138    -1.28   0.204    -.2653443    .0568793
        L2D. |  -.0360679   .0788913    -0.46   0.648    -.1916147    .1194789
        L3D. |   -.016399   .0752142    -0.22   0.828    -.1646959    .1318979
        L4D. |   .0431986   .0696651     0.62   0.536    -.0941573    .1805545
             |
      _trend |   .0015098   .0062491     0.24   0.809    -.0108112    .0138309
       _cons |   -.254353    .786981    -0.32   0.747    -1.806013    1.297307
------------------------------------------------------------------------------

. 
. * 对新增贷款进行ADF检验
. display _newline "4. 新增贷款 - ADF检验"

4. 新增贷款 - ADF检验

. dfuller credit, lags(4) regress
variable credit not found
r(111);

end of do-file

r(111);

2026-01-20 11:30:13,996 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:30:13,996 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:30:13,997 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:30:13,997 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:30:14,422 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:30:16,356 - data_processing - ERROR - 运行Stata时出错: 
Phillips–Perron test for unit root       Number of obs   = 239
Variable: ppi_yoy                        Newey–West lags =   4

H0: Random walk without drift, d = 0

                                       Dickey–Fuller
                   Test      -------- critical value ---------
              statistic           1%           5%          10%
--------------------------------------------------------------
 Z(rho)         -15.882      -20.263      -13.978      -11.185
 Z(t)            -2.811       -3.464       -2.881       -2.571
--------------------------------------------------------------
MacKinnon approximate p-value for Z(t) = 0.0567.

. pperron inf_exp, lags(4)

Phillips–Perron test for unit root       Number of obs   = 288
Variable: inf_exp                        Newey–West lags =   4

H0: Random walk without drift, d = 0

                                       Dickey–Fuller
                   Test      -------- critical value ---------
              statistic           1%           5%          10%
--------------------------------------------------------------
 Z(rho)         -19.683      -20.330      -14.000      -11.200
 Z(t)            -3.170       -3.457       -2.878       -2.570
--------------------------------------------------------------
MacKinnon approximate p-value for Z(t) = 0.0218.

. pperron pmi_mfg_yoy_yoy, lags(4)
variable pmi_mfg_yoy_yoy not found
r(111);

end of do-file

r(111);

2026-01-20 11:30:16,356 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: 
Phillips–Perron test for unit root       Number of obs   = 239
Variable: ppi_yoy                        Newey–West lags =   4

H0: Random walk without drift, d = 0

                                       Dickey–Fuller
                   Test      -------- critical value ---------
              statistic           1%           5%          10%
--------------------------------------------------------------
 Z(rho)         -15.882      -20.263      -13.978      -11.185
 Z(t)            -2.811       -3.464       -2.881       -2.571
--------------------------------------------------------------
MacKinnon approximate p-value for Z(t) = 0.0567.

. pperron inf_exp, lags(4)

Phillips–Perron test for unit root       Number of obs   = 288
Variable: inf_exp                        Newey–West lags =   4

H0: Random walk without drift, d = 0

                                       Dickey–Fuller
                   Test      -------- critical value ---------
              statistic           1%           5%          10%
--------------------------------------------------------------
 Z(rho)         -19.683      -20.330      -14.000      -11.200
 Z(t)            -3.170       -3.457       -2.878       -2.570
--------------------------------------------------------------
MacKinnon approximate p-value for Z(t) = 0.0218.

. pperron pmi_mfg_yoy_yoy, lags(4)
variable pmi_mfg_yoy_yoy not found
r(111);

end of do-file

r(111);

2026-01-20 11:30:36,899 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:30:36,899 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:30:36,899 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:30:36,900 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:30:37,339 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:30:41,559 - data_processing - ERROR - 运行Stata时出错: aeq() matrix does not have the correct row dimension
r(198);

end of do-file

r(198);

2026-01-20 11:30:41,559 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: aeq() matrix does not have the correct row dimension
r(198);

end of do-file

r(198);

2026-01-20 11:31:54,749 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:31:54,749 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:31:54,750 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:31:54,750 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:31:55,188 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:32:00,684 - data_processing - ERROR - 运行Stata时出错:   |   .366685   |
  |   .3644886 - .04007607i  |   .366685   |
  +----------------------------------------+
   All the eigenvalues lie inside the unit circle.
   VAR satisfies stability condition.

. 
. /*==============================================================================
>   第九部分：SVAR模型设置与估计
> ==============================================================================*/
. 
. display _newline(2)




. display "================================================================================"
================================================================================

. display "第九部分：SVAR模型估计"
第九部分：SVAR模型估计

. display "================================================================================"
================================================================================

. display _newline



. 
. display "识别策略：Cholesky分解（递归同期因果关系）"
识别策略：Cholesky分解（递归同期因果关系）

. display _newline



. display "变量排序及其经济学含义："
变量排序及其经济学含义：

. display "  1. PPI：可同期响应供给冲击（最接近外生的变量）"
  1. PPI：可同期响应供给冲击（最接近外生的变量）

. display "  2. inf_exp：观察到价格变化后更新预期"
  2. inf_exp：观察到价格变化后更新预期

. display "  3. PMI(Wage)：根据通胀预期重新谈判"
  3. PMI(Wage)：根据通胀预期重新谈判

. display "  4. Credit：银行系统根据经济热度调整信贷标准"
  4. Credit：银行系统根据经济热度调整信贷标准

. display "  5. CPI：作为整体指标，最后综合反映所有冲击"
  5. CPI：作为整体指标，最后综合反映所有冲击

. display _newline



. 
. * 定义SVAR的短期约束矩阵（Cholesky分解）
. * 6变量系统的下三角矩阵
. * A矩阵：同期系数矩阵（下三角，对角线为1）
. matrix A = (1, 0, 0, 0, 0 \ ///
>             ., 1, 0, 0, 0 \ ///
>             ., ., 1, 0, 0 \ ///
>             ., ., ., 1, 0 \ ///
>             ., ., ., ., 1)

. 
. * B矩阵：结构冲击的方差矩阵（对角矩阵）
. matrix B = (., 0, 0, 0, 0 \ ///
>             0, ., 0, 0, 0 \ ///
>             0, 0, ., 0, 0 \ ///
>             0, 0, 0, ., 0 \ ///
>             0, 0, 0, 0, .) \ ///
> 
unknown function ()
r(133);

end of do-file

r(133);

2026-01-20 11:32:00,688 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError:   |   .366685   |
  |   .3644886 - .04007607i  |   .366685   |
  +----------------------------------------+
   All the eigenvalues lie inside the unit circle.
   VAR satisfies stability condition.

. 
. /*==============================================================================
>   第九部分：SVAR模型设置与估计
> ==============================================================================*/
. 
. display _newline(2)




. display "================================================================================"
================================================================================

. display "第九部分：SVAR模型估计"
第九部分：SVAR模型估计

. display "================================================================================"
================================================================================

. display _newline



. 
. display "识别策略：Cholesky分解（递归同期因果关系）"
识别策略：Cholesky分解（递归同期因果关系）

. display _newline



. display "变量排序及其经济学含义："
变量排序及其经济学含义：

. display "  1. PPI：可同期响应供给冲击（最接近外生的变量）"
  1. PPI：可同期响应供给冲击（最接近外生的变量）

. display "  2. inf_exp：观察到价格变化后更新预期"
  2. inf_exp：观察到价格变化后更新预期

. display "  3. PMI(Wage)：根据通胀预期重新谈判"
  3. PMI(Wage)：根据通胀预期重新谈判

. display "  4. Credit：银行系统根据经济热度调整信贷标准"
  4. Credit：银行系统根据经济热度调整信贷标准

. display "  5. CPI：作为整体指标，最后综合反映所有冲击"
  5. CPI：作为整体指标，最后综合反映所有冲击

. display _newline



. 
. * 定义SVAR的短期约束矩阵（Cholesky分解）
. * 6变量系统的下三角矩阵
. * A矩阵：同期系数矩阵（下三角，对角线为1）
. matrix A = (1, 0, 0, 0, 0 \ ///
>             ., 1, 0, 0, 0 \ ///
>             ., ., 1, 0, 0 \ ///
>             ., ., ., 1, 0 \ ///
>             ., ., ., ., 1)

. 
. * B矩阵：结构冲击的方差矩阵（对角矩阵）
. matrix B = (., 0, 0, 0, 0 \ ///
>             0, ., 0, 0, 0 \ ///
>             0, 0, ., 0, 0 \ ///
>             0, 0, 0, ., 0 \ ///
>             0, 0, 0, 0, .) \ ///
> 
unknown function ()
r(133);

end of do-file

r(133);

2026-01-20 11:32:10,858 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:32:10,858 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:32:10,858 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:32:10,858 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:32:11,304 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:32:52,602 - data_processing - ERROR - 运行Stata时出错: file ../output/扩展SVAR_IRF_预期传染效应.png written in PNG format

. 
. /*--------------------------------------------------------------------------
>   检验2：债务-通缩螺旋
>   冲击：PPI负向冲击
>   观察：信贷增速是否持续下降（6-12个月）
> --------------------------------------------------------------------------*/
. 
. display _newline "检验2：债务-通缩螺旋（PPI冲击→信贷）"

检验2：债务-通缩螺旋（PPI冲击→信贷）

. 
. * PPI冲击对信贷的响应
. irf graph oirf, impulse(ppi_yoy) response(credit) ///
>     title("检验2：债务-通缩螺旋") ///
>     subtitle("PPI冲击对信贷的脉冲响应") ///
>     note("若信贷收缩，印证'价格下跌→资产负债表恶化→信贷收缩'的螺旋") ///
>     name(irf_debt, replace)
response credit not found in results from svar_extend_irf
r(498);

end of do-file

r(498);

2026-01-20 11:32:52,602 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: file ../output/扩展SVAR_IRF_预期传染效应.png written in PNG format

. 
. /*--------------------------------------------------------------------------
>   检验2：债务-通缩螺旋
>   冲击：PPI负向冲击
>   观察：信贷增速是否持续下降（6-12个月）
> --------------------------------------------------------------------------*/
. 
. display _newline "检验2：债务-通缩螺旋（PPI冲击→信贷）"

检验2：债务-通缩螺旋（PPI冲击→信贷）

. 
. * PPI冲击对信贷的响应
. irf graph oirf, impulse(ppi_yoy) response(credit) ///
>     title("检验2：债务-通缩螺旋") ///
>     subtitle("PPI冲击对信贷的脉冲响应") ///
>     note("若信贷收缩，印证'价格下跌→资产负债表恶化→信贷收缩'的螺旋") ///
>     name(irf_debt, replace)
response credit not found in results from svar_extend_irf
r(498);

end of do-file

r(498);

2026-01-20 11:33:24,758 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:33:24,758 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:33:24,759 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:33:24,759 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:33:25,204 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:34:11,600 - data_processing - ERROR - 运行Stata时出错: file ../output/扩展SVAR_FEVD_通胀预期.png written in PNG format

. 
. /*==============================================================================
>   第十二部分：拟合与预测结果
> ==============================================================================*/
. 
. display _newline(2)




. display "================================================================================"
================================================================================

. display "第十二部分：拟合与预测分析"
第十二部分：拟合与预测分析

. display "================================================================================"
================================================================================

. display _newline



. 
. * 保存当前VAR模型估计结果
. estimates restore var_extend_model
(results var_extend_model are active now)

. 
. * 1. 样本内拟合优度评估
. display _newline "1. 样本内拟合优度："

1. 样本内拟合优度：

. display _newline



. 
. * 获取拟合值和残差
. predict ppi_fitted if e(sample), equation(ppi_yoy) xb
(77 missing values generated)

. predict exp_fitted if e(sample), equation(inf_exp) xb
(77 missing values generated)

. predict pmi_fitted if e(sample), equation(pmi) xb
equation pmi not found
r(303);

end of do-file

r(303);

2026-01-20 11:34:11,600 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: file ../output/扩展SVAR_FEVD_通胀预期.png written in PNG format

. 
. /*==============================================================================
>   第十二部分：拟合与预测结果
> ==============================================================================*/
. 
. display _newline(2)




. display "================================================================================"
================================================================================

. display "第十二部分：拟合与预测分析"
第十二部分：拟合与预测分析

. display "================================================================================"
================================================================================

. display _newline



. 
. * 保存当前VAR模型估计结果
. estimates restore var_extend_model
(results var_extend_model are active now)

. 
. * 1. 样本内拟合优度评估
. display _newline "1. 样本内拟合优度："

1. 样本内拟合优度：

. display _newline



. 
. * 获取拟合值和残差
. predict ppi_fitted if e(sample), equation(ppi_yoy) xb
(77 missing values generated)

. predict exp_fitted if e(sample), equation(inf_exp) xb
(77 missing values generated)

. predict pmi_fitted if e(sample), equation(pmi) xb
equation pmi not found
r(303);

end of do-file

r(303);

2026-01-20 11:34:55,119 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:34:55,119 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:34:55,120 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:34:55,120 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:34:55,564 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:35:44,168 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 11:35:44,168 - data_processing - INFO - Stata分析完成
2026-01-20 11:50:26,865 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:50:26,865 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:50:26,865 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:50:26,865 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:50:27,320 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:50:29,335 - data_processing - ERROR - 运行Stata时出错: the sample has gaps
r(498);

end of do-file

r(498);

2026-01-20 11:50:29,335 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: the sample has gaps
r(498);

end of do-file

r(498);

2026-01-20 11:52:57,664 - data_processing - INFO - AKShare 库加载成功
2026-01-20 11:52:57,666 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 11:52:57,666 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 11:52:57,666 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 11:52:58,115 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 11:53:46,642 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 11:53:46,642 - data_processing - INFO - Stata分析完成
2026-01-20 12:01:39,200 - data_processing - INFO - AKShare 库加载成功
2026-01-20 12:01:39,200 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 12:01:39,478 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 12:01:39,478 - data_processing - INFO - PPI: 240行数据
2026-01-20 12:01:40,478 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 12:01:40,734 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 12:01:40,736 - data_processing - INFO - CPI: 216行数据
2026-01-20 12:01:41,736 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 12:01:42,087 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 12:01:42,087 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 12:01:43,089 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 12:01:43,332 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 12:01:43,332 - data_processing - INFO - GDP: 80行数据
2026-01-20 12:01:44,334 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 12:01:44,557 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 12:01:44,557 - data_processing - INFO - PMI: 216行数据
2026-01-20 12:01:45,558 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 12:01:50,059 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 12:01:50,060 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 12:01:50,060 - data_processing - INFO - 识别列: 日期=日期, 2年期=中国国债收益率2年, 10年期=中国国债收益率10年
2026-01-20 12:01:50,061 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 12:01:50,073 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 12:01:50,073 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 12:01:50,074 - data_processing - INFO - 步骤 1 完成
2026-01-20 12:01:50,112 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 12:01:50,116 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 12:01:50,116 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 12:01:50,148 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 12:01:50,151 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 12:01:50,152 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 12:01:50,177 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 12:01:50,183 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 12:01:50,184 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 12:01:50,186 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 12:01:50,188 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 12:01:50,189 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 12:01:50,211 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 12:01:50,214 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 12:01:50,214 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 12:01:50,258 - data_processing - INFO - 成功读取: 国债利差_原始数据.csv (6008行)
2026-01-20 12:01:50,269 - data_processing - INFO - 已保存: 国债利差_标准日期.csv (6008行 × 5列)
2026-01-20 12:01:50,271 - data_processing - INFO - 国债利差_原始数据.csv → 国债利差_标准日期.csv (6008行, 2002-01-04 ~ 2026-01-19)
2026-01-20 12:01:50,271 - data_processing - INFO - 成功: 6个文件
2026-01-20 12:01:50,271 - data_processing - INFO - 步骤 2 完成
2026-01-20 12:01:50,284 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 12:01:50,284 - data_processing - INFO - 原始数据: 80行
2026-01-20 12:01:50,284 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 12:01:50,290 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 12:01:50,290 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 12:01:50,321 - data_processing - INFO - 成功读取: 国债利差_标准日期.csv (6008行)
2026-01-20 12:01:50,321 - data_processing - INFO - 原始数据: 6008行
2026-01-20 12:01:50,323 - data_processing - INFO - 检测到日度数据（平均间隔1天）
2026-01-20 12:01:50,329 - data_processing - INFO - 已保存: 国债利差_月度.csv (289行 × 4列)
2026-01-20 12:01:50,329 - data_processing - INFO - 转换完成: 6008行 → 289行 (2002-01-01 ~ 2026-01-01) 方法: 日度平均
2026-01-20 12:01:50,329 - data_processing - INFO - 成功转换: 2/2 个文件
2026-01-20 12:01:50,356 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 12:01:50,357 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 12:01:50,388 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 12:01:50,392 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 12:01:50,443 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 12:01:50,452 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 12:01:50,484 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 12:01:50,486 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 12:01:50,506 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 12:01:50,508 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 12:01:50,534 - data_processing - INFO - 成功读取: 国债利差_月度.csv (289行)
2026-01-20 12:01:50,539 - data_processing - INFO - 已合并: 国债利差_月度.csv (1列)
2026-01-20 12:01:50,543 - data_processing - INFO - 已保存: 统一月度数据集.csv (289行 × 11列)
2026-01-20 12:01:50,544 - data_processing - INFO - 统一数据集: 289行 × 11列 (2002-01-01 ~ 2026-01-01)
2026-01-20 12:01:50,544 - data_processing - INFO - 步骤 3 完成
2026-01-20 12:01:50,547 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 12:01:50,551 - data_processing - INFO - 删除中文列: month, var
2026-01-20 12:01:50,552 - data_processing - ERROR - 转换失败 CPI_标准日期.csv: name 'datetime' is not defined
2026-01-20 12:01:50,552 - data_processing - ERROR - 转换CPI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 177, in convert_single_file
    df = df[df['date'] >= datetime.strptime(config.RECOMMENDED_START, "%Y-%m-%d")]
                          ^^^^^^^^
NameError: name 'datetime' is not defined
2026-01-20 12:01:50,553 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 12:01:50,553 - data_processing - INFO - 删除中文列: month, var
2026-01-20 12:01:50,554 - data_processing - ERROR - 转换失败 PPI_标准日期.csv: name 'datetime' is not defined
2026-01-20 12:01:50,554 - data_processing - ERROR - 转换PPI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 177, in convert_single_file
    df = df[df['date'] >= datetime.strptime(config.RECOMMENDED_START, "%Y-%m-%d")]
                          ^^^^^^^^
NameError: name 'datetime' is not defined
2026-01-20 12:01:50,555 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 12:01:50,555 - data_processing - INFO - 删除中文列: month, var
2026-01-20 12:01:50,556 - data_processing - ERROR - 转换失败 PMI_标准日期.csv: name 'datetime' is not defined
2026-01-20 12:01:50,556 - data_processing - ERROR - 转换PMI_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 177, in convert_single_file
    df = df[df['date'] >= datetime.strptime(config.RECOMMENDED_START, "%Y-%m-%d")]
                          ^^^^^^^^
NameError: name 'datetime' is not defined
2026-01-20 12:01:50,557 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 12:01:50,558 - data_processing - ERROR - 转换失败 GDP_月度.csv: name 'datetime' is not defined
2026-01-20 12:01:50,558 - data_processing - ERROR - 转换GDP_月度.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 177, in convert_single_file
    df = df[df['date'] >= datetime.strptime(config.RECOMMENDED_START, "%Y-%m-%d")]
                          ^^^^^^^^
NameError: name 'datetime' is not defined
2026-01-20 12:01:50,559 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 12:01:50,559 - data_processing - INFO - 删除中文列: month, var
2026-01-20 12:01:50,560 - data_processing - ERROR - 转换失败 新增贷款_标准日期.csv: name 'datetime' is not defined
2026-01-20 12:01:50,560 - data_processing - ERROR - 转换新增贷款_标准日期.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 177, in convert_single_file
    df = df[df['date'] >= datetime.strptime(config.RECOMMENDED_START, "%Y-%m-%d")]
                          ^^^^^^^^
NameError: name 'datetime' is not defined
2026-01-20 12:01:50,561 - data_processing - INFO - 正在转换: 国债利差_月度.csv
2026-01-20 12:01:50,561 - data_processing - ERROR - 转换失败 国债利差_月度.csv: name 'datetime' is not defined
2026-01-20 12:01:50,561 - data_processing - ERROR - 转换国债利差_月度.csv时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\modules\format_converter.py", line 177, in convert_single_file
    df = df[df['date'] >= datetime.strptime(config.RECOMMENDED_START, "%Y-%m-%d")]
                          ^^^^^^^^
NameError: name 'datetime' is not defined
2026-01-20 12:01:50,562 - data_processing - INFO - 成功: 0/6 个文件
2026-01-20 12:01:50,562 - data_processing - WARNING - 步骤 4 部分完成或跳过
2026-01-20 12:01:50,562 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 12:01:50,562 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 12:01:50,563 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 12:01:50,997 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 12:02:01,603 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 12:02:01,603 - data_processing - INFO - Stata分析完成
2026-01-20 12:02:01,603 - data_processing - INFO - 步骤 5 完成
2026-01-20 12:02:01,604 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 12:02:01,604 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 12:02:01,604 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 12:02:01,605 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 12:02:20,712 - data_processing - INFO - AKShare 库加载成功
2026-01-20 12:02:20,712 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 12:02:20,945 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 12:02:20,945 - data_processing - INFO - PPI: 240行数据
2026-01-20 12:02:21,946 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 12:02:22,193 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 12:02:22,193 - data_processing - INFO - CPI: 216行数据
2026-01-20 12:02:23,194 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 12:02:23,470 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 12:02:23,470 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 12:02:24,471 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 12:02:24,709 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 12:02:24,709 - data_processing - INFO - GDP: 80行数据
2026-01-20 12:02:25,710 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 12:02:25,949 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 12:02:25,949 - data_processing - INFO - PMI: 216行数据
2026-01-20 12:02:26,950 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 12:02:31,872 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 12:02:31,872 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 12:02:31,872 - data_processing - INFO - 识别列: 日期=日期, 2年期=中国国债收益率2年, 10年期=中国国债收益率10年
2026-01-20 12:02:31,874 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 12:02:31,884 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 12:02:31,884 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 12:02:31,886 - data_processing - INFO - 步骤 1 完成
2026-01-20 12:02:31,916 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 12:02:31,922 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 12:02:31,923 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 12:02:31,960 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 12:02:31,969 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 12:02:31,970 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 12:02:32,004 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 12:02:32,011 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 12:02:32,014 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 12:02:32,019 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 12:02:32,029 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 12:02:32,031 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 12:02:32,068 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 12:02:32,070 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 12:02:32,071 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 12:02:32,115 - data_processing - INFO - 成功读取: 国债利差_原始数据.csv (6008行)
2026-01-20 12:02:32,126 - data_processing - INFO - 已保存: 国债利差_标准日期.csv (6008行 × 5列)
2026-01-20 12:02:32,128 - data_processing - INFO - 国债利差_原始数据.csv → 国债利差_标准日期.csv (6008行, 2002-01-04 ~ 2026-01-19)
2026-01-20 12:02:32,128 - data_processing - INFO - 成功: 6个文件
2026-01-20 12:02:32,128 - data_processing - INFO - 步骤 2 完成
2026-01-20 12:02:32,141 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 12:02:32,141 - data_processing - INFO - 原始数据: 80行
2026-01-20 12:02:32,142 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 12:02:32,146 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 12:02:32,147 - data_processing - INFO - 转换完成: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 12:02:32,165 - data_processing - INFO - 成功读取: 国债利差_标准日期.csv (6008行)
2026-01-20 12:02:32,165 - data_processing - INFO - 原始数据: 6008行
2026-01-20 12:02:32,167 - data_processing - INFO - 检测到日度数据（平均间隔1天）
2026-01-20 12:02:32,173 - data_processing - INFO - 已保存: 国债利差_月度.csv (289行 × 4列)
2026-01-20 12:02:32,173 - data_processing - INFO - 转换完成: 6008行 → 289行 (2002-01-01 ~ 2026-01-01) 方法: 日度平均
2026-01-20 12:02:32,174 - data_processing - INFO - 成功转换: 2/2 个文件
2026-01-20 12:02:32,185 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 12:02:32,186 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 12:02:32,199 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 12:02:32,202 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 12:02:32,226 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 12:02:32,229 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 12:02:32,275 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 12:02:32,283 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 12:02:32,305 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 12:02:32,308 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 12:02:32,364 - data_processing - INFO - 成功读取: 国债利差_月度.csv (289行)
2026-01-20 12:02:32,370 - data_processing - INFO - 已合并: 国债利差_月度.csv (1列)
2026-01-20 12:02:32,374 - data_processing - INFO - 已保存: 统一月度数据集.csv (289行 × 11列)
2026-01-20 12:02:32,376 - data_processing - INFO - 统一数据集: 289行 × 11列 (2002-01-01 ~ 2026-01-01)
2026-01-20 12:02:32,377 - data_processing - INFO - 步骤 3 完成
2026-01-20 12:02:32,379 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 12:02:32,383 - data_processing - INFO - 删除中文列: month, var
2026-01-20 12:02:32,387 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 12:02:32,388 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 12:02:32,389 - data_processing - INFO - 删除中文列: month, var
2026-01-20 12:02:32,393 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (216行 × 4列)
2026-01-20 12:02:32,394 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 12:02:32,394 - data_processing - INFO - 删除中文列: month, var
2026-01-20 12:02:32,397 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 12:02:32,398 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 12:02:32,402 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (216行 × 9列)
2026-01-20 12:02:32,402 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 12:02:32,403 - data_processing - INFO - 删除中文列: month, var
2026-01-20 12:02:32,406 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 12:02:32,406 - data_processing - INFO - 正在转换: 国债利差_月度.csv
2026-01-20 12:02:32,410 - data_processing - INFO - 国债利差_月度.csv → 国债利差_标准日期.dta (217行 × 4列)
2026-01-20 12:02:32,410 - data_processing - INFO - 成功: 6/6 个文件
2026-01-20 12:02:32,410 - data_processing - INFO - 步骤 4 完成
2026-01-20 12:02:32,410 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 12:02:32,411 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 12:02:32,411 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 12:02:32,848 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 12:02:44,239 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 12:02:44,239 - data_processing - INFO - Stata分析完成
2026-01-20 12:02:44,239 - data_processing - INFO - 步骤 5 完成
2026-01-20 12:02:44,239 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 12:02:44,239 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 12:02:44,239 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 12:02:44,239 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 12:03:33,714 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 12:03:33,714 - data_processing - INFO - Stata分析完成
2026-01-20 12:03:33,714 - data_processing - INFO - 步骤 6 完成
2026-01-20 12:10:09,983 - data_processing - INFO - AKShare 库加载成功
2026-01-20 12:10:09,983 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 12:10:09,984 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 12:10:09,984 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 12:10:10,423 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 12:10:47,263 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 12:10:47,263 - data_processing - INFO - Stata分析完成
2026-01-20 12:13:03,443 - data_processing - INFO - AKShare 库加载成功
2026-01-20 12:13:03,444 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 12:13:03,444 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 12:13:03,444 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 12:13:03,901 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 12:13:15,110 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 12:13:15,110 - data_processing - INFO - Stata分析完成
2026-01-20 12:13:55,702 - data_processing - INFO - AKShare 库加载成功
2026-01-20 12:13:55,703 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 12:13:55,703 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 12:13:55,703 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 12:13:56,137 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 12:14:06,856 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 12:14:06,857 - data_processing - INFO - Stata分析完成
2026-01-20 12:21:09,516 - data_processing - INFO - AKShare 库加载成功
2026-01-20 12:21:09,516 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 12:21:09,517 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 12:21:09,517 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 12:21:09,949 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 12:21:46,515 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 12:21:46,515 - data_processing - INFO - Stata分析完成
2026-01-20 12:33:58,333 - data_processing - INFO - AKShare 库加载成功
2026-01-20 12:33:58,333 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 12:33:58,333 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 12:33:58,335 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 12:33:58,777 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 12:34:09,598 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 12:34:09,598 - data_processing - INFO - Stata分析完成
2026-01-20 12:51:46,836 - data_processing - INFO - AKShare 库加载成功
2026-01-20 12:51:46,836 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 12:51:46,837 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 12:51:46,837 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 12:51:47,289 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 12:51:58,095 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 12:51:58,095 - data_processing - INFO - Stata分析完成
2026-01-20 12:58:44,687 - data_processing - INFO - AKShare 库加载成功
2026-01-20 12:58:44,687 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 12:58:44,688 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 12:58:44,688 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 12:58:45,129 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 12:58:55,128 - data_processing - ERROR - 运行Stata时出错:      7      .50832   0.9245   2622.016   0.0000
----------------------------------------------------------------

----------------------------------------------------------------------------------
                 | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-----------------+----------------------------------------------------------------
gdp_yoy          |
         gdp_yoy |
             L1. |   1.569323   .0535454    29.31   0.000     1.464376     1.67427
             L2. |  -.6493205   .0541187   -12.00   0.000    -.7553911   -.5432498
                 |
         ppi_yoy |
             L1. |   .0259312   .0529684     0.49   0.624    -.0778849    .1297474
             L2. |  -.0184185   .0524939    -0.35   0.726    -.1213046    .0844676
                 |
cpi_national_yoy |
             L1. |   .0001957   .0945851     0.00   0.998    -.1851878    .1855791
             L2. |   -.008215   .0928367    -0.09   0.929    -.1901715    .1737415
                 |
           _cons |   .5695336   .1405063     4.05   0.000     .2941464    .8449209
-----------------+----------------------------------------------------------------
ppi_yoy          |
         gdp_yoy |
             L1. |   .1610087   .0491236     3.28   0.001     .0647281    .2572892
             L2. |  -.1343646   .0496495    -2.71   0.007    -.2316758   -.0370533
                 |
         ppi_yoy |
             L1. |   1.672473   .0485942    34.42   0.000      1.57723    1.767716
             L2. |  -.7154606   .0481589   -14.86   0.000    -.8098504   -.6210709
                 |
cpi_national_yoy |
             L1. |  -.0100614   .0867742    -0.12   0.908    -.1801358    .1600129
             L2. |  -.0017916   .0851701    -0.02   0.983     -.168722    .1651388
                 |
           _cons |  -.1405339   .1289032    -1.09   0.276    -.3931794    .1121117
-----------------+----------------------------------------------------------------
cpi_national_yoy |
         gdp_yoy |
             L1. |   .0260842   .0380187     0.69   0.493    -.0484311    .1005996
             L2. |  -.0065806   .0384257    -0.17   0.864    -.0818936    .0687325
                 |
         ppi_yoy |
             L1. |   .1792414    .037609     4.77   0.000     .1055291    .2529537
             L2. |  -.1764947   .0372721    -4.74   0.000    -.2495467   -.1034427
                 |
cpi_national_yoy |
             L1. |   .8336193    .067158    12.41   0.000      .701992    .9652466
             L2. |   .0883171   .0659166     1.34   0.180     -.040877    .2175112
                 |
           _cons |  -.0132193   .0997633    -0.13   0.895    -.2087518    .1823132
----------------------------------------------------------------------------------

. 
. * 保存当前观测数
. quietly count

. local last_obs = r(N)

. 
. * 扩展数据集以容纳预测值
. quietly set obs `=`last_obs' + 4'

. 
. * 为新观测生成时间索引
. quietly replace t = _n if t == .

. 
. * 重新设置时间序列
. tsset t

Time variable: t, 1 to 220
        Delta: 1 unit

. 
. * 使用fcast进行动态预测
. fcast set var_forecast, replace
set unknown subcommand
r(198);

end of do-file

r(198);

2026-01-20 12:58:55,131 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError:      7      .50832   0.9245   2622.016   0.0000
----------------------------------------------------------------

----------------------------------------------------------------------------------
                 | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-----------------+----------------------------------------------------------------
gdp_yoy          |
         gdp_yoy |
             L1. |   1.569323   .0535454    29.31   0.000     1.464376     1.67427
             L2. |  -.6493205   .0541187   -12.00   0.000    -.7553911   -.5432498
                 |
         ppi_yoy |
             L1. |   .0259312   .0529684     0.49   0.624    -.0778849    .1297474
             L2. |  -.0184185   .0524939    -0.35   0.726    -.1213046    .0844676
                 |
cpi_national_yoy |
             L1. |   .0001957   .0945851     0.00   0.998    -.1851878    .1855791
             L2. |   -.008215   .0928367    -0.09   0.929    -.1901715    .1737415
                 |
           _cons |   .5695336   .1405063     4.05   0.000     .2941464    .8449209
-----------------+----------------------------------------------------------------
ppi_yoy          |
         gdp_yoy |
             L1. |   .1610087   .0491236     3.28   0.001     .0647281    .2572892
             L2. |  -.1343646   .0496495    -2.71   0.007    -.2316758   -.0370533
                 |
         ppi_yoy |
             L1. |   1.672473   .0485942    34.42   0.000      1.57723    1.767716
             L2. |  -.7154606   .0481589   -14.86   0.000    -.8098504   -.6210709
                 |
cpi_national_yoy |
             L1. |  -.0100614   .0867742    -0.12   0.908    -.1801358    .1600129
             L2. |  -.0017916   .0851701    -0.02   0.983     -.168722    .1651388
                 |
           _cons |  -.1405339   .1289032    -1.09   0.276    -.3931794    .1121117
-----------------+----------------------------------------------------------------
cpi_national_yoy |
         gdp_yoy |
             L1. |   .0260842   .0380187     0.69   0.493    -.0484311    .1005996
             L2. |  -.0065806   .0384257    -0.17   0.864    -.0818936    .0687325
                 |
         ppi_yoy |
             L1. |   .1792414    .037609     4.77   0.000     .1055291    .2529537
             L2. |  -.1764947   .0372721    -4.74   0.000    -.2495467   -.1034427
                 |
cpi_national_yoy |
             L1. |   .8336193    .067158    12.41   0.000      .701992    .9652466
             L2. |   .0883171   .0659166     1.34   0.180     -.040877    .2175112
                 |
           _cons |  -.0132193   .0997633    -0.13   0.895    -.2087518    .1823132
----------------------------------------------------------------------------------

. 
. * 保存当前观测数
. quietly count

. local last_obs = r(N)

. 
. * 扩展数据集以容纳预测值
. quietly set obs `=`last_obs' + 4'

. 
. * 为新观测生成时间索引
. quietly replace t = _n if t == .

. 
. * 重新设置时间序列
. tsset t

Time variable: t, 1 to 220
        Delta: 1 unit

. 
. * 使用fcast进行动态预测
. fcast set var_forecast, replace
set unknown subcommand
r(198);

end of do-file

r(198);

2026-01-20 12:59:04,059 - data_processing - INFO - AKShare 库加载成功
2026-01-20 12:59:04,059 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 12:59:04,059 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 12:59:04,059 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 12:59:04,513 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 12:59:22,359 - data_processing - ERROR - 运行Stata时出错: 
. 
. * 再用SVAR的结构矩阵，将VAR预测值转换为SVAR预测值
. matrix f_ = A * f_var'  // 转换为结构预测值
f_var not found
r(111);

end of do-file

r(111);

2026-01-20 12:59:22,359 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: 
. 
. * 再用SVAR的结构矩阵，将VAR预测值转换为SVAR预测值
. matrix f_ = A * f_var'  // 转换为结构预测值
f_var not found
r(111);

end of do-file

r(111);

2026-01-20 13:03:54,182 - data_processing - INFO - AKShare 库加载成功
2026-01-20 13:03:54,183 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 13:03:54,183 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 13:03:54,184 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 13:03:54,666 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 13:04:05,211 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 13:04:05,211 - data_processing - INFO - Stata分析完成
2026-01-20 13:07:44,895 - data_processing - INFO - AKShare 库加载成功
2026-01-20 13:07:44,895 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 13:07:44,896 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 13:07:44,896 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 13:07:45,339 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 13:07:55,697 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 13:07:55,697 - data_processing - INFO - Stata分析完成
2026-01-20 13:16:57,276 - data_processing - INFO - AKShare 库加载成功
2026-01-20 13:16:57,276 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 13:16:57,277 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 13:16:57,277 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 13:16:57,718 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 13:17:01,531 - data_processing - ERROR - 运行Stata时出错:  |   Modulus   |
  |--------------------------+-------------|
  |   .8978293               |   .897829   |
  |   .8861801 +  .1383224i  |    .89691   |
  |   .8861801 -  .1383224i  |    .89691   |
  |   .6646203 + .09644956i  |   .671582   |
  |   .6646203 - .09644956i  |   .671582   |
  |  -.3144029 +    .56021i  |   .642405   |
  |  -.3144029 -    .56021i  |   .642405   |
  |   .3118025 +  .4399111i  |   .539205   |
  |   .3118025 -  .4399111i  |   .539205   |
  |  -.4477029               |   .447703   |
  |  -.1325701 +  .3312724i  |   .356814   |
  |  -.1325701 -  .3312724i  |   .356814   |
  +----------------------------------------+
   All the eigenvalues lie inside the unit circle.
   VAR satisfies stability condition.

. 
. /*==============================================================================
>   第九部分：SVAR模型设置与估计
> ==============================================================================*/
. 
. display _newline(2)




. display "================================================================================"
================================================================================

. display "第九部分：SVAR模型估计"
第九部分：SVAR模型估计

. display "================================================================================"
================================================================================

. display _newline



. 
. display "识别策略：Cholesky分解（递归同期因果关系）"
识别策略：Cholesky分解（递归同期因果关系）

. display _newline



. display "变量排序及其经济学含义："
变量排序及其经济学含义：

. display "  1. PPI：可同期响应供给冲击（最接近外生的变量）"
  1. PPI：可同期响应供给冲击（最接近外生的变量）

. display "  2. PMI(Wage)：根据通胀预期重新谈判"
  2. PMI(Wage)：根据通胀预期重新谈判

. display "  3. Credit：银行系统根据经济热度调整信贷标准"
  3. Credit：银行系统根据经济热度调整信贷标准

. display "  4. CPI：作为整体指标，最后综合反映所有冲击"
  4. CPI：作为整体指标，最后综合反映所有冲击

. display _newline



. 
. * 定义SVAR的短期约束矩阵（Cholesky分解）
. * 6变量系统的下三角矩阵
. * A矩阵：同期系数矩阵（下三角，对角线为1）
. matrix A = (1, 0, 0, 0, 0 \ ///
>             ., 1, 0, 0, 0 \ ///
>             ., ., 1, 0, 0 \ ///
>             ., ., ., 1, 0 \ ///
>             ., ., ., ., 1)

. 
. * B矩阵：结构冲击的方差矩阵（对角矩阵）
. matrix B = (., 0, 0, 0, 0 \ ///
>             0, ., 0, 0, 0 \ ///
>             0, 0, ., 0, 0 \ ///
>             0, 0, 0, ., 0 \ ///
>             0, 0, 0, 0, .)

. 
. * 估计SVAR模型
. svar ppi_yoy pmi_yoy dangyue_tongbizengzhang cpi_national_yoy, ///
>     lags(1/3) aeq(A) beq(B)
aeq() matrix does not have the correct row dimension
r(198);

end of do-file

r(198);

2026-01-20 13:17:01,534 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError:  |   Modulus   |
  |--------------------------+-------------|
  |   .8978293               |   .897829   |
  |   .8861801 +  .1383224i  |    .89691   |
  |   .8861801 -  .1383224i  |    .89691   |
  |   .6646203 + .09644956i  |   .671582   |
  |   .6646203 - .09644956i  |   .671582   |
  |  -.3144029 +    .56021i  |   .642405   |
  |  -.3144029 -    .56021i  |   .642405   |
  |   .3118025 +  .4399111i  |   .539205   |
  |   .3118025 -  .4399111i  |   .539205   |
  |  -.4477029               |   .447703   |
  |  -.1325701 +  .3312724i  |   .356814   |
  |  -.1325701 -  .3312724i  |   .356814   |
  +----------------------------------------+
   All the eigenvalues lie inside the unit circle.
   VAR satisfies stability condition.

. 
. /*==============================================================================
>   第九部分：SVAR模型设置与估计
> ==============================================================================*/
. 
. display _newline(2)




. display "================================================================================"
================================================================================

. display "第九部分：SVAR模型估计"
第九部分：SVAR模型估计

. display "================================================================================"
================================================================================

. display _newline



. 
. display "识别策略：Cholesky分解（递归同期因果关系）"
识别策略：Cholesky分解（递归同期因果关系）

. display _newline



. display "变量排序及其经济学含义："
变量排序及其经济学含义：

. display "  1. PPI：可同期响应供给冲击（最接近外生的变量）"
  1. PPI：可同期响应供给冲击（最接近外生的变量）

. display "  2. PMI(Wage)：根据通胀预期重新谈判"
  2. PMI(Wage)：根据通胀预期重新谈判

. display "  3. Credit：银行系统根据经济热度调整信贷标准"
  3. Credit：银行系统根据经济热度调整信贷标准

. display "  4. CPI：作为整体指标，最后综合反映所有冲击"
  4. CPI：作为整体指标，最后综合反映所有冲击

. display _newline



. 
. * 定义SVAR的短期约束矩阵（Cholesky分解）
. * 6变量系统的下三角矩阵
. * A矩阵：同期系数矩阵（下三角，对角线为1）
. matrix A = (1, 0, 0, 0, 0 \ ///
>             ., 1, 0, 0, 0 \ ///
>             ., ., 1, 0, 0 \ ///
>             ., ., ., 1, 0 \ ///
>             ., ., ., ., 1)

. 
. * B矩阵：结构冲击的方差矩阵（对角矩阵）
. matrix B = (., 0, 0, 0, 0 \ ///
>             0, ., 0, 0, 0 \ ///
>             0, 0, ., 0, 0 \ ///
>             0, 0, 0, ., 0 \ ///
>             0, 0, 0, 0, .)

. 
. * 估计SVAR模型
. svar ppi_yoy pmi_yoy dangyue_tongbizengzhang cpi_national_yoy, ///
>     lags(1/3) aeq(A) beq(B)
aeq() matrix does not have the correct row dimension
r(198);

end of do-file

r(198);

2026-01-20 13:17:36,965 - data_processing - INFO - AKShare 库加载成功
2026-01-20 13:17:36,965 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 13:17:36,966 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 13:17:36,966 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 13:17:37,429 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 13:17:53,538 - data_processing - ERROR - 运行Stata时出错: file ../output/扩展SVAR_预测图_PPI.png written in PNG format

. 
. * 恢复原始数据集大小
. quietly drop if t > `last_obs'

. tsset t

Time variable: t, 1 to 216
        Delta: 1 unit

. 
. * 清理临时变量
. drop ppi_fitted exp_fitted pmi_fitted credit_fitted cpi_fitted
variable exp_fitted not found
r(111);

end of do-file

r(111);

2026-01-20 13:17:53,538 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: file ../output/扩展SVAR_预测图_PPI.png written in PNG format

. 
. * 恢复原始数据集大小
. quietly drop if t > `last_obs'

. tsset t

Time variable: t, 1 to 216
        Delta: 1 unit

. 
. * 清理临时变量
. drop ppi_fitted exp_fitted pmi_fitted credit_fitted cpi_fitted
variable exp_fitted not found
r(111);

end of do-file

r(111);

2026-01-20 13:18:59,699 - data_processing - INFO - AKShare 库加载成功
2026-01-20 13:18:59,700 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 13:18:59,701 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 13:18:59,701 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 13:19:00,152 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 13:19:16,220 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 13:19:16,220 - data_processing - INFO - Stata分析完成
2026-01-20 13:38:14,364 - data_processing - INFO - AKShare 库加载成功
2026-01-20 13:38:14,364 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 13:38:14,365 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 13:38:14,365 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 13:38:14,806 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 13:38:50,209 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 13:38:50,209 - data_processing - INFO - Stata分析完成
2026-01-20 13:42:01,307 - data_processing - INFO - AKShare 库加载成功
2026-01-20 13:42:01,308 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 13:42:01,308 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 13:42:01,308 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 13:42:01,751 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 13:42:12,515 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 13:42:12,515 - data_processing - INFO - Stata分析完成
2026-01-20 13:43:36,267 - data_processing - INFO - AKShare 库加载成功
2026-01-20 13:43:36,267 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 13:43:36,268 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 13:43:36,268 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 13:43:36,730 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 13:44:11,657 - data_processing - INFO - 生成了 35 个输出文件
2026-01-20 13:44:11,657 - data_processing - INFO - Stata分析完成
2026-01-20 13:55:38,822 - data_processing - INFO - AKShare 库加载成功
2026-01-20 13:55:38,822 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 13:55:38,823 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 13:55:38,823 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 13:55:39,274 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 13:55:54,519 - data_processing - INFO - 生成了 36 个输出文件
2026-01-20 13:55:54,519 - data_processing - INFO - Stata分析完成
2026-01-20 13:59:19,135 - data_processing - INFO - AKShare 库加载成功
2026-01-20 13:59:19,135 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 13:59:19,136 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 13:59:19,136 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 13:59:19,577 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 13:59:35,069 - data_processing - INFO - 生成了 36 个输出文件
2026-01-20 13:59:35,069 - data_processing - INFO - Stata分析完成
2026-01-20 14:00:31,639 - data_processing - INFO - AKShare 库加载成功
2026-01-20 14:00:31,639 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 14:00:31,640 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 14:00:31,640 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 14:00:32,079 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 14:00:45,576 - data_processing - INFO - 生成了 36 个输出文件
2026-01-20 14:00:45,576 - data_processing - INFO - Stata分析完成
2026-01-20 14:02:09,528 - data_processing - INFO - AKShare 库加载成功
2026-01-20 14:02:09,529 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 14:02:09,529 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 14:02:09,530 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 14:02:09,964 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 14:02:23,773 - data_processing - INFO - 生成了 36 个输出文件
2026-01-20 14:02:23,773 - data_processing - INFO - Stata分析完成
2026-01-20 14:12:57,753 - data_processing - INFO - AKShare 库加载成功
2026-01-20 14:12:57,758 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 14:12:57,758 - data_processing - INFO - 原始数据: 80行
2026-01-20 14:12:57,760 - data_processing - INFO - 检测到GDP数据，将转换为不变价GDP（基准年=2015）
2026-01-20 14:12:57,761 - data_processing - INFO - 2015年基准名义GDP: 702511.50亿元
2026-01-20 14:12:57,786 - data_processing - INFO - 不变价GDP计算完成: 77/80行
2026-01-20 14:12:57,788 - data_processing - INFO - 2015年基准名义GDP: 57774.60亿元
2026-01-20 14:12:57,812 - data_processing - INFO - 不变价GDP计算完成: 77/80行
2026-01-20 14:12:57,814 - data_processing - INFO - 2015年基准名义GDP: 281338.90亿元
2026-01-20 14:12:57,838 - data_processing - INFO - 不变价GDP计算完成: 77/80行
2026-01-20 14:12:57,839 - data_processing - INFO - 2015年基准名义GDP: 363397.90亿元
2026-01-20 14:12:57,865 - data_processing - INFO - 不变价GDP计算完成: 77/80行
2026-01-20 14:12:57,865 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 14:12:57,872 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 14:12:57,873 - data_processing - INFO - 转换完成（不变价，基准年=2015）: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 14:12:57,878 - data_processing - INFO - 成功读取: 国债利差_标准日期.csv (6008行)
2026-01-20 14:12:57,878 - data_processing - INFO - 原始数据: 6008行
2026-01-20 14:12:57,880 - data_processing - INFO - 检测到日度数据（平均间隔1天）
2026-01-20 14:12:57,887 - data_processing - INFO - 已保存: 国债利差_月度.csv (289行 × 4列)
2026-01-20 14:12:57,887 - data_processing - INFO - 转换完成: 6008行 → 289行 (2002-01-01 ~ 2026-01-01) 方法: 日度平均
2026-01-20 14:12:57,888 - data_processing - INFO - 成功转换: 2/2 个文件
2026-01-20 14:12:57,889 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 14:12:57,890 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 14:12:57,891 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 14:12:57,893 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 14:12:57,894 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 14:12:57,895 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 14:12:57,896 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 14:12:57,898 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 14:12:57,910 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 14:12:57,912 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 14:12:57,924 - data_processing - INFO - 成功读取: 国债利差_月度.csv (289行)
2026-01-20 14:12:57,926 - data_processing - INFO - 已合并: 国债利差_月度.csv (1列)
2026-01-20 14:12:57,928 - data_processing - INFO - 已保存: 统一月度数据集.csv (289行 × 11列)
2026-01-20 14:12:57,928 - data_processing - INFO - 统一数据集: 289行 × 11列 (2002-01-01 ~ 2026-01-01)
2026-01-20 14:12:57,930 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 14:12:57,933 - data_processing - INFO - 删除中文列: month, var
2026-01-20 14:12:57,938 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 14:12:57,939 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 14:12:57,939 - data_processing - INFO - 删除中文列: month, var
2026-01-20 14:12:57,943 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (216行 × 4列)
2026-01-20 14:12:57,944 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 14:12:57,944 - data_processing - INFO - 删除中文列: month, var
2026-01-20 14:12:57,947 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 14:12:57,948 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 14:12:57,952 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (216行 × 9列)
2026-01-20 14:12:57,953 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 14:12:57,953 - data_processing - INFO - 删除中文列: month, var
2026-01-20 14:12:57,956 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 14:12:57,957 - data_processing - INFO - 正在转换: 国债利差_月度.csv
2026-01-20 14:12:57,960 - data_processing - INFO - 国债利差_月度.csv → 国债利差_标准日期.dta (217行 × 4列)
2026-01-20 14:12:57,960 - data_processing - INFO - 成功: 6/6 个文件
2026-01-20 14:15:03,466 - data_processing - INFO - AKShare 库加载成功
2026-01-20 14:15:03,467 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 14:15:03,721 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 14:15:03,722 - data_processing - INFO - PPI: 240行数据
2026-01-20 14:15:04,722 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 14:15:05,019 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 14:15:05,020 - data_processing - INFO - CPI: 216行数据
2026-01-20 14:15:06,020 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 14:15:06,304 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 14:15:06,305 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 14:15:07,305 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 14:15:07,631 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 14:15:07,631 - data_processing - INFO - GDP: 80行数据
2026-01-20 14:15:08,633 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 14:15:08,889 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 14:15:08,889 - data_processing - INFO - PMI: 216行数据
2026-01-20 14:15:09,890 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 14:15:14,796 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 14:15:14,797 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 14:15:14,797 - data_processing - INFO - 识别列: 日期=日期, 2年期=中国国债收益率2年, 10年期=中国国债收益率10年
2026-01-20 14:15:14,798 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 14:15:14,810 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 14:15:14,810 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 14:15:14,811 - data_processing - INFO - 步骤 1 完成
2026-01-20 14:15:14,828 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 14:15:14,835 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 14:15:14,836 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 14:15:14,859 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 14:15:14,866 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 14:15:14,868 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 14:15:14,912 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 14:15:14,919 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 14:15:14,920 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 14:15:14,939 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 14:15:14,944 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 14:15:14,945 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 14:15:14,970 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 14:15:14,973 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 14:15:14,974 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 14:15:15,005 - data_processing - INFO - 成功读取: 国债利差_原始数据.csv (6008行)
2026-01-20 14:15:15,017 - data_processing - INFO - 已保存: 国债利差_标准日期.csv (6008行 × 5列)
2026-01-20 14:15:15,019 - data_processing - INFO - 国债利差_原始数据.csv → 国债利差_标准日期.csv (6008行, 2002-01-04 ~ 2026-01-19)
2026-01-20 14:15:15,019 - data_processing - INFO - 成功: 6个文件
2026-01-20 14:15:15,019 - data_processing - INFO - 步骤 2 完成
2026-01-20 14:15:15,031 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 14:15:15,031 - data_processing - INFO - 原始数据: 80行
2026-01-20 14:15:15,033 - data_processing - INFO - 检测到GDP数据，将转换为不变价GDP（基准年=2015）
2026-01-20 14:15:15,036 - data_processing - INFO - 2015年基准名义GDP: 702511.50亿元
2026-01-20 14:15:15,061 - data_processing - INFO - 不变价GDP计算完成: 77/80行
2026-01-20 14:15:15,063 - data_processing - INFO - 2015年基准名义GDP: 57774.60亿元
2026-01-20 14:15:15,089 - data_processing - INFO - 不变价GDP计算完成: 77/80行
2026-01-20 14:15:15,090 - data_processing - INFO - 2015年基准名义GDP: 281338.90亿元
2026-01-20 14:15:15,117 - data_processing - INFO - 不变价GDP计算完成: 77/80行
2026-01-20 14:15:15,118 - data_processing - INFO - 2015年基准名义GDP: 363397.90亿元
2026-01-20 14:15:15,144 - data_processing - INFO - 不变价GDP计算完成: 77/80行
2026-01-20 14:15:15,144 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 14:15:15,148 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 14:15:15,149 - data_processing - INFO - 转换完成（不变价，基准年=2015）: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 14:15:15,195 - data_processing - INFO - 成功读取: 国债利差_标准日期.csv (6008行)
2026-01-20 14:15:15,195 - data_processing - INFO - 原始数据: 6008行
2026-01-20 14:15:15,197 - data_processing - INFO - 检测到日度数据（平均间隔1天）
2026-01-20 14:15:15,203 - data_processing - INFO - 已保存: 国债利差_月度.csv (289行 × 4列)
2026-01-20 14:15:15,203 - data_processing - INFO - 转换完成: 6008行 → 289行 (2002-01-01 ~ 2026-01-01) 方法: 日度平均
2026-01-20 14:15:15,203 - data_processing - INFO - 成功转换: 2/2 个文件
2026-01-20 14:15:15,240 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 14:15:15,241 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 14:15:15,261 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 14:15:15,264 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 14:15:15,278 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 14:15:15,281 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 14:15:15,297 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 14:15:15,299 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 14:15:15,313 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 14:15:15,316 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 14:15:15,349 - data_processing - INFO - 成功读取: 国债利差_月度.csv (289行)
2026-01-20 14:15:15,352 - data_processing - INFO - 已合并: 国债利差_月度.csv (1列)
2026-01-20 14:15:15,356 - data_processing - INFO - 已保存: 统一月度数据集.csv (289行 × 11列)
2026-01-20 14:15:15,357 - data_processing - INFO - 统一数据集: 289行 × 11列 (2002-01-01 ~ 2026-01-01)
2026-01-20 14:15:15,357 - data_processing - INFO - 步骤 3 完成
2026-01-20 14:15:15,359 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 14:15:15,361 - data_processing - INFO - 删除中文列: month, var
2026-01-20 14:15:15,366 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 14:15:15,367 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 14:15:15,369 - data_processing - INFO - 删除中文列: month, var
2026-01-20 14:15:15,372 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (216行 × 4列)
2026-01-20 14:15:15,374 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 14:15:15,374 - data_processing - INFO - 删除中文列: month, var
2026-01-20 14:15:15,377 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 14:15:15,378 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 14:15:15,383 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (216行 × 9列)
2026-01-20 14:15:15,384 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 14:15:15,384 - data_processing - INFO - 删除中文列: month, var
2026-01-20 14:15:15,387 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 14:15:15,388 - data_processing - INFO - 正在转换: 国债利差_月度.csv
2026-01-20 14:15:15,393 - data_processing - INFO - 国债利差_月度.csv → 国债利差_标准日期.dta (217行 × 4列)
2026-01-20 14:15:15,393 - data_processing - INFO - 成功: 6/6 个文件
2026-01-20 14:15:15,393 - data_processing - INFO - 步骤 4 完成
2026-01-20 14:15:15,393 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 14:15:15,394 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 14:15:15,394 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 14:15:15,812 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 14:15:26,090 - data_processing - INFO - 生成了 16 个输出文件
2026-01-20 14:15:26,090 - data_processing - INFO - Stata分析完成
2026-01-20 14:15:26,090 - data_processing - INFO - 步骤 5 完成
2026-01-20 14:15:26,091 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 14:15:26,091 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 14:15:26,091 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 14:15:26,091 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 14:15:39,342 - data_processing - INFO - 生成了 31 个输出文件
2026-01-20 14:15:39,342 - data_processing - INFO - Stata分析完成
2026-01-20 14:15:39,342 - data_processing - INFO - 步骤 6 完成
2026-01-20 14:50:47,280 - data_processing - INFO - AKShare 库加载成功
2026-01-20 14:50:47,280 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 14:50:47,281 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 14:50:47,281 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 14:50:47,699 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 14:50:49,372 - data_processing - ERROR - 运行Stata时出错: 
Augmented Dickey–Fuller test for unit root

Variable: credit                          Number of obs  = 211
                                          Number of lags =   4

H0: Random walk with or without drift

                                       Dickey–Fuller
                   Test      -------- critical value ---------
              statistic           1%           5%          10%
--------------------------------------------------------------
 Z(t)            -5.313       -4.003       -3.435       -3.135
--------------------------------------------------------------
MacKinnon approximate p-value for Z(t) = 0.0001.

Regression table
------------------------------------------------------------------------------
    D.credit | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      credit |
         L1. |  -.5488009   .1032911    -5.31   0.000    -.7524559   -.3451459
         LD. |  -.2132591   .1019891    -2.09   0.038     -.414347   -.0121713
        L2D. |  -.1788186   .0994722    -1.80   0.074     -.374944    .0173068
        L3D. |   .1602432   .0867776     1.85   0.066    -.0108527    .3313391
        L4D. |   .0415145   .0697914     0.59   0.553    -.0960904    .1791195
             |
      _trend |  -.0034874   .0014133    -2.47   0.014     -.006274   -.0007008
       _cons |   .4832213   .1821299     2.65   0.009     .1241228    .8423198
------------------------------------------------------------------------------

. 
. * 对工资进行ADF检验
. display _newline "3. 工资 - ADF检验"

3. 工资 - ADF检验

. dfuller pmi_yoy, lags(4) regress
variable pmi_yoy not found
r(111);

end of do-file

r(111);

2026-01-20 14:50:49,372 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: 
Augmented Dickey–Fuller test for unit root

Variable: credit                          Number of obs  = 211
                                          Number of lags =   4

H0: Random walk with or without drift

                                       Dickey–Fuller
                   Test      -------- critical value ---------
              statistic           1%           5%          10%
--------------------------------------------------------------
 Z(t)            -5.313       -4.003       -3.435       -3.135
--------------------------------------------------------------
MacKinnon approximate p-value for Z(t) = 0.0001.

Regression table
------------------------------------------------------------------------------
    D.credit | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      credit |
         L1. |  -.5488009   .1032911    -5.31   0.000    -.7524559   -.3451459
         LD. |  -.2132591   .1019891    -2.09   0.038     -.414347   -.0121713
        L2D. |  -.1788186   .0994722    -1.80   0.074     -.374944    .0173068
        L3D. |   .1602432   .0867776     1.85   0.066    -.0108527    .3313391
        L4D. |   .0415145   .0697914     0.59   0.553    -.0960904    .1791195
             |
      _trend |  -.0034874   .0014133    -2.47   0.014     -.006274   -.0007008
       _cons |   .4832213   .1821299     2.65   0.009     .1241228    .8423198
------------------------------------------------------------------------------

. 
. * 对工资进行ADF检验
. display _newline "3. 工资 - ADF检验"

3. 工资 - ADF检验

. dfuller pmi_yoy, lags(4) regress
variable pmi_yoy not found
r(111);

end of do-file

r(111);

2026-01-20 14:51:53,928 - data_processing - INFO - AKShare 库加载成功
2026-01-20 14:51:53,929 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 14:51:53,929 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 14:51:53,929 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 14:51:54,372 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 14:51:54,547 - data_processing - ERROR - 运行Stata时出错: file merged_extend_data.dta saved

. 
. display "数据导入完成：使用月度数据进行扩展SVAR分析"
数据导入完成：使用月度数据进行扩展SVAR分析

. display "观测数量: " _N
观测数量: 216

. display "时间范围: " month_date[1] " 至 " month_date[_N]
时间范围: 1.515e+12 至 2.080e+12

. display _newline



. 
. * 查看数据描述
. describe

Contains data from merged_extend_data.dta
 Observations:           216                  
    Variables:            32                  20 Jan 2026 14:51
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
month_date      double  %tc                   
cpi_national    double  %10.0g                
cpi_national_~y double  %10.0g                
cpi_national~om double  %10.0g                
cpi_national~um double  %10.0g                
cpi_urban       double  %10.0g                
cpi_urban_yoy   double  %10.0g                
huanbizengzhang double  %10.0g                
leiji           double  %10.0g                
cpi_rural       double  %10.0g                
cpi_rural_yoy   double  %10.0g                
huanbizengzha~1 double  %10.0g                
leiji_1         double  %10.0g                
ppi_current     double  %10.0g                
ppi_yoy         double  %10.0g                
ppi_cum         double  %10.0g                
dangyue_tongb~g double  %10.0g                
dangyue_huanb~g double  %10.0g                
leiji_tongbiz~g double  %10.0g                
gdp_value       double  %10.0g                
gdp_yoy         double  %10.0g                
gdp_primary_v~e double  %10.0g                
gdp_primary_yoy double  %10.0g                
gdp_secondary~e double  %10.0g                
gdp_secondary~y double  %10.0g                
gdp_tertiary_~e double  %10.0g                
gdp_tertiary_~y double  %10.0g                
pmi_mfg         double  %10.0g                
pmi_mfg_yoy     double  %10.0g                
zhizaoye_zhishu double  %10.0g                
zhizaoye_tong~g double  %10.0g                
t               double  %10.0g                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Sorted by: t

. summarize

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
  month_date |        216    1.80e+12    1.64e+11   1.51e+12   2.08e+12
cpi_national |        216    102.0644     1.90376    98.1943   108.7443
cpi_nation~y |        216    2.064379     1.90376    -1.8057     8.7443
cpi_natio~om |        216     .155943    .5237453       -1.2        2.6
cpi_natio~um |        216    102.1312    1.959664    98.8285   108.1544
-------------+---------------------------------------------------------
   cpi_urban |        216    102.0324    1.836446    98.1006   108.4973
cpi_urban_~y |        216    2.032351    1.836446    -1.8994     8.4973
huanbizeng~g |        216    .1544552    .5252512       -1.2        2.7
       leiji |        216    102.0971    1.894839    98.6445   107.8412
   cpi_rural |        216     102.131    2.111496    98.4173   109.2737
-------------+---------------------------------------------------------
cpi_rural_~y |        216    2.131021    2.111496    -1.5827     9.2737
huanbizeng~1 |        216    .1613429    .5331324       -1.3        2.4
     leiji_1 |        216    102.2067     2.16212       99.2   108.8147
 ppi_current |        216    100.7369     4.75631      91.78      113.5
     ppi_yoy |        216    .7362449    4.755726      -8.22       13.5
-------------+---------------------------------------------------------
     ppi_cum |        216    100.8412    4.482193       93.5      109.1
dangyue_to~g |        216    17.96503    126.4319  -431.6832   1476.289
dangyue_hu~g |        216    78.96364    350.7539  -118.2034   3584.615
leiji_tong~g |        216    13.91685    39.61426    -43.159   243.7791
   gdp_value |        216    462970.1    242809.9   85405.88    1209685
-------------+---------------------------------------------------------
     gdp_yoy |        216    7.112037    3.180473       -6.8       18.9
gdp_primar~e |        216    31368.14    18186.22   5337.743   85308.46
gdp_primar~y |        216    3.741204    1.323235       -3.1        8.1
gdp_second~e |        216    179985.7    92038.26   32397.62   453756.4
gdp_second~y |        216    7.060185    4.179381      -10.1       24.9
-------------+---------------------------------------------------------
gdp_tertia~e |        216    252360.3    134040.9   48477.59   669415.2
gdp_tertia~y |        216    7.546759    2.885043       -4.9       16.4
     pmi_mfg |        216    50.65231    2.327009       35.7       59.2
 pmi_mfg_yoy |        216   -.3323251    7.211176   -29.9639   42.26804
zhizaoye_z~u |        216     53.9912    3.234202       29.6       60.2
-------------+---------------------------------------------------------
zhizaoye_t~g |        216   -.6965472    8.490486  -45.48803   73.64865
           t |        216       108.5      62.498          1        216

. 
. /*==============================================================================
>   第二部分：变量定义与预处理
> ==============================================================================*/
. 
. display _newline(2)




. display "================================================================================"
================================================================================

. display "第二部分：变量定义与预处理"
第二部分：变量定义与预处理

. display "================================================================================"
================================================================================

. display _newline



. 
. * 变量命名说明：
. * - ppi_yoy: PPI同比增长率（通缩部门价格指数）
. * - credit: 新增贷款（信贷渠道）
. * - pmi_yoy: 工资同比
. * - cpi_national_yoy: CPI整体同比（整体通胀）
. * - gdp_yoy: 不变价GDP同比
. 
. * 检查变量是否存在，如不存在则创建
. * 注意：根据实际数据文件中的变量名进行调整
. 
. * 数据标准化
. gen credit = dangyue_tongbizengzhang / 100

. gen mean_pmi = mean(pmi_mfg_yoy)
unknown function mean()
r(133);

end of do-file

r(133);

2026-01-20 14:51:54,548 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: file merged_extend_data.dta saved

. 
. display "数据导入完成：使用月度数据进行扩展SVAR分析"
数据导入完成：使用月度数据进行扩展SVAR分析

. display "观测数量: " _N
观测数量: 216

. display "时间范围: " month_date[1] " 至 " month_date[_N]
时间范围: 1.515e+12 至 2.080e+12

. display _newline



. 
. * 查看数据描述
. describe

Contains data from merged_extend_data.dta
 Observations:           216                  
    Variables:            32                  20 Jan 2026 14:51
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
month_date      double  %tc                   
cpi_national    double  %10.0g                
cpi_national_~y double  %10.0g                
cpi_national~om double  %10.0g                
cpi_national~um double  %10.0g                
cpi_urban       double  %10.0g                
cpi_urban_yoy   double  %10.0g                
huanbizengzhang double  %10.0g                
leiji           double  %10.0g                
cpi_rural       double  %10.0g                
cpi_rural_yoy   double  %10.0g                
huanbizengzha~1 double  %10.0g                
leiji_1         double  %10.0g                
ppi_current     double  %10.0g                
ppi_yoy         double  %10.0g                
ppi_cum         double  %10.0g                
dangyue_tongb~g double  %10.0g                
dangyue_huanb~g double  %10.0g                
leiji_tongbiz~g double  %10.0g                
gdp_value       double  %10.0g                
gdp_yoy         double  %10.0g                
gdp_primary_v~e double  %10.0g                
gdp_primary_yoy double  %10.0g                
gdp_secondary~e double  %10.0g                
gdp_secondary~y double  %10.0g                
gdp_tertiary_~e double  %10.0g                
gdp_tertiary_~y double  %10.0g                
pmi_mfg         double  %10.0g                
pmi_mfg_yoy     double  %10.0g                
zhizaoye_zhishu double  %10.0g                
zhizaoye_tong~g double  %10.0g                
t               double  %10.0g                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Sorted by: t

. summarize

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
  month_date |        216    1.80e+12    1.64e+11   1.51e+12   2.08e+12
cpi_national |        216    102.0644     1.90376    98.1943   108.7443
cpi_nation~y |        216    2.064379     1.90376    -1.8057     8.7443
cpi_natio~om |        216     .155943    .5237453       -1.2        2.6
cpi_natio~um |        216    102.1312    1.959664    98.8285   108.1544
-------------+---------------------------------------------------------
   cpi_urban |        216    102.0324    1.836446    98.1006   108.4973
cpi_urban_~y |        216    2.032351    1.836446    -1.8994     8.4973
huanbizeng~g |        216    .1544552    .5252512       -1.2        2.7
       leiji |        216    102.0971    1.894839    98.6445   107.8412
   cpi_rural |        216     102.131    2.111496    98.4173   109.2737
-------------+---------------------------------------------------------
cpi_rural_~y |        216    2.131021    2.111496    -1.5827     9.2737
huanbizeng~1 |        216    .1613429    .5331324       -1.3        2.4
     leiji_1 |        216    102.2067     2.16212       99.2   108.8147
 ppi_current |        216    100.7369     4.75631      91.78      113.5
     ppi_yoy |        216    .7362449    4.755726      -8.22       13.5
-------------+---------------------------------------------------------
     ppi_cum |        216    100.8412    4.482193       93.5      109.1
dangyue_to~g |        216    17.96503    126.4319  -431.6832   1476.289
dangyue_hu~g |        216    78.96364    350.7539  -118.2034   3584.615
leiji_tong~g |        216    13.91685    39.61426    -43.159   243.7791
   gdp_value |        216    462970.1    242809.9   85405.88    1209685
-------------+---------------------------------------------------------
     gdp_yoy |        216    7.112037    3.180473       -6.8       18.9
gdp_primar~e |        216    31368.14    18186.22   5337.743   85308.46
gdp_primar~y |        216    3.741204    1.323235       -3.1        8.1
gdp_second~e |        216    179985.7    92038.26   32397.62   453756.4
gdp_second~y |        216    7.060185    4.179381      -10.1       24.9
-------------+---------------------------------------------------------
gdp_tertia~e |        216    252360.3    134040.9   48477.59   669415.2
gdp_tertia~y |        216    7.546759    2.885043       -4.9       16.4
     pmi_mfg |        216    50.65231    2.327009       35.7       59.2
 pmi_mfg_yoy |        216   -.3323251    7.211176   -29.9639   42.26804
zhizaoye_z~u |        216     53.9912    3.234202       29.6       60.2
-------------+---------------------------------------------------------
zhizaoye_t~g |        216   -.6965472    8.490486  -45.48803   73.64865
           t |        216       108.5      62.498          1        216

. 
. /*==============================================================================
>   第二部分：变量定义与预处理
> ==============================================================================*/
. 
. display _newline(2)




. display "================================================================================"
================================================================================

. display "第二部分：变量定义与预处理"
第二部分：变量定义与预处理

. display "================================================================================"
================================================================================

. display _newline



. 
. * 变量命名说明：
. * - ppi_yoy: PPI同比增长率（通缩部门价格指数）
. * - credit: 新增贷款（信贷渠道）
. * - pmi_yoy: 工资同比
. * - cpi_national_yoy: CPI整体同比（整体通胀）
. * - gdp_yoy: 不变价GDP同比
. 
. * 检查变量是否存在，如不存在则创建
. * 注意：根据实际数据文件中的变量名进行调整
. 
. * 数据标准化
. gen credit = dangyue_tongbizengzhang / 100

. gen mean_pmi = mean(pmi_mfg_yoy)
unknown function mean()
r(133);

end of do-file

r(133);

2026-01-20 14:52:26,581 - data_processing - INFO - AKShare 库加载成功
2026-01-20 14:52:26,581 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 14:52:26,581 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 14:52:26,582 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 14:52:27,024 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 14:52:51,904 - data_processing - ERROR - 运行Stata时出错: file ../output/扩展SVAR_FEVD_PPI.png written in PNG format

. 
. /*==============================================================================
>   第十二部分：拟合与预测结果
> ==============================================================================*/
. 
. display _newline(2)




. display "================================================================================"
================================================================================

. display "第十二部分：拟合与预测分析"
第十二部分：拟合与预测分析

. display "================================================================================"
================================================================================

. display _newline



. 
. * 保存当前VAR模型估计结果
. estimates restore var_extend_model
(results var_extend_model are active now)

. 
. * 1. 样本内拟合优度评估
. display _newline "1. 样本内拟合优度："

1. 样本内拟合优度：

. display _newline



. 
. * 获取拟合值和残差
. predict ppi_fitted if e(sample), equation(ppi_yoy) xb
(2 missing values generated)

. predict credit_fitted if e(sample), equation(credit) xb
(2 missing values generated)

. predict pmi_fitted if e(sample), equation(pmi) xb
equation pmi not found
r(303);

end of do-file

r(303);

2026-01-20 14:52:51,904 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: file ../output/扩展SVAR_FEVD_PPI.png written in PNG format

. 
. /*==============================================================================
>   第十二部分：拟合与预测结果
> ==============================================================================*/
. 
. display _newline(2)




. display "================================================================================"
================================================================================

. display "第十二部分：拟合与预测分析"
第十二部分：拟合与预测分析

. display "================================================================================"
================================================================================

. display _newline



. 
. * 保存当前VAR模型估计结果
. estimates restore var_extend_model
(results var_extend_model are active now)

. 
. * 1. 样本内拟合优度评估
. display _newline "1. 样本内拟合优度："

1. 样本内拟合优度：

. display _newline



. 
. * 获取拟合值和残差
. predict ppi_fitted if e(sample), equation(ppi_yoy) xb
(2 missing values generated)

. predict credit_fitted if e(sample), equation(credit) xb
(2 missing values generated)

. predict pmi_fitted if e(sample), equation(pmi) xb
equation pmi not found
r(303);

end of do-file

r(303);

2026-01-20 14:53:21,560 - data_processing - INFO - AKShare 库加载成功
2026-01-20 14:53:21,560 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 14:53:21,561 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 14:53:21,561 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 14:53:21,987 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 14:54:15,451 - data_processing - INFO - 生成了 33 个输出文件
2026-01-20 14:54:15,451 - data_processing - INFO - Stata分析完成
2026-01-20 15:06:24,709 - data_processing - INFO - AKShare 库加载成功
2026-01-20 15:06:24,710 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 15:06:24,710 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 15:06:24,711 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 15:06:25,159 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 15:07:00,892 - data_processing - INFO - 生成了 33 个输出文件
2026-01-20 15:07:00,892 - data_processing - INFO - Stata分析完成
2026-01-20 15:07:22,850 - data_processing - INFO - AKShare 库加载成功
2026-01-20 15:07:22,851 - data_processing - INFO - 正在获取PPI数据...
2026-01-20 15:07:23,122 - data_processing - INFO - 已保存: PPI_原始数据.csv (240行 × 4列)
2026-01-20 15:07:23,122 - data_processing - INFO - PPI: 240行数据
2026-01-20 15:07:24,123 - data_processing - INFO - 正在获取CPI数据...
2026-01-20 15:07:24,384 - data_processing - INFO - 已保存: CPI_原始数据.csv (216行 × 13列)
2026-01-20 15:07:24,384 - data_processing - INFO - CPI: 216行数据
2026-01-20 15:07:25,385 - data_processing - INFO - 正在获取新增贷款数据...
2026-01-20 15:07:25,671 - data_processing - INFO - 已保存: 新增贷款_原始数据.csv (216行 × 6列)
2026-01-20 15:07:25,671 - data_processing - INFO - 新增贷款: 216行数据
2026-01-20 15:07:26,672 - data_processing - INFO - 正在获取GDP数据...
2026-01-20 15:07:27,128 - data_processing - INFO - 已保存: GDP_原始数据.csv (80行 × 9列)
2026-01-20 15:07:27,128 - data_processing - INFO - GDP: 80行数据
2026-01-20 15:07:28,129 - data_processing - INFO - 正在获取PMI数据...
2026-01-20 15:07:28,368 - data_processing - INFO - 已保存: PMI_原始数据.csv (216行 × 5列)
2026-01-20 15:07:28,369 - data_processing - INFO - PMI: 216行数据
2026-01-20 15:07:29,369 - data_processing - INFO - 正在获取国债收益率数据...
2026-01-20 15:07:33,885 - data_processing - INFO - 国债收益率数据: 9171行数据
2026-01-20 15:07:33,886 - data_processing - INFO - 国债数据列名: ['日期', '中国国债收益率2年', '中国国债收益率5年', '中国国债收益率10年', '中国国债收益率30年', '中国国债收益率10年-2年', '中国GDP年增率', '美国国债收益率2年', '美国国债收益率5年', '美国国债收益率10年', '美国国债收益率30年', '美国国债收益率10年-2年', '美国GDP年增率']
2026-01-20 15:07:33,886 - data_processing - INFO - 识别列: 日期=日期, 2年期=中国国债收益率2年, 10年期=中国国债收益率10年
2026-01-20 15:07:33,887 - data_processing - INFO - 计算利差完成: 6008行有效数据
2026-01-20 15:07:33,898 - data_processing - INFO - 已保存: 国债利差_原始数据.csv (6008行 × 4列)
2026-01-20 15:07:33,898 - data_processing - INFO - 国债利差: 6008行数据 (10年期-2年期)
2026-01-20 15:07:33,899 - data_processing - INFO - 步骤 1 完成
2026-01-20 15:07:33,910 - data_processing - INFO - 成功读取: CPI_原始数据.csv (216行)
2026-01-20 15:07:33,912 - data_processing - INFO - 已保存: CPI_标准日期.csv (216行 × 15列)
2026-01-20 15:07:33,913 - data_processing - INFO - CPI_原始数据.csv → CPI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 15:07:33,926 - data_processing - INFO - 成功读取: PPI_原始数据.csv (240行)
2026-01-20 15:07:33,930 - data_processing - INFO - 已保存: PPI_标准日期.csv (240行 × 6列)
2026-01-20 15:07:33,930 - data_processing - INFO - PPI_原始数据.csv → PPI_标准日期.csv (240行, 2006-01-01 ~ 2025-12-01)
2026-01-20 15:07:33,957 - data_processing - INFO - 成功读取: PMI_原始数据.csv (216行)
2026-01-20 15:07:33,961 - data_processing - INFO - 已保存: PMI_标准日期.csv (216行 × 7列)
2026-01-20 15:07:33,962 - data_processing - INFO - PMI_原始数据.csv → PMI_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 15:07:33,964 - data_processing - INFO - 成功读取: GDP_原始数据.csv (80行)
2026-01-20 15:07:33,966 - data_processing - INFO - 已保存: GDP_标准日期.csv (80行 × 11列)
2026-01-20 15:07:33,967 - data_processing - INFO - GDP_原始数据.csv → GDP_标准日期.csv (80行, 2006-03-31 ~ 2025-12-31)
2026-01-20 15:07:34,004 - data_processing - INFO - 成功读取: 新增贷款_原始数据.csv (216行)
2026-01-20 15:07:34,012 - data_processing - INFO - 已保存: 新增贷款_标准日期.csv (216行 × 8列)
2026-01-20 15:07:34,014 - data_processing - INFO - 新增贷款_原始数据.csv → 新增贷款_标准日期.csv (216行, 2008-01-01 ~ 2025-12-01)
2026-01-20 15:07:34,063 - data_processing - INFO - 成功读取: 国债利差_原始数据.csv (6008行)
2026-01-20 15:07:34,077 - data_processing - INFO - 已保存: 国债利差_标准日期.csv (6008行 × 5列)
2026-01-20 15:07:34,078 - data_processing - INFO - 国债利差_原始数据.csv → 国债利差_标准日期.csv (6008行, 2002-01-04 ~ 2026-01-19)
2026-01-20 15:07:34,079 - data_processing - INFO - 成功: 6个文件
2026-01-20 15:07:34,079 - data_processing - INFO - 步骤 2 完成
2026-01-20 15:07:34,109 - data_processing - INFO - 成功读取: GDP_标准日期.csv (80行)
2026-01-20 15:07:34,110 - data_processing - INFO - 原始数据: 80行
2026-01-20 15:07:34,112 - data_processing - INFO - 检测到GDP数据，将转换为不变价GDP（基准年=2015）
2026-01-20 15:07:34,114 - data_processing - INFO - 2015年基准名义GDP: 702511.50亿元
2026-01-20 15:07:34,140 - data_processing - INFO - 不变价GDP计算完成: 77/80行
2026-01-20 15:07:34,141 - data_processing - INFO - 2015年基准名义GDP: 57774.60亿元
2026-01-20 15:07:34,166 - data_processing - INFO - 不变价GDP计算完成: 77/80行
2026-01-20 15:07:34,168 - data_processing - INFO - 2015年基准名义GDP: 281338.90亿元
2026-01-20 15:07:34,193 - data_processing - INFO - 不变价GDP计算完成: 77/80行
2026-01-20 15:07:34,194 - data_processing - INFO - 2015年基准名义GDP: 363397.90亿元
2026-01-20 15:07:34,219 - data_processing - INFO - 不变价GDP计算完成: 77/80行
2026-01-20 15:07:34,221 - data_processing - INFO - 检测到季度数据（平均间隔92天）
2026-01-20 15:07:34,224 - data_processing - INFO - 已保存: GDP_月度.csv (238行 × 9列)
2026-01-20 15:07:34,225 - data_processing - INFO - 转换完成（不变价，基准年=2015）: 80行 → 238行 (2006-03-01 ~ 2025-12-01) 方法: 线性插值
2026-01-20 15:07:34,247 - data_processing - INFO - 成功读取: 国债利差_标准日期.csv (6008行)
2026-01-20 15:07:34,247 - data_processing - INFO - 原始数据: 6008行
2026-01-20 15:07:34,248 - data_processing - INFO - 检测到日度数据（平均间隔1天）
2026-01-20 15:07:34,254 - data_processing - INFO - 已保存: 国债利差_月度.csv (289行 × 4列)
2026-01-20 15:07:34,255 - data_processing - INFO - 转换完成: 6008行 → 289行 (2002-01-01 ~ 2026-01-01) 方法: 日度平均
2026-01-20 15:07:34,255 - data_processing - INFO - 成功转换: 2/2 个文件
2026-01-20 15:07:34,266 - data_processing - INFO - 成功读取: CPI_标准日期.csv (216行)
2026-01-20 15:07:34,266 - data_processing - INFO - 基础数据: CPI (216行)
2026-01-20 15:07:34,278 - data_processing - INFO - 成功读取: PPI_标准日期.csv (240行)
2026-01-20 15:07:34,280 - data_processing - INFO - 已合并: PPI_标准日期.csv (2列)
2026-01-20 15:07:34,292 - data_processing - INFO - 成功读取: PMI_标准日期.csv (216行)
2026-01-20 15:07:34,294 - data_processing - INFO - 已合并: PMI_标准日期.csv (1列)
2026-01-20 15:07:34,307 - data_processing - INFO - 成功读取: 新增贷款_标准日期.csv (216行)
2026-01-20 15:07:34,308 - data_processing - INFO - 已合并: 新增贷款_标准日期.csv (2列)
2026-01-20 15:07:34,319 - data_processing - INFO - 成功读取: GDP_月度.csv (238行)
2026-01-20 15:07:34,321 - data_processing - INFO - 已合并: GDP_月度.csv (2列)
2026-01-20 15:07:34,336 - data_processing - INFO - 成功读取: 国债利差_月度.csv (289行)
2026-01-20 15:07:34,338 - data_processing - INFO - 已合并: 国债利差_月度.csv (1列)
2026-01-20 15:07:34,341 - data_processing - INFO - 已保存: 统一月度数据集.csv (289行 × 11列)
2026-01-20 15:07:34,341 - data_processing - INFO - 统一数据集: 289行 × 11列 (2002-01-01 ~ 2026-01-01)
2026-01-20 15:07:34,341 - data_processing - INFO - 步骤 3 完成
2026-01-20 15:07:34,343 - data_processing - INFO - 正在转换: CPI_标准日期.csv
2026-01-20 15:07:34,346 - data_processing - INFO - 删除中文列: month, var
2026-01-20 15:07:34,351 - data_processing - INFO - CPI_标准日期.csv → CPI_标准日期.dta (216行 × 13列)
2026-01-20 15:07:34,352 - data_processing - INFO - 正在转换: PPI_标准日期.csv
2026-01-20 15:07:34,353 - data_processing - INFO - 删除中文列: month, var
2026-01-20 15:07:34,357 - data_processing - INFO - PPI_标准日期.csv → PPI_标准日期.dta (216行 × 4列)
2026-01-20 15:07:34,358 - data_processing - INFO - 正在转换: PMI_标准日期.csv
2026-01-20 15:07:34,358 - data_processing - INFO - 删除中文列: month, var
2026-01-20 15:07:34,362 - data_processing - INFO - PMI_标准日期.csv → PMI_标准日期.dta (216行 × 5列)
2026-01-20 15:07:34,363 - data_processing - INFO - 正在转换: GDP_月度.csv
2026-01-20 15:07:34,368 - data_processing - INFO - GDP_月度.csv → GDP_标准日期.dta (216行 × 9列)
2026-01-20 15:07:34,369 - data_processing - INFO - 正在转换: 新增贷款_标准日期.csv
2026-01-20 15:07:34,369 - data_processing - INFO - 删除中文列: month, var
2026-01-20 15:07:34,373 - data_processing - INFO - 新增贷款_标准日期.csv → 新增贷款_标准日期.dta (216行 × 6列)
2026-01-20 15:07:34,375 - data_processing - INFO - 正在转换: 国债利差_月度.csv
2026-01-20 15:07:34,379 - data_processing - INFO - 国债利差_月度.csv → 国债利差_标准日期.dta (217行 × 4列)
2026-01-20 15:07:34,379 - data_processing - INFO - 成功: 6/6 个文件
2026-01-20 15:07:34,379 - data_processing - INFO - 步骤 4 完成
2026-01-20 15:07:34,379 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 15:07:34,380 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 15:07:34,380 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 15:07:34,808 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 15:07:45,192 - data_processing - INFO - 生成了 16 个输出文件
2026-01-20 15:07:45,192 - data_processing - INFO - Stata分析完成
2026-01-20 15:07:45,192 - data_processing - INFO - 步骤 5 完成
2026-01-20 15:07:45,194 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 15:07:45,194 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 15:07:45,194 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 15:07:45,195 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 15:08:20,221 - data_processing - INFO - 生成了 33 个输出文件
2026-01-20 15:08:20,222 - data_processing - INFO - Stata分析完成
2026-01-20 15:08:20,222 - data_processing - INFO - 步骤 6 完成
2026-01-20 16:14:10,607 - data_processing - INFO - AKShare 库加载成功
2026-01-20 16:14:10,608 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 16:14:10,609 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 16:14:10,609 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 16:14:11,750 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 16:14:23,880 - data_processing - ERROR - 运行Stata时出错: no observations
r(2000);

end of do-file

r(2000);

2026-01-20 16:14:23,880 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: no observations
r(2000);

end of do-file

r(2000);

2026-01-20 16:17:29,659 - data_processing - INFO - AKShare 库加载成功
2026-01-20 16:17:29,659 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 16:17:29,660 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 16:17:29,660 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 16:17:30,096 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 16:17:56,439 - data_processing - INFO - 生成了 33 个输出文件
2026-01-20 16:17:56,441 - data_processing - INFO - Stata分析完成
2026-01-20 16:24:35,446 - data_processing - INFO - AKShare 库加载成功
2026-01-20 16:24:35,447 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 16:24:35,447 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 16:24:35,448 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 16:24:35,884 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 16:24:46,346 - data_processing - INFO - 生成了 33 个输出文件
2026-01-20 16:24:46,346 - data_processing - INFO - Stata分析完成
2026-01-20 16:30:15,994 - data_processing - INFO - AKShare 库加载成功
2026-01-20 16:30:15,994 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 16:30:15,995 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 16:30:15,995 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 16:30:16,436 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 16:30:35,179 - data_processing - INFO - 生成了 33 个输出文件
2026-01-20 16:30:35,181 - data_processing - INFO - Stata分析完成
2026-01-20 16:42:23,341 - data_processing - INFO - AKShare 库加载成功
2026-01-20 16:42:23,341 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 16:42:23,342 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 16:42:23,342 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 16:42:23,791 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 16:42:43,706 - data_processing - INFO - 生成了 48 个输出文件
2026-01-20 16:42:43,706 - data_processing - INFO - Stata分析完成
2026-01-20 16:55:22,370 - data_processing - INFO - AKShare 库加载成功
2026-01-20 16:55:22,371 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 16:55:22,371 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 16:55:22,372 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 16:55:22,817 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 16:57:27,578 - data_processing - INFO - 生成了 48 个输出文件
2026-01-20 16:57:27,578 - data_processing - INFO - Stata分析完成
2026-01-20 17:44:37,626 - data_processing - INFO - AKShare 库加载成功
2026-01-20 17:44:37,627 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 17:44:37,627 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 17:44:37,627 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 17:44:38,088 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 17:44:53,687 - data_processing - INFO - 生成了 48 个输出文件
2026-01-20 17:44:53,687 - data_processing - INFO - Stata分析完成
2026-01-20 18:13:17,033 - data_processing - INFO - AKShare 库加载成功
2026-01-20 18:13:17,034 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 18:13:17,034 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 18:13:17,034 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 18:13:17,476 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 18:13:52,968 - data_processing - INFO - 生成了 48 个输出文件
2026-01-20 18:13:52,969 - data_processing - INFO - Stata分析完成
2026-01-20 18:14:57,340 - data_processing - INFO - AKShare 库加载成功
2026-01-20 18:14:57,340 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 18:14:57,341 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 18:14:57,341 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 18:14:57,777 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 18:15:42,312 - data_processing - INFO - AKShare 库加载成功
2026-01-20 18:15:42,312 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 18:15:42,313 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 18:15:42,313 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 18:15:42,758 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 18:27:15,440 - data_processing - INFO - AKShare 库加载成功
2026-01-20 18:27:15,440 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 18:27:15,441 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 18:27:15,441 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 18:27:15,878 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 18:27:31,086 - data_processing - INFO - 生成了 48 个输出文件
2026-01-20 18:27:31,087 - data_processing - INFO - Stata分析完成
2026-01-20 18:35:26,963 - data_processing - INFO - AKShare 库加载成功
2026-01-20 18:35:26,964 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 18:35:26,964 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 18:35:26,964 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 18:35:27,403 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 18:35:42,648 - data_processing - INFO - 生成了 48 个输出文件
2026-01-20 18:35:42,648 - data_processing - INFO - Stata分析完成
2026-01-20 18:41:12,517 - data_processing - INFO - AKShare 库加载成功
2026-01-20 18:41:12,517 - data_processing - INFO - 找到Stata脚本: svar_analysis.do
2026-01-20 18:41:12,518 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 18:41:12,518 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 18:41:12,968 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 18:41:28,345 - data_processing - INFO - 生成了 48 个输出文件
2026-01-20 18:41:28,345 - data_processing - INFO - Stata分析完成
2026-01-20 18:56:31,249 - data_processing - INFO - AKShare 库加载成功
2026-01-20 18:56:31,250 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 18:56:31,251 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 18:56:31,251 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 18:56:31,692 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 18:57:08,168 - data_processing - INFO - 生成了 48 个输出文件
2026-01-20 18:57:08,169 - data_processing - INFO - Stata分析完成
2026-01-20 19:08:41,615 - data_processing - INFO - AKShare 库加载成功
2026-01-20 19:08:41,615 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 19:08:41,616 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 19:08:41,616 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 19:08:42,075 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 19:09:32,396 - data_processing - INFO - 生成了 48 个输出文件
2026-01-20 19:09:32,396 - data_processing - INFO - Stata分析完成
2026-01-20 19:24:08,756 - data_processing - INFO - AKShare 库加载成功
2026-01-20 19:24:08,756 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 19:24:08,757 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 19:24:08,757 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 19:24:09,230 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 19:24:45,801 - data_processing - INFO - 生成了 48 个输出文件
2026-01-20 19:24:45,801 - data_processing - INFO - Stata分析完成
2026-01-20 19:25:52,702 - data_processing - INFO - AKShare 库加载成功
2026-01-20 19:25:52,703 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 19:25:52,703 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 19:25:52,703 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 19:25:53,152 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 19:26:22,487 - data_processing - ERROR - 运行Stata时出错: invalid '"gdp - pmi' 
r(198);

end of do-file

r(198);

2026-01-20 19:26:22,487 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: invalid '"gdp - pmi' 
r(198);

end of do-file

r(198);

2026-01-20 19:29:32,413 - data_processing - INFO - AKShare 库加载成功
2026-01-20 19:29:32,413 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 19:29:32,414 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 19:29:32,414 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 19:29:32,869 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 19:30:08,516 - data_processing - INFO - 生成了 48 个输出文件
2026-01-20 19:30:08,516 - data_processing - INFO - Stata分析完成
2026-01-20 19:31:47,995 - data_processing - INFO - AKShare 库加载成功
2026-01-20 19:31:47,996 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 19:31:47,996 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 19:31:47,997 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 19:31:48,456 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 19:33:02,450 - data_processing - ERROR - 运行Stata时出错: (file svar_extend_irf.irf updated)

. 
. * 2. 手动为每对冲击-响应绘图，完全自定义标题
. * 格式：twoway (rline irf upper lower step) (line irf step), 各种标题选项
. 
. *--- 子图1：GDP→GDP (自身响应) ---
. irf table oirf, impulse(gdp_yoy) response(gdp_yoy) step(0/30)
step() invalid -- invalid number, outside of allowed range
r(125);

end of do-file

r(125);

2026-01-20 19:33:02,450 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: (file svar_extend_irf.irf updated)

. 
. * 2. 手动为每对冲击-响应绘图，完全自定义标题
. * 格式：twoway (rline irf upper lower step) (line irf step), 各种标题选项
. 
. *--- 子图1：GDP→GDP (自身响应) ---
. irf table oirf, impulse(gdp_yoy) response(gdp_yoy) step(0/30)
step() invalid -- invalid number, outside of allowed range
r(125);

end of do-file

r(125);

2026-01-20 19:36:50,976 - data_processing - INFO - AKShare 库加载成功
2026-01-20 19:36:50,976 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 19:36:50,977 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 19:36:50,977 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 19:36:51,431 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 19:38:04,606 - data_processing - ERROR - 运行Stata时出错: variable gdp_gdp_upper not found
r(111);

end of do-file

r(111);

2026-01-20 19:38:04,606 - data_processing - ERROR - 执行Stata时出错
Traceback (most recent call last):
  File "C:\Users\123\OneDrive\桌面\辅修选修\岭院\时间序列\code\main.py", line 428, in run_stata_analysis
    stata.run(f'do "{do_file}"', echo=True)
  File "D:\stata19\utilities\pystata\stata.py", line 346, in run
    _stata_wrk1(cmds[0], echo)
  File "D:\stata19\utilities\pystata\stata.py", line 71, in _stata_wrk1
    raise SystemError(err)
SystemError: variable gdp_gdp_upper not found
r(111);

end of do-file

r(111);

2026-01-20 19:41:02,755 - data_processing - INFO - AKShare 库加载成功
2026-01-20 19:41:02,756 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 19:41:02,757 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 19:41:02,757 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 19:41:03,202 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 19:42:03,791 - data_processing - INFO - 生成了 48 个输出文件
2026-01-20 19:42:03,792 - data_processing - INFO - Stata分析完成
2026-01-20 19:46:02,661 - data_processing - INFO - AKShare 库加载成功
2026-01-20 19:46:02,661 - data_processing - INFO - 找到Stata脚本: extend_svar_analysis.do
2026-01-20 19:46:02,662 - data_processing - INFO - stata_setup模块加载成功
2026-01-20 19:46:02,662 - data_processing - INFO - 找到Stata目录: D:\stata19
2026-01-20 19:46:03,123 - data_processing - INFO - Stata已成功初始化 (MP版)
2026-01-20 19:46:39,396 - data_processing - INFO - 生成了 48 个输出文件
2026-01-20 19:46:39,396 - data_processing - INFO - Stata分析完成
